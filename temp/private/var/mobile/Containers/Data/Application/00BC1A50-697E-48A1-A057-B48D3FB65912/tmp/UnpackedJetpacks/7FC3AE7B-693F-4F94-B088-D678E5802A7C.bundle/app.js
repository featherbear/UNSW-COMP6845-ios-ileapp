!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3);function o(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function i(e,t,n,i){p({type:"badType",expected:t,actual:`${o(n)} (${n})`,objectPath:r.isSome(i)&&i.length>0?i:"<this>",contextNames:l(),recoveryAction:e})}function s(e){return!r.isNothing(e)&&(e.hasOwnProperty("$incidents")||Object.isExtensible(e))}t.extendedTypeof=o,t.unexpectedType=i,t.isValidatable=s,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format";case"defaultValue":return"Default value used";case"ignoredValue":return"Ignored value";default:return"Unknown"}};const a={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()};function c(e){a.nameStack.push(e)}function l(){return 0===a.nameStack.length?["<empty stack>"]:a.nameStack.slice(0)}function u(){0===a.nameStack.length&&console.warn("endContext() called without active validation context, ignoring"),a.nameStack.pop()}function d(e,t,n){let o=null;r.isSome(n)&&n.length>0&&(o=e,a.suppressedIncidentPaths.push(n));let s=null;try{c(e),s=t()}catch(e){throw e.hasThrown||(i("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===o&&a.suppressedIncidentPaths.pop(),u()}return s}function p(e){-1===a.suppressedIncidentPaths.indexOf(e.objectPath)&&a.incidents.push(e)}t.beginContext=c,t.getContextNames=l,t.endContext=u,t.recordValidationIncidents=function(e){s(e)&&(e.$incidents=a.incidents),a.incidents=[],a.nameStack=[],a.suppressedIncidentPaths=[]},t.context=d,t.catchingContext=function(e,t,n){let o=null;try{o=d(e,t)}catch(e){o=null,r.isSome(n)&&(o=n(e))}return o},t.unexpectedNull=function(e,t,n){p({type:"nullValue",expected:t,actual:"null",objectPath:r.isSome(n)&&n.length>0?n:"<this>",contextNames:l(),recoveryAction:e})}},,function(e,t,n){e.exports=n(5),e.exports.hbsHelper=n(8)},function(e,t,n){"use strict";function r(e){return null==e}function o(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeUninitialized=function(){},t.isNothing=r,t.isSome=o,t.unwrapOptional=function(e){if(r(e))throw new ReferenceError;return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return o(e)?t(e):e},t.flatMapOptional=function(e,t){return o(e)?t(e):e}},,function(e,t,n){e.exports.its={},n(6)(e.exports),n(7)(e.exports)},function(e,t){e.exports=function(e){var t=e.its;t.isDefined=function(e){return void 0!==e},void 0===t.string&&(t.string={}),t.string.replace=function(e,t,n){return e?("string"!=typeof e&&(e+=""),e.split(t).join(n)):e}}},function(e,t){e.exports=function(e){var t=e.its,n=e.iTSLocalization={};n._strings={},n.hasLocalizedValue=function(e){var r=n._strings[e];return t.isDefined(r)},n.isLocalized=function(e){var r=n._strings[e];return!!t.isDefined(r)&&(-1===e.indexOf(".")||(r!==e&&(0!==r.indexOf("**")||r.lastIndexOf("**")!==r.length-2)||(console.error("unlocalized key in keys dictionary",e),!1)))},t.loc=function(e,t){var r=n._strings[e];return void 0===r&&(r=e),t&&(r=n.replaceTokens(r,t)),"undefined"==typeof itms&&(r=n.replaceMarkupTokens(r,t)),r},t.locDate=function(e){if(!e)return"";var t,n=e.length;if(n>10)t=new Date(e);else{var r=n>=4?e.slice(0,4):0,o=n>=7?e.slice(5,7):1,i=n>=10?e.slice(8,10):1;t=new Date(r,o-1,i)}return formatDate(t)},t.locWithMarkupTokens=function(e,r){return n.replaceMarkupTokens(t.loc(e,r),r)},n._strings._showLocKeys&&(t.loc=function(e){return"+"+e+"+"}),t.locWithCount=function(e,r,o){var i,s,a=null;return 0==r&&(i=e+".zero",n.isLocalized(i)&&(a=i)),null===a&&(a=e,"other"!==(s=n.pluralCategory(r))&&(i=e+"."+s,n.isLocalized(i)&&(a=i))),o||(o={}),t.isDefined(o.count)||(o.count=t.formatNumber(r)),t.isDefined(o.number)||(o.number=t.formatNumber(r)),t.loc(a,o)},n.replaceTokens=function(e,n){if(n)for(var r in n)if(n.hasOwnProperty(r)){var o="@@"+r+"@@";e=t.string.replace(e,o,n[r])}return e},n.markupParams={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},n.replaceMarkupTokens=function(e,t){if(e.indexOf("##")>-1){if(t)for(var r in t)n.markupParams[r.toString()]=t[r];for(var o in n.markupParams){var i="##"+o+"##";e=e.replace(new RegExp(i,"gi"),n.markupParams[o])}e=e.replace(/##([^##]+)##/gi,"<$1>")}return e},n.localizedResourceUrlForPathKey=function(e,n){return void 0===n&&(n=/https:/.test(window.location.protocol)),(n?"https://s.mzstatic.com":"http://r.mzstatic.com")+t.loc(e)},"undefined"!=typeof itms&&"undefined"!=typeof formatNumber?t.formatNumber=function(e){return formatNumber(Number(e))}:t.formatNumber=function(e){if(void 0===n.decimalSeparator){var t=n._strings._decimalSeparator;void 0===t&&(t="."),n.decimalSeparator=t,void 0===(t=n._strings._thousandsSeparator)&&(t=","),n.thousandsSeparator=t}for(var r=parseFloat(e).toString().split("."),o=n.thousandsSeparator,i=r[0].split(""),s=i.length-3;s>0;s-=3)i.splice(s,0,o);return r[0]=i.join(""),r.join(n.decimalSeparator)},n._pluralCategoryDefault=function(e){return"other"},n._pluralCategoryOne=function(e){return 1==e?"one":"other"},n._pluralCategoryArabic=function(e){var t=e>>0;if(t!=e)return"other";if(0===t)return"zero";if(1===t)return"one";if(2===t)return"two";var n=t%100;return n>=11?"many":n>=3?"few":"other"},n._pluralCategoryFrench=function(e){return e<2&&e>=0?"one":"other"},n._pluralCategoryHebrew=function(e){var t=e>>0;return t!=e?"other":1===t?"one":2===t?"two":0==t%10&&t>10?"many":"other"},n._pluralCategoryPolish=function(e){var t=e>>0;if(t!=e)return"other";if(1===t)return"one";var n=t%10;if(n<=4&&n>=2){var r=t%100;if(r>14||r<12)return"few"}return"many"},n._pluralCategoryRomanian=function(e){var t=e>>0;if(t!=e)return"few";if(0===t)return"few";if(1===t)return"one";var n=e%100;return n<=19&&n>=1?"few":"other"},n._pluralCategoryRussian=function(e){var t=e>>0;if(t!=e)return"other";var n=t%10;if(n>=5||0==n)return"many";var r=t%100;return r<=14&&r>=11?"many":1==n?"one":"few"},n._pluralCategoryFnByLanguage={zh:n._pluralCategoryDefault,id:n._pluralCategoryDefault,ja:n._pluralCategoryDefault,ko:n._pluralCategoryDefault,ms:n._pluralCategoryDefault,th:n._pluralCategoryDefault,vi:n._pluralCategoryDefault,en:n._pluralCategoryOne,ca:n._pluralCategoryOne,da:n._pluralCategoryOne,nl:n._pluralCategoryOne,de:n._pluralCategoryOne,el:n._pluralCategoryOne,fi:n._pluralCategoryOne,hu:n._pluralCategoryOne,it:n._pluralCategoryOne,nb:n._pluralCategoryOne,no:n._pluralCategoryOne,pt:n._pluralCategoryOne,es:n._pluralCategoryOne,sv:n._pluralCategoryOne,tr:n._pluralCategoryOne,ar:n._pluralCategoryArabic,fr:n._pluralCategoryFrench,iw:n._pluralCategoryHebrew,pl:n._pluralCategoryPolish,ro:n._pluralCategoryRomanian,ru:n._pluralCategoryRussian},n.pluralCategory=function(e){var r;if(t.serverData&&t.serverData.constants)r=t.serverData.constants.languageCode;else if("undefined"!=typeof itms&&itms.getBag){var o=itms.getBag();r=(r=o&&o.language||"en").slice(0,2)}var i=n._pluralCategoryFnByLanguage[r];return i?i(e):(console.warn("missing plural category function for: "+r),"other")},t.updateLocale=function(e){n._strings=e}}},function(e,t,n){e.exports=function(e,t){return n(9).its.loc(e,t)},"undefined"!=typeof Handlebars&&Handlebars.registerHelper("loc",helper)},function(e,t){window.iTSLocalization||(iTSLocalization={}),window.iTSLocalization._strings||(iTSLocalization._strings={}),iTSLocalization.hasLocalizedValue=function(e){var t=iTSLocalization._strings[e];return its.isDefined(t)},its.loc=function(e,t){var n=iTSLocalization._strings[e];return void 0===n&&(n=e),t&&(n=iTSLocalization.replaceTokens(n,t)),"undefined"==typeof itms&&(n=iTSLocalization.replaceMarkupTokens(n,t)),n},its.locDate=function(e){if(!e)return"";var t,n=e.length;if(n>10)t=new Date(e);else{var r=n>=4?e.slice(0,4):0,o=n>=7?e.slice(5,7):1,i=n>=10?e.slice(8,10):1;t=new Date(r,o-1,i)}return formatDate(t)},its.locWithMarkupTokens=function(e,t){return iTSLocalization.replaceMarkupTokens(its.loc(e,t),t)},iTSLocalization._strings._showLocKeys&&(its.loc=function(e){return"+"+e+"+"}),its.locWithCount=function(e,t,n){var r,o,i=null;return 0==t&&(r=e+".zero",iTSLocalization.hasLocalizedValue(r)&&(i=r)),null===i&&(i=e,"other"!==(o=iTSLocalization.pluralCategory(t))&&(r=e+"."+o,iTSLocalization.hasLocalizedValue(r)&&(i=r))),n||(n={}),its.isDefined(n.count)||(n.count=its.formatNumber(t)),its.loc(i,n)},iTSLocalization.replaceTokens=function(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){var r="@@"+n+"@@";e=its.string.replace(e,r,t[n])}return e},iTSLocalization.markupParams={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},iTSLocalization.replaceMarkupTokens=function(e,t){if(e.indexOf("##")>-1){if(t)for(var n in t)iTSLocalization.markupParams[n.toString()]=t[n];for(var r in iTSLocalization.markupParams){var o="##"+r+"##";e=e.replace(new RegExp(o,"gi"),iTSLocalization.markupParams[r])}e=e.replace(/##([^##]+)##/gi,"<$1>")}return e},iTSLocalization.localizedResourceUrlForPathKey=function(e,t){return void 0===t&&(t=/https:/.test(window.location.protocol)),(t?"https://s.mzstatic.com":"http://r.mzstatic.com")+its.loc(e)},"undefined"!=typeof itms&&"undefined"!=typeof formatNumber?its.formatNumber=function(e){return formatNumber(Number(e))}:its.formatNumber=function(e){if(void 0===iTSLocalization.decimalSeparator){var t=iTSLocalization._strings._decimalSeparator;void 0===t&&(t="."),iTSLocalization.decimalSeparator=t,void 0===(t=iTSLocalization._strings._thousandsSeparator)&&(t=","),iTSLocalization.thousandsSeparator=t}for(var n=parseFloat(e).toString().split("."),r=iTSLocalization.thousandsSeparator,o=n[0].split(""),i=o.length-3;i>0;i-=3)o.splice(i,0,r);return n[0]=o.join(""),n.join(iTSLocalization.decimalSeparator)},iTSLocalization._pluralCategoryDefault=function(e){return"other"},iTSLocalization._pluralCategoryOne=function(e){return 1==e?"one":"other"},iTSLocalization._pluralCategoryArabic=function(e){var t=e>>0;if(t!=e)return"other";if(0===t)return"zero";if(1===t)return"one";if(2===t)return"two";var n=t%100;return n>=11?"many":n>=3?"few":"other"},iTSLocalization._pluralCategoryFrench=function(e){return e<2&&e>=0?"one":"other"},iTSLocalization._pluralCategoryHebrew=function(e){var t=e>>0;return t!=e?"other":1===t?"one":2===t?"two":0==t%10&&t>10?"many":"other"},iTSLocalization._pluralCategoryPolish=function(e){var t=e>>0;if(t!=e)return"other";if(1===t)return"one";var n=t%10;if(n<=4&&n>=2){var r=t%100;if(r>14||r<12)return"few"}return"many"},iTSLocalization._pluralCategoryRomanian=function(e){var t=e>>0;if(t!=e)return"few";if(0===t)return"few";if(1===t)return"one";var n=e%100;return n<=19&&n>=1?"few":"other"},iTSLocalization._pluralCategoryRussian=function(e){var t=e>>0;if(t!=e)return"other";var n=t%10;if(n>=5||0==n)return"many";var r=t%100;return r<=14&&r>=11?"many":1==n?"one":"few"},iTSLocalization._pluralCategoryFnByLanguage={zh:iTSLocalization._pluralCategoryDefault,id:iTSLocalization._pluralCategoryDefault,ja:iTSLocalization._pluralCategoryDefault,ko:iTSLocalization._pluralCategoryDefault,ms:iTSLocalization._pluralCategoryDefault,th:iTSLocalization._pluralCategoryDefault,vi:iTSLocalization._pluralCategoryDefault,en:iTSLocalization._pluralCategoryOne,ca:iTSLocalization._pluralCategoryOne,da:iTSLocalization._pluralCategoryOne,nl:iTSLocalization._pluralCategoryOne,de:iTSLocalization._pluralCategoryOne,el:iTSLocalization._pluralCategoryOne,fi:iTSLocalization._pluralCategoryOne,hu:iTSLocalization._pluralCategoryOne,it:iTSLocalization._pluralCategoryOne,nb:iTSLocalization._pluralCategoryOne,no:iTSLocalization._pluralCategoryOne,pt:iTSLocalization._pluralCategoryOne,es:iTSLocalization._pluralCategoryOne,sv:iTSLocalization._pluralCategoryOne,tr:iTSLocalization._pluralCategoryOne,ar:iTSLocalization._pluralCategoryArabic,fr:iTSLocalization._pluralCategoryFrench,iw:iTSLocalization._pluralCategoryHebrew,pl:iTSLocalization._pluralCategoryPolish,ro:iTSLocalization._pluralCategoryRomanian,ru:iTSLocalization._pluralCategoryRussian},iTSLocalization.pluralCategory=function(e){if(its.serverData&&its.serverData.constants){var t=iTSLocalization._pluralCategoryFnByLanguage[its.serverData.constants.languageCode];if(t)return t(e);its.Logger&&its.Logger.named("its-base-util").error("missing plural category function for: "+its.serverData.constants.languageCode,!0)}return"other"}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"appStoreIdentifier",(function(){return km})),n.d(r,"watchIdentifier",(function(){return Em})),n.d(r,"messagesIdentifier",(function(){return Cm})),n.d(r,"arcadeIdentifier",(function(){return _m})),n.d(r,"tvIdentifier",(function(){return Rm})),n.d(r,"productPageExtensionIdentifier",(function(){return Om})),n.d(r,"subscribePageExtensionIdentifier",(function(){return vm})),n.d(r,"deviceType",(function(){return Dm})),n.d(r,"screenSize",(function(){return xm})),n.d(r,"screenCornerRadius",(function(){return Lm})),n.d(r,"guid",(function(){return Fm})),n.d(r,"thinnedApplicationVariantIdentifier",(function(){return Nm})),n.d(r,"storefrontIdentifier",(function(){return Mm})),n.d(r,"newPaymentMethodEnabled",(function(){return Um})),n.d(r,"buildType",(function(){return Bm})),n.d(r,"isActivityAvailable",(function(){return qm})),n.d(r,"isElectrocardiogramInstallationAllowed",(function(){return Gm})),n.d(r,"isScandiumInstallationAllowed",(function(){return Vm})),n.d(r,"isSidepackingEnabled",(function(){return Hm})),n.d(r,"isTinkerWatch",(function(){return $m})),n.d(r,"supportsHEIF",(function(){return Wm})),n.d(r,"activePairedWatchSystemVersion",(function(){return zm})),n.d(r,"isAutomaticDownloadingEnabled",(function(){return jm})),n.d(r,"deviceHasCapabilities",(function(){return Ym})),n.d(r,"isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion",(function(){return Km})),n.d(r,"isPairedSystemVersionAtLeast",(function(){return Qm})),n.d(r,"isActivePairedWatchSystemVersionBelow",(function(){return Jm})),n.d(r,"hasActivePairedWatch",(function(){return Xm})),n.d(r,"deletableSystemAppCanBeInstalledOnWatchWithBundleID",(function(){return Zm}));var o={};n.r(o),n.d(o,"paginationRoute",(function(){return __})),n.d(o,"generatePageRequest",(function(){return R_})),n.d(o,"renderPage",(function(){return O_})),n.d(o,"generatePaginationRequest",(function(){return v_})),n.d(o,"renderPaginatedPage",(function(){return D_}));var i={};n.r(i),n.d(i,"shelfRoute",(function(){return oR})),n.d(i,"paginationRoute",(function(){return iR})),n.d(i,"generatePageRequest",(function(){return sR})),n.d(i,"renderPage",(function(){return aR})),n.d(i,"generateShelfRequest",(function(){return cR})),n.d(i,"renderShelf",(function(){return lR})),n.d(i,"generatePaginationRequest",(function(){return uR})),n.d(i,"renderPaginatedPage",(function(){return dR}));var s={};n.r(s),n.d(s,"purchasedSpotlightIndex",(function(){return dv})),n.d(s,"notPurchasedSpotlightIndex",(function(){return pv})),n.d(s,"purchasedOrdering",(function(){return fv})),n.d(s,"notPurchasedOrdering",(function(){return hv}));var a={};n.r(a),n.d(a,"purchasedSpotlightIndex",(function(){return mv})),n.d(a,"notPurchasedSpotlightIndex",(function(){return gv})),n.d(a,"purchasedOrdering",(function(){return yv})),n.d(a,"notPurchasedOrdering",(function(){return Tv}));var c={};n.r(c),n.d(c,"purchasedSpotlightIndex",(function(){return wv})),n.d(c,"notPurchasedSpotlightIndex",(function(){return Iv})),n.d(c,"purchasedOrdering",(function(){return Av})),n.d(c,"notPurchasedOrdering",(function(){return Sv}));var l={};n.r(l),n.d(l,"purchasedSpotlightIndex",(function(){return bv})),n.d(l,"notPurchasedSpotlightIndex",(function(){return Pv})),n.d(l,"purchasedOrdering",(function(){return kv})),n.d(l,"notPurchasedOrdering",(function(){return Ev}));var u={};n.r(u),n.d(u,"purchasedSpotlightIndex",(function(){return Cv})),n.d(u,"notPurchasedSpotlightIndex",(function(){return _v})),n.d(u,"purchasedOrdering",(function(){return Rv})),n.d(u,"notPurchasedOrdering",(function(){return Ov}));const d="pageMetrics",p="resilientDeepLinks",f="token.pageInformation",h="token.excludeAttribution",m="systemInformation",g="redownload",y="purchases",T="RECOMMENDATIONS",w="InlineVideo",I="{subtitle}",A="cardDisplayStyle",S="descending",b="arcadeLockupInNavBar",P="material",k="breakoutTextAlignment",E="marketingArtwork",C="marketingVideo",_="callToActionLabel",R="breakoutTall",O="breakoutFullScreen",v="personal-recommendations",D="collection",x="CONTINUE_PLAYING",L="editorialArtwork.topShelf",F="DEVELOPER_WATCH",N="DEVELOPER_LATEST_RELEASE",M="DEVELOPER_BUNDLES",U="DEVELOPER_APPS_AND_GAMES",B="DEVELOPER_GAMES",q="DEVELOPER_APPS",G="DEVELOPER_APPLE_ARCADE",V="resourceType",H="results.eula.text",$="is32bitOnly",W="requires32bit",z="is.workflow.my.app",j="com.apple.mobileme.fmf1",Y="isIOSBinaryMacOSCompatible",K="systemimage://square.and.arrow.up",Q="userReviewId",J="systemimage://hand.thumbsup",X="systemimage://hand.thumbsdown",Z="systemimage://exclamationmark.circle",ee="Achievements Hero",te="GAME_CENTER_REENGAGEMENT_BADGE_GAMECENTER",ne="GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_COMPLETEDCOUNT_TITLE",re="GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_COMPLETEDCOUNT_SUBTITLE",oe="{completedAchievementsCount}",ie="{totalAchievementsCount}",se="subscriptionHero",ae="titledButtonStack",ce="editorialArtwork.mediaCard",le="editorialNotes.short",ue="interactive",de="largeHeroBreakout",pe="firstItemInFirstLockupShelf",fe="smallBreakout",he="TERMS_AND_CONDITIONS_TITLE",me="textGradient",ge="prefersLargeTitleWhenRoot",ye="GROUPING_DISCOVER",Te="privacyPolicyText",we="handlePage",Ie="recurringSubscriptionPeriod",Ae="PayUpFront",Se="{trialPrice}",be="PayAsYouGo",Pe="iad.lineItem",ke="rebuy=true",Ee="FLOW_PREVIEW_OFFER_ACTION_GET",Ce="FLOW_PREVIEW_OFFER_ACTION_PREORDER",_e="amsContextualUpsellSheets",Re="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",Oe="TV_OFFER_ALERT_FOOTER_LINE_BREAK",ve="arcade-preorder",De="siriRemoteRequirementBadge",xe="contentRatingsBySystem.appsApple.value",Le="OFFER_BUTTON_TITLE_PREORDER",Fe="confirmation",Ne="notSubscribed",Me="preorderSubscribed",Ue="preorderNotSubscribed",Be="OFFER_BUTTON_TITLE_ARCADE_STANDARD",qe="OFFER_BUTTON_TITLE_ARCADE_OPEN",Ge="discountOwnedParent",Ve="discountUnownedParent",He="AppStore.OfferButton.ExternalPurchases.Subtitle",$e="INLINE_IN_APP_PURCHASES",We="macSoftware",ze="displayable-kind",je="ratingCount",Ye="presentModal",Ke="reviewsContainer",Qe="shareSheet",Je="editorialArtwork.crossoverCard",Xe="arcadeTopShelfATV",Ze="arcadeWordmarkAssetName",et="openApplication",tt="arcadeTopShelfATVClickThrough",nt="SEE_ALL_GAMES",rt="arcade-see-all-games-button",ot="comingSoonApps",it="refreshRibbon",st="selectedPageFacets",at="{releaseDate}",ct="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",lt="PAGE_FACETS_FILTERS_MULTIPLAYER",ut="PAGE_FACETS_FILTERS_COMING_SOON",dt="filter[ageRating]",pt="filter[supportsGameController]",ft="filter[isMultiplayer]",ht="PAGE_FACETS_SORT_BY_TITLE",mt="controllerSupport",gt="multiplayer",yt="PAGE_FACETS_INCLUDE_TITLE",Tt="arcadeSubscribePage",wt="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",It="launchRepair",At="arcadeAskToBuy",St="ARCADE_WELCOME_TV_CONTINUE_BUTTON",bt="ARCADE_WELCOME_CONTINUE_BUTTON",Pt="arcade-welcome-create-family",kt="x-apple.systempreferences:com.apple.preferences.FamilySharingPrefPane",Et="subscriber",Ct="inlineArcadeFooter",_t="placeholderBackground",Rt="impressionableAppIconFromData",Ot="deviceFamilies",vt="requiresRosetta",Dt="appleWatch_2018",xt="supportsGameController",Lt="controllers",Ft="familySharingIAPWithLinkAction",Nt="familySharingIAP",Mt="familySharingWithLinkAction",Ut="familySharing",Bt="posterCardVideo16x9",qt="standardApp",Gt="contentRatingsBySystem.appsApple.name",Vt="userRating.ratingCount",Ht="userRating.value",$t="isVerifiedForAppleSiliconMac",Wt="clientIdentifierOverride",zt="privacyCategory",jt="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",Yt="hasPrivacyPolicyText",Kt="privacyPolicy",Qt="PRODUCT_PRIVACY_DEFINITIONS_LINK",Jt="USAGE_DATA",Xt="systemimage://person.circle",Zt="NOT_COMPATIBLE_BANNER",en="NOT_COMPATIBLE_BANNER_NO_LINK",tn="UNSUPPORTED_CAPABILITIES",nn="UNSUPPORTED_IOS_VERSION",rn="SoftwareBundle",on="PRODUCT_ACHIEVEMENT_SUMMARY",sn="editorialArtwork.brandLogo",an="siriRemoteOrControllerRequired",cn="siriRemoteRequired",ln="BADGE_MFI_REQUIRED_HEADING",un="controllerRequired",dn="BADGE_MFI_HEADING",pn="controllerOptional",fn="BADGE_PLAYERS_HEADING",hn="{maxPlayers}",mn="BADGE_NO_RATINGS_CAPTION",gn="Achievements",yn="gameCenterPlayerGameAchievementSummary",Tn="productCapability",wn="promotionalText",In="PRODUCT_SECTION_FEATURED_IN",An="largeGameCenterPlayer",Sn="PRODUCT_SECTION_MOST_RECENT_VERSION",bn="titledParagraph",Pn="versionDisplay",kn="standardInformationShelf",En="seventeenPlus",Cn="gracRegistrationNumber",_n="CAPABILITY_FAMILY_SHARING_TITLE",Rn="guidedLabel",On="iosSoftware",vn="iAdTemplateType",Dn="data.search.dataSetId",xn="SEARCH_FACET_IPHONE_ONLY",Ln="SEARCH_FACET_FREE",Fn="SEARCH_FACET_",Nn="macOSCompatibleIOSApps",Mn="didYouMean",Un="SEARCH_TRANSPARENCY_LINK",Bn="trending-contents",qn="trendingSearches",Gn="header.label",Vn="ads-result",Hn="SearchRevisions",$n="alternateLabel",Wn="lockupList",zn="advertDataMalformed",jn="mapiFetchFail",Yn="results.contents",Kn="PAGE_TITLE_TODAY",Qn="ignoreEditorialArt",Jn="todayCardOverlay",Xn="cardSubType",Zn="isOnboardingCard",er="displaysArcadeUpsell",tr="asJSONValue",nr="signatureResumption",rr="checkForLongUrl",or="app-bundle",ir="viewEditorialItem",sr="meta.metrics",ar="clientCorrelationKey",cr="data-metrics-impressions-low-latency",lr="viewedInfo",ur="osLanguages",dr="pageContext",pr="com.apple.AppStore.clipOverlay",fr="buttonName",hr="searchGhostHint",mr="iAdAppStoreClientRequestId",gr="iAdImpressionId",yr="iAdMetadata",Tr="iAdIsSpecifiedCreativeUsed",wr="channelPartner",Ir="upsellScenario",Ar="search-revisions",Sr="impressionType",br="TabChangeAction",Pr="groupingLockup",kr="continuation",Er="externalUrl",Cr="formatDateWithContext",_r="IPHONE_BRAND_NAME",Rr="IPAD_BRAND_NAME",Or="APPLE_TV_BRAND_NAME",vr="APPLE_WATCH_BRAND_NAME",Dr="MAC_BRAND_NAME",xr="trending-searches",Lr="searchHints",Fr="personalizedUserReviewUrl",Nr="personalizedUserReviewEnabled",Mr="p2-application-user-rate-content",Ur="p2-application-user-write-review",Br="p2-accessory-room",qr="library-link",Gr="language-tag",Vr="p2-service-terms-url",Hr="usePostForAppStoreSearch",$r="isBuyingScheduledGiftCertificateEnabled",Wr="isScheduledGiftingEnabled",zr="AddFundsUrl",jr="personalized-buy-buttons/software",Yr="uvSearch/nowplaying-enabled",Kr="supportLinkUrl",Qr="reportConcernUrl",Jr="reportConcernExplanation",Xr="reportConcernReasons",Zr="createAccountUrl",eo="apps-media-api-host",to="apps-media-api-preview-host",no="apps-media-api-search-edge-host",ro="apps-media-api-edge-end-points",oo="apps-media-api-search-ads-limit",io="countryCode",so="searchSortOptions",ao="processRedirectUrl/whitelistedQueryParams",co="processRedirectUrl/endpoint",lo="app-store-app-id",uo="arcade-iap-family-id",po="ocelot-iap-family-id",fo="arcade-iap-offer-name",ho="ocelot-iap-offer-name",mo="transparencyLawEditorialItemId",go="hideableSystemApps",yo="tabs/standard",To="isInternalArcadeComingSoon",wo="watchAppsGrouping",Io="requireAgeVerification",Ao="ageRatingLearnMoreEditorialItemId",So="safariExtensionsGrouping",bo="familySubscriptionsLearnMoreEditorialItemId",Po="commerce-ui-urls/dynamic-url-patterns",ko="commerce-ui-urls/url-patterns",Eo="commerce-ui-urls/v2-url-patterns",Co="arcadePreOrderUpsellLimitSeconds",_o="recentlyPlayedGamesWindowInSeconds",Ro="enable-privacy-nutrition-labels",Oo="appleSiliconMacUnverifiedBadgeEditorialItemId",vo="enableComingSoonToggle",Do="sponsored-search-odml-timeout",xo="search-landing-ad-fetch-timeout",Lo="isSearchLandingAdsEnabled",Fo="search-landing-offscreen-refresh-interval-in-seconds",No="search-landing-page-update-delay-interval-in-seconds",Mo="appPrivacyLearnMoreEditorialItemId",Uo="suppressedPrivacyLabels",Bo="arcadeOfferEditorialItemId",qo="appPrivacyDefinitionsEditorialItemId",Go="enable-arcade-trial-eligible-badging",Vo="enable-external-purchase",Ho="enabled-external-purchase-placements",$o="external-purchase-learn-more-editorial-item-id",Wo="ACTION_OK",zo="x-as3-internal:/today/test",jo="token.metricsPlatformDisplayStyle",Yo="purchased",Ko="personalization-data",Qo="ACCOUNT_SETTINGS",Jo="develop",Xo="Messages",Zo="canvas",ei="upsellForNonacquisitionCanvas",ti="arcadeIcons",ni="AppMarker",ri="framedArtwork",oi="isAcquisition",ii="arcadeTodayCard",si="appShowcase",ai="subscribed",ci="trailing",li="external",ui="system-apps",di="resourceId",pi="isStandaloneWithCompanionForWatchOS",fi="isDeliveredInIOSAppForWatchOS",hi="decimalPad",mi="hidden",gi="badge-content",yi="doNotFilter",Ti="Unknown featured content ID:",wi="designTag",Ii="redeem",Ai="hasChevron",Si="textLightensOnHighlight",bi="hasSeparator",Pi="inAppPurchaseTiledLockup",ki="mediumStoryCard",Ei="textFollowsTintColor",Ci="suggested",_i="bgColor",Ri="release",Oi="channel-apps",vi="discounts",Di="{postTrialPrice}",xi="item.offer.buyParams",Li="CONTROLLER_REQUIRED",Fi="CONTROLLER_OPTIONAL",Ni="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",Mi="SIRI_REMOTE_REQUIRED",Ui="hasInAppPurchases",Bi="ARCADE_PREORDER_COMING_SOON",qi="INTRO_PRICE_OFFER_FREE_TRIAL",Gi="INTRO_PRICE_OFFER_SUBTITLE",Vi="systemimage://gamecenter.fill",Hi="PRODUCT_SECTION_REVIEWS",$i="bundle",Wi="TopShelf",zi="carouselDetails",ji="results.data",Yi="APPLE_ARCADE",Ki="ALL_GAMES",Qi="comingSoonGrouping",Ji="ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE",Xi="toggle",Zi="comingSoon",es="subscribe",ts="crossfireReferral",ns="custom",rs="AppStore.Arcade.Welcome.Family.Button.ExploreArcade",os="arcade-welcome-continue",is="ARCADE_WELCOME_INDIVIDUAL_TITLE",ss="upsellRecovery",as="arcadeTabNavBar",cs="minPlayers",ls="maxPlayers",us="fileSizeByDevice",ds="checksum",ps="roundedRect",fs="watchOS",hs="iphone_6_5",ms="iphone_5_8",gs="editorialArtwork.splashFullScreen",ys="splashVideo16x9",Ts="splashVideo4x3",ws="splashVideo3x4",Is="appletv",As="supportsFunCamera",Ss="messagesScreenshots",bs="com.apple.Arcade",Ps="parentId",ks="genreNames",Es="privacyDetail",Cs="DATA_NOT_PROVIDED",_s="PRODUCT_PRIVACY_LEARN_MORE_LINK",Rs="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",Os="{learnMoreLink}",vs="privacyCard",Ds="identifier",xs="NOT_COMPATIBLE_BANNER_LINK_TITLE",Ls="NOT_COMPATIBLE_BANNER_TEMPLATE",Fs="{linkTitle}",Ns="deviceCompatibility",Ms="bundleParents",Us="languages",Bs="chartPosition",qs="position",Gs="{minPlayers}",Vs="userRating",Hs="PRODUCT_SECTION_INFORMATION",$s="PRODUCT_SECTION_SUPPORTS",Ws="supports",zs="relationship",js="requirementsByDeviceFamily",Ys="guidedToken",Ks="SEARCH_FACET_IPAD_ONLY",Qs="SEARCH_FACET_ANY_PRICE",Js="SEARCH_FACET_ANY_CATEGORY",Xs="SEARCH_FACET_RELEVANCE",Zs="clientApplication",ea="showLabelInSearch",ta="undoSpellCorrection",na="applySpellCorrection",ra="SearchResults",oa="editorial",ia="{searchTerm}",sa="userTypedHint",aa="contentIds",ca="TodayForApps",la="conservative",ua="dynamic",da="strict",pa="suffix",fa="targetType",ha="impressionQueue",ma="eventVersion",ga="extRefUrl2",ya="extRefApp2",Ta="offerReleaseDate",wa="searchOriginatingTerm",Ia="impressionId",Aa="APPSTORE_SEARCH_LANDING_PAGE",Sa="searchGhostHintPrefix",ba="searchGhostHintTermPhase",Pa="searchGhostHintTerm",ka="F1F4F6",Ea="com.apple.appstorecomponentsd",Ca="language",_a="apps-media-api-edge-host",Ra="application/x-www-form-urlencoded",Oa="FlowAction",va="dynamicUI",Da="inAppPurchaseInstall",xa="multiple-system-operators",La="complete",Fa="OFFER_BUTTON_TITLE_GET",Na="com.apple.TVAppStore.AppStoreTopShelfExtension",Ma="games",Ua="originalUrl",Ba="framedVideo",qa="GameOfDay",Ga="AppOfDay",Va="List",Ha="isCanvasAvailable",$a="primary-content",Wa="target",za="open",ja="editorialArtwork.bannerUber",Ya="imessage-apps",Ka="ios-apps",Qa="LICENSE_AGREEMENT",Ja="supportsArcade",Xa="arcadePreOrder",Za="editorial-elements",ec="locked",tc="inprogress",nc="completed",rc="editorialStoryCard",oc="hero",ic="gift",sc="showExpectedReleaseDate",ac="topCharts",cc="posterLockup",lc="largeStoryCard",uc=" milliseconds.",dc="viewGenre",pc="Genre",fc="fields",hc="PRIVACY_POLICY",mc="multiplex",gc="href",yc="requiresGameController",Tc="arcadeComingSoon",wc="PREORDER_NOTIFY_MESSAGE",Ic="buyInitiate",Ac="ARCADE_PREORDER_LOCKUP_COMING_SOON",Sc="INTRO_PRICE_OFFER_TRIAL",bc="size",Pc="GAME_CENTER",kc="resource://GameCenterEyebrow",Ec="with",Cc="wordmark",_c="arcadeLaunchRepair",Rc="width",Oc="height",vc="siri",Dc="editorialNotes",xc="arcadeApp",Lc="editorialBadgeType",Fc="editorialPriority",Nc="isSubscription",Mc="NumberedList",Uc="privacyDetails",Bc="privacyType",qc="compatibilityAnnotation",Gc="alternate-apps",Vc="softwareType",Hc="303031",$c="platformDisplayStyle",Wc="bundleChildren",zc="appPrivacy2020C",jc="actionLinks",Yc="contentRating",Kc="editorsChoice",Qc="{count}",Jc="supportURLForLanguage",Xc="websiteUrl",Zc="merchandised-in-apps",el="ratings",tl="APP_STORE_EDITORS_NOTES",nl="top-in-apps",rl="ad_container",ol="multirooms",il="landing",sl="named",al="false",cl="checkForPreorders",ll="user-reviews",ul="click",dl="pageUrl",pl="hostApp",fl="offerType",hl="iAdMissedOpportunityReason",ml="arcadeSubscribe",gl="com.apple.Arcade.ArcadeTopShelfExtension",yl="navigation",Tl="updates",wl="categories",Il="its_id",Al="arcadeStoryCanvas",Sl="share",bl="FullWidth",Pl="largeLockup",kl="arcadeShowcase",El="watch-apps",Cl="atv-apps",_l="mac-os-compatible-ios-apps",Rl="screenshotsLockup",Ol="minimumWatchOSVersion",vl="toast",Dl="gamecenterReengagementTitleChanges",xl="shelfEyebrowsAndArtwork",Ll="chart",Fl="card",Nl="priceFormatted",Ml="offers",Ul="buyParams",Bl="expectedReleaseDate",ql="arcadeGroupingLockup",Gl="isGameCenterEnabled",Vl="rooms",Hl="description.standard",$l="category",Wl="MMMM d, y",zl="arcadeTabHeader",jl="offerName",Yl="blue",Kl="charts",Ql="searchResults",Jl="editorialBadgeInfo",Xl="privacyDefinitions",Zl="privacyPolicyUrl",eu="PRODUCT_PRIVACY_TITLE",tu="intermediateDetailPage",nu="customers-also-bought-apps",ru="textCards",ou="textLinksShelf",iu="related-editorial-items",su="controller",au="developer-other-apps",cu="story",lu="hintsEntity",uu="targetPlatform",du="term",pu="multiApp",fu="moduleSlice",hu="Content",mu="actionType",gu="pageReferrer",yu="actionUrl",Tu="location",wu="searchPrefix",Iu="always",Au="POST",Su="disabled",bu="discover",Pu="editorialItem",ku="pageId",Eu="smallStoryCards",Cu="mac-apps",_u="date",Ru="subtitle",Ou="small",vu="grouping",Du="todayCard",xu="appTrailerLockup",Lu="inAppPurchaseLockup",Fu="remoteControllerRequirement",Nu="{price}",Mu="upsellBreakout",Uu="defaultValue",Bu="ipod",qu="object",Gu="triforce",Vu="ipadPro",Hu="ipad_10_5",$u="searchLanding",Wu="privacy",zu="appIcon",ju="capabilities",Yu="preorderDisclaimer",Ku="subscriptions",Qu="inAppPurchases",Ju="BADGE_MFI_SUPPORTED",Xu="iAdId",Zu="hints",ed="coercedValue",td="pageFields",nd="advertRotation",rd="metrics",od="platform",id="tvOS",sd="pageDetails",ad="editorialCopy",cd="tagline",ld="ARCADE_ACTION_TITLE_EXPLORE",ud="EXPLORE",dd="previewFrame",pd="ages",fd="title",hd="refUrl",md="eula",gd="isFirstPartyHideableApp",yd="editorialElementKind",Td="price",wd="NO_BADGE",Id="Branded",Ad="annotation",Sd="singleSelection",bd="ipadPro_2018",Pd="ipad_11",kd="Software",Ed="grid",Cd="mostRecentVersion",_d="editorialQuote",Rd="featuredIn",Od="versionHistory",vd="guidedSearch",Dd="trending",xd="actionDetails",Ld="iAdPlacementId",Fd="GET",Nd="Grid",Md="{title}",Ud="large",Bd="todayBrick",qd="light",Gd="Room",Vd="prefersLargeTitle",Hd="latest-release-app",$d="data",Wd="achievements",zd="arcadeProductPage",jd="{osVersion}",Yd="mixedMediaLockup",Kd="inAppPurchase",Qd="developers",Jd="pageType",Xd="Any",Zd="code",ep="pathname",tp="contexts",np="presentModalFormSheet",rp="card-contents",op="displaySubStyle",ip="text/x-apple-as3-nqml",sp="its_contentId",ap="Arcade",cp="isStandaloneForWatchOS",lp="tvos",up="text",dp="query",pp="Search",fp="moreByDeveloper",hp="upsellMarketingItem",mp="create",gp="color",yp="smallStoryCard",Tp="ACTION_SEE_ALL",wp="videoPreviewsByType",Ip="preorder",Ap="releaseDate",Sp="arcadeSeeAllGames",bp="appletvos",Pp="iad",kp="detailPage",Ep="privacyFooter",Cp="similarItems",_p="informationRibbon",Rp="videos",Op="header",vp="topLockup",Dp="eventType",xp="impressions",Lp="today",Fp="true",Np="colored",Mp="arcadeGeneric",Up="arcade-apps",Bp="type",qp="tabs",Gp="screenshotsByType",Vp="expectedReleaseDateDisplayFormat",Hp="rating",$p="view",Wp="never",zp="screenshots",jp="leading",Yp="lockup",Kp="renderPage",Qp="artistName",Jp="osx",Xp="privacyTypes",Zp="brandedSingleApp",ef="searchTerm",tf="paragraph",nf="gameCenter",rf="array",of="product",sf="app",af="short",cf="displayStyle",lf="video",uf="sort",df="privacyHeader",pf="friendsPlaying",ff="number",hf="action",mf="text/plain",gf="marketing-items",yf="center",Tf="in-apps",wf="flowPreview",If="links",Af="groupings",Sf="description",bf="bundleId",Pf="adamId",kf="none",Ef="macOS",Cf="isAppleWatchSupported",_f="navigate",Rf="iphone",Of="mediumLockup",vf="children",Df="label",xf="requiredCapabilities",Lf="developer",Ff="ios",Nf="finance",Mf="ipad",Uf="ignoredValue",Bf="boolean",qf="infer",Gf="account",Vf="search",Hf="dark",$f="productPage",Wf="link",zf="information",jf="article",Yf="iOS",Kf="token",Qf="white",Jf="macRequiredCapabilities",Xf="minimumOSVersion",Zf="messages",eh="coercible",th="genre",nh="default",rh="editorial-items",oh="sequential",ih="isPreorder",sh="editorialVideo",ah="swoosh",ch="smallLockup",lh="editorialArtwork",uh="artwork",dh="unknown",ph="standard",fh="contents",hh="page",mh="reviews",gh="app-bundles",yh="undefined",Th="arcade",wh="button",Ih="string",Ah="apps",Sh="url",bh="name",Ph="pad",kh="phone",Eh="watch",Ch="mac",_h="shelf";var Rh=n(2),Oh=n(0);function vh(e){return Lh(e)?null:Array.isArray(e)?e.join("."):e}const Dh={};function xh(e,t,n){if(null==e)return n;if(!t)return e;let r;if(typeof t===Ih){if(r=Dh[t],!r){if(!t.includes(".")){const r=e[t];return null!=r?r:n}r=t.split("."),Dh[t]=r}}else r=t;let o=e;for(const e of r)if(o=o[e],null==o)return n;return o}function Lh(e){return null==e}function Fh(e){return Lh(e)||0===Object.keys(e).length}function Nh(e){return typeof e!==yh&&null!==e}function Mh(e){return Nh(e)&&0!==Object.keys(e).length}function Uh(e){if(Lh(e))return!1;let t;return t=typeof e===Ih?parseInt(e):e,!Number.isNaN(t)}function Bh(e,t){const n=xh(e,t,null);return Array.isArray(n)?n:(Lh(n)||Oh.context("asArrayOrEmpty",()=>{Oh.unexpectedType(Uu,rf,n,vh(t))}),[])}function qh(e,t){const n=xh(e,t,null);return typeof n===Bf?n:(Lh(n)||Oh.context("asBooleanOrFalse",()=>{Oh.unexpectedType(Uu,Bf,n,vh(t))}),!1)}function Gh(e,t,n=eh){const r=xh(e,t,null);if(Lh(r)||typeof r===Ih)return r;{const e=typeof r===qu?null:String(r);switch(n){case da:Oh.context("asString",()=>{Oh.unexpectedType(ed,Ih,r,vh(t))});break;case eh:Lh(e)&&Oh.context("asString",()=>{Oh.unexpectedType(ed,Ih,r,vh(t))})}return e}}function Vh(e,t,n=eh){const r=xh(e,t,null);if(Lh(r)||typeof r===ff)return r;{const e=Number(r);switch(n){case da:Oh.context("asNumber",()=>{Oh.unexpectedType(ed,ff,r,vh(t))});break;case eh:if(isNaN(e))return Oh.context("asNumber",()=>{Oh.unexpectedType(ed,ff,r,vh(t))}),null}return e}}function Hh(e,t,n){const r=xh(e,t,null);return r instanceof Object&&!Array.isArray(r)?r:(Lh(r)||Oh.context("asDictionary",()=>{Oh.unexpectedType(Uu,qu,r,vh(t))}),Nh(n)?n:null)}function $h(e,t,n){return Hh(e,t,n)}function Wh(e,t,n=eh){const r=xh(e,t,null);if(Lh(r))return null;if(typeof r===Bf)return r;if(typeof r===Ih){if(r===Fp)return!0;if(r===al)return!1}const o=Boolean(r);switch(n){case da:Oh.context("asBoolean",()=>{Oh.unexpectedType(ed,ff,r,vh(t))});break;case eh:if(Lh(o))return Oh.context("asBoolean",()=>{Oh.unexpectedType(ed,ff,r,vh(t))}),null}return o}function zh(e){if(null==e)return null;switch(typeof e){case Ih:case ff:case Bf:return e;case qu:return Array.isArray(e),e;default:return Oh.context(tr,()=>{Oh.unexpectedType(Uu,"JSONValue",typeof e)}),null}}function jh(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(Oh.context(tr,()=>{Oh.unexpectedType(Uu,qu,typeof e)}),null)}const Yh=typeof ask!==yh?ask.props:{tvAppEnabledStorefronts:["143441","143455","143460"],spamBlockingExtensionsEditorialItemID:"1490737895",clientFeatures:{}};function Kh(e){const t=xh(Yh,e);return typeof t!==yh?Boolean(t):typeof ask!==yh&&Boolean(Yh.clientFeatures[e])}function Qh(e){return Hh(Yh,e)}function Jh(e){return Gh(Yh,e)}bag.registerBagKeys([{key:xr,type:Sh},{key:Vf,type:Sh},{key:Lr,type:Sh},{key:Fr,type:Sh},{key:Nr,type:Bf},{key:Mr,type:Sh},{key:Ur,type:Sh},{key:Br,type:Sh},{key:"passbook",type:Sh},{key:qr,type:Sh},{key:rd,type:"dictionary"},{key:Gr,type:Ih},{key:Ca,type:Ih},{key:Vr,type:Sh},{key:Hr,type:Bf},{key:$r,type:Bf},{key:Wr,type:Bf},{key:zr,type:Sh},{key:jr,type:Sh},{key:Yr,type:Bf},{key:Kr,type:Sh},{key:"voteUrl",type:Sh},{key:Qr,type:Sh},{key:Jr,type:Ih},{key:Xr,type:rf},{key:Zr,type:Sh},{key:eo,type:Sh},{key:_a,type:host.clientIdentifier===Ea?Sh:Ih},{key:to,type:Ih},{key:no,type:Ih},{key:ro,type:rf},{key:oo,type:ff},{key:io,type:Ih},{key:so,type:rf},{key:"ageBands",type:rf},{key:ao,type:rf},{key:co,type:Ih},{key:lo,type:Ih},{key:uo,type:Ih},{key:po,type:Ih},{key:fo,type:Ih},{key:ho,type:Ih},{key:mo,type:Ih},{key:go,type:rf},{key:yo,type:rf},{key:To,type:Bf},{key:wo,type:Sh},{key:Io,type:Bf},{key:Ao,type:Ih},{key:So,type:Sh},{key:bo,type:Ih},{key:Po,type:rf},{key:ko,type:rf},{key:Eo,type:rf},{key:Co,type:ff},{key:_o,type:ff},{key:Ro,type:Bf},{key:Oo,type:Ih},{key:vo,type:Bf},{key:Do,type:ff},{key:xo,type:ff},{key:Lo,type:Bf},{key:Fo,type:ff},{key:No,type:ff},{key:Mo,type:Ih},{key:Uo,type:rf},{key:Bo,type:Ih},{key:qo,type:Ih},{key:Go,type:Bf},{key:Vo,type:Bf},{key:Ho,type:rf},{key:$o,type:Ih}]);var Xh={get trendingSearchesURL(){return bag.url(xr)},get searchHintsURL(){return bag.url(Lr)},get personalizedUserReviewURL(){return bag.url(Fr)},get personalizedUserReviewEnabled(){return bag.boolean(Nr)},get userRateURL(){return bag.url(Mr)},get writeReviewURL(){return bag.url(Ur)},get accessoryRoomURL(){return bag.url(Br)},get passbookMainURL(){return bag.url("passbook")},get libraryLinkURL(){return bag.url(qr)},get metricsConfiguration(){return jh(bag.dictionary(rd))},get language(){return bag.string(Ca)},get mediaApiLanguage(){const e=bag.string(Gr);return e||bag.string(Ca)},get termsAndConditionsURL(){return bag.url(Vr)},get usePostForAppStoreSearch(){return bag.boolean(Hr)},get isMonetaryGiftingEnabled(){return bag.boolean($r)},get accountTopUpURL(){return bag.url(zr)},get isContentGiftingEnabled(){return bag.boolean(Wr)},get buyButtonMetadataURL(){return bag.url(jr)},get isTVAppEnabled(){return bag.boolean(Yr)},get emailSupportLinkURL(){return bag.url(Kr)},get voteUrl(){return bag.url("voteUrl")},get reportConcernUrl(){return bag.url(Qr)},get reportConcernExplanation(){return bag.string(Jr)},get reportConcernReasons(){return Bh(zh(bag.array(Xr)))},get createAccountUrl(){return bag.url(Zr)},get mediaCountryCode(){return bag.string(io)},get mediaHost(){return bag.url(eo)},get mediaEdgeHost(){return host.clientIdentifier===Ea?bag.url(_a):bag.string(_a)},get mediaEdgeSearchHost(){return bag.string(no)},get mediaPreviewHost(){return bag.string(to)},get edgeEndpoints(){const e=bag.array(ro);return typeof e===yh?[]:Bh(zh(e))},get mediaAdvertRequestLimit(){return bag.double(oo)||4},get searchSortOptions(){return Bh(zh(bag.array(so)))},get ageBands(){return Bh(zh(bag.array("ageBands")))},get redirectUrlWhitelistedQueryParams(){let e=Bh(zh(bag.array(ao)));return Fh(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e},get redirectUrlEndpoint(){return bag.string(co)||"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"},get aristotleParentAppAdamId(){return bag.string("aristotle-app-id")||"383941000"},get arcadeAppAdamId(){return bag.string(lo)},get arcadeProductFamilyId(){return bag.string(uo)||bag.string(po)},get arcadeProductId(){return bag.string(fo)||bag.string(ho)},get searchTransparencyAdamId(){return bag.string(mo)},get hideableSystemApps(){return Bh(zh(bag.array(go)))},get tabsStandard(){return Bh(zh(bag.array(yo)))},get isArcadeComingSoonEnabled(){return bag.boolean(To)},get watchAppsGroupingURL(){return bag.url(wo)||"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"},get requireAgeVerification(){return bag.boolean(Io)},get ageRatingLearnMoreEditorialItemId(){return bag.string(Ao)},get appleSiliconMacUnverifiedBadgeEditorialItemId(){return bag.string(Oo)},get safariExtensionsGroupingURL(){return bag.url(So)},get familySubscriptionsLearnMoreEditorialItemId(){return bag.string(bo)},get dynamicUIRegexStrings(){const e=bag.array(Po);return typeof e===yh?[]:Bh(zh(e))},get financeUIRegexStrings(){const e=bag.array(ko);return typeof e===yh?[]:Bh(zh(e))},get webViewRegexStrings(){const e=bag.array(Eo);return typeof e===yh?[]:Bh(zh(e))},get arcadePreOrderUpsellLimitSeconds(){return bag.double(Co)||86400},get recentlyPlayedGamesWindowInSeconds(){return bag.double(_o)||7776e3},get enableComingSoonToggle(){return bag.boolean(vo)},get enablePrivacyNutritionLabels(){return bag.boolean(Ro)||!1},get arcadeOfferEditorialItemId(){return bag.string(Bo)},get sponsoredSearchODMLTimeout(){return bag.double(Do)||3},get isSearchLandingAdsEnabled(){return bag.boolean(Lo)},get searchLandingAdFetchTimeout(){return bag.double(xo)||.175},get searchLandingPageOffscreenRefreshInterval(){return bag.double(Fo)||60},get searchLandingPageRefreshUpdateDelayInterval(){return bag.double(No)||.3},get appPrivacyLearnMoreEditorialItemId(){return bag.string(Mo)},get suppressedPrivacyAppIds(){const e=bag.array(Uo);return typeof e===yh?[]:Bh(zh(e))},get appPrivacyDefinitionsEditorialItemId(){return bag.string(qo)},get enableArcadeTrialEligibleBadging(){return bag.boolean(Go)},get enableExternalPurchases(){var e;return null!=(e=bag.boolean(Vo))&&e},get enabledExternalPurchasesPlacements(){return Bh(zh(bag.array(Ho)))},get externalPurchasesLearnMoreEditorialItemId(){return bag.string($o)}};class Zh{constructor(){this.$incidents=void 0}isValid(){return!0}}class em extends Zh{constructor(e=null){super(),this.impressionMetrics=e}}class tm extends Zh{constructor(e,t,n,r,o,i,s,a,c,l,u,d,p,f){super(),this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=p,this.additionalHeaders=f}}class nm extends Zh{constructor(e,t,n,r,o,i,s,a,c,l,u,d,p,f,h,m,g,y){super(),this.offerType=e,this.adamId=t,this.parentAdamId=r,this.style=null==n?qf:n,this.environment=null==o?qd:o,this.tint=null==i?Yl:i,this.offerTint=null==s?{type:Yl}:s,this.titles=null==a?{}:a,this.subtitles=null==c?{}:c,this.hasInAppPurchases=l,this.hasExternalPurchases=u,this.isDeletableSystemApp=d,this.isFree=p,this.isPreorder=f,this.offerLabelStyle=null==h?kf:h,this.hasDiscount=m,this.contentRating=g,this.subscriptionFamilyId=y}newOfferDisplayPropertiesChangingAppearance(e,t,n,r,o){return new nm(this.offerType,this.adamId,null==t||!e&&this.style===Su?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.tint:r,null==o?this.offerTint:o,this.titles,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId)}}class rm extends Zh{constructor(e,t,n){super(),this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}class om extends Zh{constructor(e,t,n){super(),this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class im extends Zh{constructor(e,t,n,r){super(),this.checksum=null,this.backgroundColor=null,this.style=null,this.crop="bb",this.template=e,this.width=t,this.height=n,this.variants=r}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class sm extends Zh{constructor(e,t){super(),this.artwork=e,this.mediaPlatform=t}}class am extends Zh{constructor(e,t,n,r){super(),this.appPlatform=e,this.supplementaryAppPlatforms=n||[],this.deviceCornerRadiusFactor=r,this.mediaType=t}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort();const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",");return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class cm{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new cm(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}class lm extends Zh{constructor(e,t,n,r,o,i){super(),this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class um extends Zh{constructor(e,t,n){super(),this.context=jf,this.text=e,this.subtitle=t,this.artwork=n}}class dm extends Zh{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(),this.context=of,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class pm extends Zh{constructor(e,t,n){super(),this.metadata=e,this.url=t,this.shortUrl=n}}class fm extends Zh{constructor(e,t,n){super(),this.reasonId=e,this.name=t,this.uppercaseName=n}}class hm extends Zh{constructor(e,t=mf){super(),this.rawText=e,this.rawTextType=t}}class mm extends em{constructor(e,t,n){super(),this.text=e,this.mediaType=t||mf,this.style=n||ph,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class gm extends Zh{constructor(e,t=null,n=null){super(),this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class ym extends em{}class Tm extends Zh{constructor(e){super(),this.isFallbackStyle=!1,this.type=e}}class wm extends em{constructor(e,t,n,r,o,i,s){super(),this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.outOfTotalText=r,this.completedText=o,this.action=i,this.achievements=s}}class Im extends Zh{constructor(e){super(),this.type=e}}class Am extends Zh{constructor(e,t,n,r){super(),this.id=e,this.title=t,this.subtitle=n,this.status=r}}class Sm extends Zh{constructor(e,t,n,r){super(),this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class bm extends Zh{constructor(e,t){super(),this.playerId=e,this.timestamp=t}}let Pm;Pm=ask.client;const km="com.apple.AppStore",Em="com.apple.AppStore.BridgeStoreExtension",Cm="com.apple.MobileSMS",_m="com.apple.Arcade",Rm="com.apple.TVAppStore",Om="com.apple.AppStore.ProductPageExtension",vm="com.apple.AppStore.SubscribePageExtension",Dm=Pm.deviceType,xm=cm.fromNativeSize(Pm.screenSize),Lm=Pm.screenCornerRadius,Fm=Pm.guid,Nm=Pm.thinnedApplicationVariantIdentifier,Mm=Pm.storefrontIdentifier,Um=Pm.newPaymentMethodEnabled,Bm=Pm.buildType,qm=Pm.isActivityAvailable,Gm=Pm.isElectrocardiogramInstallationAllowed,Vm=typeof Pm.isScandiumInstallationAllowed!==yh&&Pm.isScandiumInstallationAllowed,Hm=Pm.isSidepackingEnabled,$m=typeof Pm.isTinkerWatch!==yh&&Pm.isTinkerWatch,Wm=Pm.supportsHEIF,zm=Pm.activePairedWatchSystemVersion;function jm(){return Pm.isAutomaticDownloadingEnabled()}function Ym(e){return Pm.deviceHasCapabilities(e)}function Km(e,t,n){return!!Pm.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion&&Pm.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}function Qm(e){return!Pm.isPairedSystemVersionAtLeast||Pm.isPairedSystemVersionAtLeast(e)}function Jm(e){if(!Xm()||!Pm.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion)return!1;const t=e.split(".");return!Km(Vh(t[0])||0,Vh(t[1])||0,Vh(t[2])||0)}function Xm(){return Dm!==Eh&&void 0!==zm}function Zm(e){return Pm.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}let eg=null;const tg=typeof ask!==yh?ask.loc:{identifier:"en",arcadeWordmarkAssetName:"arcade-wordmark-en",decimal:e=>null!=e?String(e):null,string:e=>e,stringWithCount:(e,t)=>e,stringWithCounts:(e,t)=>e,uppercased:e=>e,fileSize:e=>null!=e?e+" bytes":null,formattedCount:e=>null!=e?""+e:null,timeAgo:e=>null!=e?e.toString():null,timeAgoWithContext:(e,t)=>null!=e?e.toString():null,formatDate:(e,t)=>null!=t?t.toString():null,formatDateWithContext:(e,t,n)=>null!=t?t.toString():null,formatDateInSentence:(e,t,n)=>null!=n?n.toString():null,relativeDate:e=>null!=e?e.toString():null},ng=tg.identifier,rg=tg.arcadeWordmarkAssetName,og=ng.split("_")[0],ig={};function sg(e,t){let n=ig[e];if(!n)if(n=tg.string(e),n&&n!==e)ig[e]=n;else{const r=Rh.its.loc(e);n=r!==e?r:t||e}return n}function ag(e,t,n){let r=tg.stringWithCount(e,t);if(!r||r===e){const o=Rh.its.locWithCount(e,t,n);o&&(r=o)}return r}function cg(e,t,n){return tg.stringWithCounts?tg.stringWithCounts(e,t):null}function lg(e){return e?og?e.toLocaleUpperCase(og):e:null}function ug(e,t){let n=tg.decimal(e,t);return n||(n=typeof e===ff?`* ${e.toString()} *`:"* null *"),n}function dg(e){let t=tg.fileSize(e);return t||(t="* null *"),t}function pg(e){let t=tg.formattedCount?tg.formattedCount(e):null;return t||(t="* null *"),t}function fg(e,t){let n;return n=Kh(Cr)?tg.timeAgoWithContext(e,t):tg.timeAgo(e),n||(n="* null *"),n}function hg(e,t){let n=tg.formatDate(e,t);return n||(n="* null *"),n}function mg(e,t,n){let r=tg.formatDateInSentence(e,t,n);return r||(r="* null *"),r}function gg(e,t){yg(e)||(eg=e,Rh.its.updateLocale(t))}function yg(e){return eg===e}function Tg(){if(void 0===Xh.language||null===Xh.language)return Promise.reject(new Error("Bag language is not available. Unable to load localizations."));{const e=function(e,t){if(null==e)return null;switch(e=e.toLowerCase()){case"yue-hant":{const e=Jh("macauStorefrontIdentifier");return typeof t===Ih&&-1!==t.indexOf(e)?"zh-ma":"zh-hk"}default:return e}}(Xh.language,Mm),t="local/"+e;if(!yg(t)){const n=Qh("localizations."+e);if(null!=n)gg(t,n);else{const e=Qh("localizations.en-us");null!=e&&gg(t,e)}}return new Promise((e,t)=>{e()})}}function wg(e){return Tg().then(t=>e())}const Ig=["284417353","1464590764","314638464","284993479","1351056256"];class Ag extends Zh{constructor(e,t,n,r,o=!1){super(),this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class Sg{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class bg extends Zh{constructor(e,t){super(),this.data=e,this.invocationPoints=t}}class Pg extends Ag{}class kg extends Zh{constructor(e){super(),this.fields=e}}class Eg extends Zh{constructor(e){super(),this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}class Cg extends Zh{constructor(){super(),this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n=new bg(e,t);this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class _g extends Sg{constructor(e,t){super(e.fields,e.id,e.custom||{}),this.custom.isFast=t,this.isFast=t}}function Rg(e){switch(e){case ql:case zd:case $f:case Pr:return!0;default:return!1}}class Og extends em{constructor(e,t,n,r){super(),this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class vg extends Zh{constructor(e,t,n){super(),this.headline=e,this.body=t,this.artwork=n}}class Dg extends Zh{constructor(e,t,n,r,o){super(),this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class xg extends em{constructor(e,t){super(),this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class Lg extends Zh{constructor(e,t,n,r){super(),this.serviceType=e,this.placement=t,this.seed=n,this.clientOptions=r,this.contextInfo=r,this.metricsOverlay={topic:"xp_amp_appstore"}}}class Fg extends Zh{constructor(e){super(),this.clientOptions=e,this.metricsOverlay={topic:"xp_amp_appstore"}}}class Ng extends Zh{constructor(e,t){super(),this.primaryIcon=e,this.icons=t}}class Mg extends Zh{constructor(e){super(),this.action=e}}class Ug extends em{constructor(e){super(),this.title=null,this.artwork=null,this.presentationStyle=[],this.actionClass=e,this.actionMetrics=new Eg}}class Bg extends Ug{constructor(e,t){super(Oa),this.page=e,this.pageUrl=t,this.pageData=null,this.presentationContext=qf,this.animationBehavior=qf,this.origin="inapp"}}class qg extends Ug{constructor(e){super(br),this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class Gg extends Ug{constructor(e,t){super("TabBadgeAction"),this.navigationTab=e,this.text=t}}class Vg extends Ug{constructor(e,t=!0){super("ExternalUrlAction"),this.url=e,this.isSensitive=t}}class Hg extends Ug{constructor(e){super("CompoundAction");const t=[];for(const n of e)this.actionMetrics.addManyMetricsData(n.actionMetrics.data),n.actionMetrics.clearAll(),t.push(n);this.actions=t}}class $g extends Ug{constructor(e,t,n){super("OfferAction"),this.title=e,this.adamId=t,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem)}}class Wg extends Ug{constructor(e,t){super("OfferConfirmationAction"),this.buyAction=e,this.confirmationInitiationAction=t}}class zg extends Ug{constructor(){super("OfferAlertAction"),this.title=null,this.message=null,this.footerMessage=null,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=wd,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class jg extends Ug{constructor(e,t,n,r,o){super("InAppPurchaseAction"),this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class Yg extends Ug{constructor(e,t){super("OfferStateAction"),this.title=t.title,this.adamId=e,this.defaultAction=t}}class Kg extends Ug{constructor(e,t=sf){super("OpenAppAction"),this.adamId=e,this.destination=t}}class Qg extends Ug{constructor(e){super("HttpAction"),this.url=e,this.method=Fd,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class Jg{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class Xg extends Ug{constructor(e){super("HttpTemplateAction"),this.message=null,this.url=e,this.method=Fd,this.headers={},this.body=null,this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class Zg extends Xg{}class ey extends Ug{constructor(e,t){super("WriteReviewAction"),this.adamId=e,this.url=t}}class ty extends Ug{constructor(e){super("SheetAction"),this.actions=e,this.isCancelable=!1,this.message=null,this.style=nh}}class ny extends Ug{constructor(e){super("AlertAction"),this.style=e,this.title=null,this.message=null,this.isCancelable=!1,this.buttonActions=[],this.buttonTitles=[]}}class ry extends Ug{constructor(e,t){super("ScrollingAlertAction"),this.title=e,this.message=t}}class oy extends Ug{constructor(e,t,n="expanded"){super("ShareSheetAction"),this.data=e,this.actions=t,this.shareSheetStyle=n}}class iy extends Ug{constructor(e){super("ReportConcernAction"),this.reasons=e}}class sy extends Ug{constructor(e,t){super("ProductPageScrollAction"),this.section=e,this.clicksOnScroll=t}}class ay extends Ug{constructor(e,t,n,r){super("ArcadeAction"),this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n}}class cy extends Ug{constructor(e){super("FamilyCircleAction"),this.clientName=e}}class ly extends Ug{constructor(){super("BlankAction")}}class uy extends Ug{constructor(e,t){super("SearchAdAction"),this.action=e,this.searchAd=t}}class dy extends Ug{constructor(e,t,n){super("SearchAdClickTrackingAction"),this.impressionId=t,this.iAd=n,this.title=e.title,this.actionMetrics.addManyMetricsData(e.actionMetrics.data),e.actionMetrics.clearAll(),this.action=e}}class py extends Ug{constructor(e,t){super("RateLimitedAction"),this.actionKey=e,this.primaryAction=t}}class fy extends Ug{constructor(e,t,n,r){super("ArcadeSubscriptionStateAction"),this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class hy extends Ug{constructor(e){super("GameCenterPlayerProfileAction"),this.playerId=e}}class my extends Ug{constructor(e){super("GameCenterAchievementsAction"),this.bundleId=e}}class gy extends Ug{constructor(e){super("GameCenterInvitePlayerAction"),this.contactId=e}}class yy extends Ug{constructor(e){super("GameCenterBlacklistPlayerAction"),this.contactId=e}}class Ty extends Ug{constructor(e,t){super("EngagementToggleAction"),this.identifier=e,this.value=t}}function wy(e,t,n){switch(e){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t){const n=[];for(const t of Iy)if(t in e){const e=new Ty(t,!1);n.push(e)}for(const r of Iy){if(t.includes(r))continue;const o=e[r];if(Nh(o)){const e=Ay(r,o);n.push(e);break}}if(n.length>0)return new Mg(new Hg(n));{const e=new ly;return new Mg(e)}}(t,n);case"didBecomeArcadeTrialEligible":if(!Xh.enableArcadeTrialEligibleBadging)return console.log("Bag prohibits badging for identifier com.apple.Arcade.TrialEligible1"),new Mg(new ly);if(n.includes("com.apple.Arcade.TrialEligible1"))return console.log("Badging identifier com.apple.Arcade.TrialEligible1 was previously invalidated."),new Mg(new ly);const e=new Ty("com.apple.Arcade.TrialEligible1",!0),r=new Gg(Th,ug(1)),o=new Hg([e,r]);return new Mg(o);case"didSubscribeToArcade":return function(){const e=[];for(const t of Iy){const n=new Ty(t,!1);e.push(n)}const t=new Hg(e);return new Mg(t)}();case"didBecomeSubscribed":if(!Nh(t["com.apple.Arcade.TrialEligible1"]))return new Mg(new ly);const i=new Ty("com.apple.Arcade.TrialEligible1",!1);return new Mg(i);case"didBecomeNonSubscribed":return new Mg(new ly);default:return null}}const Iy=["com.apple.Arcade.ArcadeHardware1","com.apple.Arcade.TrialEligible1"];function Ay(e,t){const n=function(e){switch(e){case"com.apple.Arcade.ArcadeHardware1":return"badge_hardware";case"com.apple.Arcade.TrialEligible1":return"badge_trial_eligible";default:return null}}(e),r=new Lg(Th,Mp,null,{offerHints:n});r.metricsOverlay={...r.metricsOverlay,...t};const o=new Bg(hp);return o.pageData=r,o}let Sy;Sy=ask.appleSilicon;const by=typeof Sy!==yh&&Sy.isSupportEnabled,Py=typeof Sy!==yh&&typeof Sy.isRosettaAvailable!==yh?Sy.isRosettaAvailable:by;function ky(){switch(Dm){case kh:return Rf;case Ph:return Mf;case"tv":return Is;case Ch:return Ch;case Eh:return Eh;default:return null}}function Ey(){switch(host.clientIdentifier){case Na:case gl:return[];default:{const e=ky();return function(e){const t=new Set;if(t.add(Rf),t.add(Mf),t.add(Is),t.add(Ch),t.add(Eh),null!==e)for(const n of e)t.delete(n);return Array.from(t)}(new Set([e]))}}}function Cy(){switch(Dm){case kh:return 6;case Ph:return 10;case Ch:return 12;default:return 8}}function _y(){let e=null;return host.clientIdentifier===Cm?e=Zf:host.clientIdentifier===Em?e=Eh:Dm===Eh&&$m&&(e="tinker"),e}class Ry{constructor(e){if(this.ids=new Set,this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.platform=ky(),!Fh(e))if(typeof e===Ih)this.href=e;else if(Array.isArray(e)){const t=new Set;for(const n of e)t.add(n.type),this.ids.add(n.id);1===t.size?this.resourceType=t.values().next().value:t.size>1&&(this.resourceType=fh)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)Mh(t)&&this.ids.add(t);return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t);return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map);let n=this.scopedRelationshipIncludes.get(e);n||(n=new Set);for(const e of t)n.add(e);return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map);let n=this.metaIncludes.get(e);n||(n=new Set);for(const e of t)n.add(e);return this.metaIncludes.set(e,n),this}includingRelationshipsForUpsell(e){if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map);let e=this.scopedRelationshipIncludes.get(rh);e||(e=new Set),e.add("marketing-items"),this.scopedRelationshipIncludes.set(rh,e)}else this.relationshipIncludes.add("marketing-items");{this.metaIncludes||(this.metaIncludes=new Map);let e=this.metaIncludes.get(gf);e||(e=new Set),e.add(rd),this.metaIncludes.set(gf,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t);return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map);let n=this.scopedAttributeIncludes.get(e);n||(n=new Set);for(const e of t)n.add(e);return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t);return this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t);return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return by&&(e||this.enablingFeature(Nn),this.includingScopedAttributes(Ah,[$t])),this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return this.sparseLimit=e,this}withSparseCount(e){return this.sparseCount=e,this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}}class Oy extends Zh{constructor(e,t,n,r,o){super(),this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}class vy extends Zh{constructor(e){super(),this.categories=e}}const Dy=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])");function xy(e){if(!e)return null;const t=Dy.exec(e);if(null===t||4!==t.length)return null;return{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,type:"rgb"}}function Ly(e,t=84){switch(e.type){case"rgb":return 100*(.2126*(n=e).red+.7152*n.green+.0722*n.blue)<t;case sl:return function(e){switch(e.name){case"black":return!0;default:return!1}}(e);default:return!1}var n}function Fy(e){return{name:e,type:sl}}function Ny(e,t){return{lightColor:e,darkColor:t,type:ua}}var My;!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation"}(My||(My={}));const Uy="_jet-internal:derived-data".toString();function By(e,t,n){return e?Oh.context(t,()=>{let r=e[Uy],o=null;return r?(o=xh(r,t),o||(o=qy(r,t,n))):(r={},e[Uy]=r,o=qy(r,t,n)),o}):null}function qy(e,t,n){const r=n();return e[t]=r,r}const Gy={internal:"x-as3-internal",http:"http",https:"https",itms:"itms",itmss:"itmss",itmsAppss:"itms-appss",itmsApps:"itms-apps",itmsMessagess:"itms-messagess",itmsMessages:"itms-messages",itmsWatchs:"itms-watchs",itmsWatch:"itms-watch",file:"file",resource:"resource",macappstore:"macappstore",macappstores:"macappstores",tvappstoreLegacy:"com.apple.tvappstore",tvappstore:"com.apple.TVAppStore",arcade:bs},Vy=_h,Hy="WebObjects/MZStore.woa/wa",$y="WebObjects/MZStoreElements.woa/wa",Wy="lookup",zy="docTypeLookup",jy="install",Yy="viewGrouping",Ky="viewArtist",Qy="viewSoftware",Jy=Lp,Xy=Th,Zy=Sp,eT="arcadeSeeAllGamesLoadMore",tT=th,nT=dc,rT="recommendationsSeeAll",oT="viewRoom",iT="viewTop",sT=Kl,aT=sf,cT=vc,lT=or,uT=Lf,dT="artist",pT=mh,fT="viewContentsUserReviews",hT="personalizedReviews",mT=cu,gT=Pu,yT=ir,TT="todayCardPreview",wT="mso",IT="resetAndRedirect",AT=Gf,ST="personalizationTransparency",bT=gc,PT=md,kT="tv-eula",ET=Kt,CT="apps-for-you",_T="storeFront",RT="tab",OT="searchLandingPage",vT="searchTrendingApps",DT=Es,xT="showUpdatesPage",LT="showAccountPage",FT="showPurchasesPage",NT="showSubscriptionsPage",MT="searchExtensions",UT="search.itunes.apple.com",BT="storepreview.apple.com",qT=of,GT=Tt,VT="arcadeSubscribePageCustomContext",HT="arcadeWelcomePage",$T=Sp,WT="appClipSubscribe",zT="familyCircle",jT="spamBlockingExtensions",YT="safariExtensions",KT="id",QT="ids",JT="fcId",XT="fetchData",ZT="isTodaySection",ew="popId",tw="genreId",nw=th,rw="bundleIdentifier",ow=bf,iw=jl,sw="chartIdentifier",aw=Kl,cw="v0",lw=hf,uw=Bp,dw="context",pw="isArcade",fw="isSubscribed",hw="isTrialAvailable",mw="isArcadeSeeAllGamesShelf",gw="isGameCenterPlayerShelf",yw="isGameCenterPlayerRibbonItem",Tw="isGameCenterAchievementsShelf",ww="isGameCenterContinuePlayingShelf",Iw="isGameCenterPopularWithYourFriendsShelf",Aw="isGameCenterSuggestedFriendsShelf",Sw="isGameCenterReengagementShelf",bw="isPurchasesApp",Pw="enabled",kw=gc,Ew="recoMetrics",Cw="showingFallbackMedia",_w="path",Rw="useReleaseId",Ow=Wt,vw="message",Dw=Pu,xw="askToBuyId",Lw="appId",Fw="isPPT",Nw=uf,Mw=vu,Uw=Zd,Bw="includePostSubscribeAttribution",qw=Kf,Gw="privacyTypeId",Vw="requestDescriptor",Hw="ageRating",$w=mt,Ww="multiplayerSupport",zw=Zi,jw="offerHints",Yw="uc",Kw="collection-id",Qw="seed-id",Jw="inAppPurchaseId",Xw="productUrl",Zw=Nc,eI="minExternalVersionId",tI=Pf,nI=uf,rI="availableAdamIds",oI=sf,iI=mh,sI=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,aI=/([^=?&]+)=?([^&]*)/g,cI=["hash",dp,ep,"host"];function lI(e,t,n){const r=e.indexOf(t);let o,i=e;if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length);"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}class uI{constructor(e){if(this.query={},!e)return;let t=e;const n=sI.exec(e);if(n){let e=n[1];e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:null};for(const e of cI){if(!r.remainder)break;switch(e){case"hash":r=lI(r.remainder,"#",pa),this.hash=r.result;break;case dp:r=lI(r.remainder,"?",pa),r.result&&(this.query=uI.queryFromString(r.result));break;case ep:r=lI(r.remainder,"/",pa),r.result&&(this.pathname="/"+r.result);break;case"host":if(r.remainder){const e=lI(r.remainder,"@","prefix"),t=e.result,n=e.remainder;if(t){const e=t.split(":");this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":");this.host=e[0],this.port=e[1]}}break;default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this;switch(e===dp&&typeof t===Ih&&(t=uI.queryFromString(t)),e){case dp:this.query=t;break;default:this[e]=t}return this}append(e,t){const n=this[e];let r;if(e===dp)typeof t===Ih&&(t=uI.queryFromString(t)),r=typeof n===Ih?{existingValue:n,...t}:{...n,...t};else{let o=n;o||(o="");let i=o;if(e===ep){const e=o.length;e&&"/"===n[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(ep,e)}pathExtension(){if(void 0===this.pathname)return null;const e=this.pathname.split("/").filter(e=>e.length>0).pop().split(".");return e.filter((function(e){return""!==e})).length<2?null:e.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}build(){return this.toString()}toString(){let e="";return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname),this.query&&Object.keys(this.query).length&&(e+="?"+uI.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={};let n=aI.exec(e);for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2]);t[r]=o,n=aI.exec(e)}return t}static toQueryString(e){let t="",n=!0;for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r);const o=e[r];o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new uI(e)}static fromComponents(e,t,n,r,o){const i=new uI;return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}let dI;function pI(e){if(!Nh(dI.cookieForUrlWithName))return null;return function(e,t){return Oh.context("currentExperimentGroup",()=>{if(!t||!t.value||0===t.value.length)return null;const n=t.value.replace(/^\d+#/,"").split("#").map(e=>e.replace(/^(.*\+)/,"")).filter(t=>{const n=t.slice(0,-1);return e.identifer===n});if(0===n.length)return null;n.length>1&&Oh.unexpectedType(Uf,Ih,n,t.name+" cookie");const r=n[0].match(/\d$/);if(null===r||0===r.length)return Oh.unexpectedType(Uf,e.treatments.join("|"),r[0],`${t.name} cookie, ${n}, treatment id`),null;const o=Number(r[0]),i=e.treatments.find(e=>e===o)||null;return i||Oh.unexpectedType(Uf,e.treatments.join("|"),o,`${t.name} cookie, ${n}, treatment id`),i})}(e,dI.cookieForUrlWithName("https://apple.com","xp_ab"))}dI=ask.user;const fI={identifer:"2Tp1_Sa",treatments:[0,1]},hI={identifer:"3NepyQj",treatments:[0,1]};function mI(e,t,n){return Lh(e)?null:Hh(e.attributes,t,n)}function gI(e,t){return Lh(e)?[]:Bh(e.attributes,t)}function yI(e,t,n=eh){return Lh(e)?null:Gh(e.attributes,t,n)}function TI(e,t,n=eh){return Lh(e)?null:Wh(e.attributes,t,n)}function wI(e,t){return!Lh(e)&&qh(e.attributes,t)}function II(e,t,n=eh){return Lh(e)?null:Vh(e.attributes,t,n)}function AI(e){return!Lh(Hh(e,"attributes"))}function SI(e,t){return xh(mI(e,"platformAttributes"),t)}function bI(e,t){return Mh(SI(e,t))}function PI(e,t,n){const r=SI(e,t);return Lh(r)?null:Hh(r,n)}function kI(e,t,n,r=eh){const o=SI(e,t);return Lh(o)?null:Gh(o,n,r)}function EI(e,t,n=!0){const r=CI(e,t);return!!r&&!(!r.data||n&&0===r.data.length)}function CI(e,t){return $h(e.relationships,t)}function _I(e,t){const n=Bh(e.relationships,[t,$d]);return 0===n.length?null:(n.length>1&&(console.warn("there was an array of relationships when only the first was asked for in relationship "+t),console.log(JSON.stringify(e))),n[0])}function RI(e,t){return Bh(e.relationships,[t,$d])}function OI(e){const t=Mh(e.href)?e.href:function(e){switch(e){case Ko:case mh:return`/v1/${vI(e)}/`;default:return`/v1/${vI(e)}/${Xh.mediaCountryCode}/`}}(e.resourceType),n=new uI(t);if(Mh(e.resourceType))for(const t of function(e){switch(e.resourceType){case md:return[e.resourceType,e.targetResourceType];case il:return[Vf,e.resourceType,e.targetResourceType];case ll:return[Ah];case mh:return[mh,Ah];case mc:return[mc];case hp:return["upsell",gf];case Bn:return[Vf,e.resourceType];default:return[e.resourceType]}}(e))n.append(ep,t);if(e.ids.size>1||e.useIdsAsQueryParam)n.param("ids",Array.from(e.ids).join(","));else if(1===e.ids.size){const t=e.ids.values().next().value;n.append(ep,t)}const r=function(e){switch(e){case ll:return mh;default:return null}}(e.resourceType);if(Mh(r)&&n.append(ep,r),n.param(od,e.platform),e.additionalPlatforms.size>0&&n.param("additionalPlatforms",Array.from(e.additionalPlatforms).sort().join(",")),e.attributeIncludes.size>0&&n.param("extend",Array.from(e.attributeIncludes).sort().join(",")),Nh(e.scopedAttributeIncludes))for(const t of e.scopedAttributeIncludes.keys()){const r=e.scopedAttributeIncludes.get(t);n.param(`extend[${t}]`,Array.from(r).sort().join(","))}if(e.relationshipIncludes.size>0&&n.param("include",Array.from(e.relationshipIncludes).sort().join(",")),Nh(e.scopedRelationshipIncludes))for(const t of e.scopedRelationshipIncludes.keys()){const r=e.scopedRelationshipIncludes.get(t);n.param(`include[${t}]`,Array.from(r).sort().join(","))}if(Nh(e.metaIncludes))for(const t of e.metaIncludes.keys()){const r=e.metaIncludes.get(t);n.param(`meta[${t}]`,Array.from(r).sort().join(","))}Mh(e.fields)&&(e.fields.sort(),n.param(fc,e.fields.join(","))),Nh(e.limit)&&e.limit>0&&n.param("limit",""+e.limit),Nh(e.sparseLimit)&&e.sparseLimit>0&&n.param("sparseLimit",""+e.sparseLimit),Nh(e.sparseCount)&&e.sparseCount>0&&n.param("sparseCount",""+e.sparseCount);for(const t of Object.keys(e.relationshipLimits).sort()){const r=e.relationshipLimits[t];n.param(`limit[${t}]`,""+r)}Mh(e.additionalQuery)&&n.append(dp,e.additionalQuery),Mh(e.searchTerm)&&(n.append(ep,Vf),n.param("bubble[search]",e.searchTypes.join(",")),n.param(du,e.searchTerm)),Mh(e.enabledFeatures)&&n.param(Ec,e.enabledFeatures.join(",")),Mh(e.context)&&n.param(tp,e.context),Mh(e.filterType)&&Mh(e.filterValue)&&n.param(`filter[${e.filterType}]`,e.filterValue);const o=Xh.mediaApiLanguage;return Lh(o)||n.param("l",o),n.host=function(e,t){const n=e.pathname;let r=null;if(t.isStorePreviewRequest)r=Xh.mediaPreviewHost;else if(n.includes("search/landing")){const e=-1!==Xh.edgeEndpoints.indexOf(il);r=e?Xh.mediaEdgeHost:Xh.mediaHost}else r=Xh.edgeEndpoints.map(e=>n.includes(e)).reduce(DI,!1)?n.includes(Vf)?Xh.mediaEdgeSearchHost:Xh.mediaEdgeHost:Xh.mediaHost;Lh(r)&&(r="api.apps.apple.com");return r}(n,e),n.protocol="https",n}function vI(e){switch(e){case Ah:case Up:case gh:case Kl:case fh:case Qd:case md:case Tf:case xa:case ll:return"catalog";case wl:case rh:case Za:case Af:case mc:case ol:case Vl:case Lp:return oa;case el:return el;case Ko:case mh:return"me";case hp:case il:return"engagement";case v:return"recommendations";default:return"catalog"}}const DI=(e,t)=>e||t;function xI(e,t,n=!1){return By(e,"dataHasDeviceFamily."+t,()=>{if(!e||!t)return!1;return-1!==NI(e,n).indexOf(t)})}function LI(e,t,n=!1){return xI(e,t,n)&&1===NI(e,n).length}function FI(e,t,n=!1){const r=new Set(NI(e,n));return t.length===r.size&&t.every(e=>r.has(e))}function NI(e,t=!1){const n=gI(e,Ot);if(0===n.length&&t){const n=RI(e,Ah);for(const e of n){const n=NI(e,t);if(Mh(n))return n}}return n}function MI(e){throw new Error("This method should never be called with value: ${value}")}function UI(e){let t=e.targetType;return t||(t=Yp),t}function BI(e){let t=e.idType;return t||(t=Il),t}function qI(e){return uL(e)?ap:null}function GI(e){const t=Gh(e,Bp),n=xI(e,Ch,!0),r=LI(e,Ch,!0),o=function(e,t,n=!1){const r=new Set(NI(e,n));for(const e of t)if(r.has(e))return!0;return!1}(e,[Rf,Mf,Bu,lp,Eh],!0),i=FI(e,[Rf,Mf,Bu,lp,Eh],!0),s=Dm===kh||Dm===Ph||"tv"===Dm||Dm===Eh,a=Dm===Ch&&by;if(r||n&&Dm===Ch)switch(t){case Ah:return We;case gh:return"macSoftwareBundle"}if(i||o&&s||o&&a)switch(t){case Ah:return On;case gh:return"mobileSoftwareBundle"}switch(t){case Tf:return"softwareAddOn";case Af:return vu;case Za:case rh:return Pu;default:return null}}function VI(e){return null==e?"":e}function HI(e){if(!e)return null;const t=new uI(e);let n=null;for(const e of Object.keys(t.query))if("referrer"===e){t.query[e]===vc&&(n="com.apple.siri");break}return n}function $I(e){return $h(function e(t){if(Lh(t))return null;if(t instanceof Array){const n=[];for(const r of t){const t=e(r);Nh(t)&&n.push(t)}return n}if(t instanceof Object){const n={};return Object.keys(t).forEach((r,o,i)=>{const s=t[r],a=e(s);Nh(a)&&(n[r]=a)}),n}return t}(jh(e)))}function WI(e){if(!e)return null;const t=new uI(e),n=t.query[du],r=t.pathname;if(Lh(n)||Lh(r))return null;if(!r.endsWith("/search"))return null;return n}function zI(e,t){if(!e||!t)return dh;if(e.type===gh)return $i;const n=t.style;switch(n){case ps:return Ff;case"unadorned":return Ch;case"tvRect":return"tv";case"round":return Eh;case"pill":return Zf;case"iap":return"iap";default:return MI(),dh}}function jI(e){if(!Nh(e))return null;const t={},n=Hh(e,sr);if(!Mh(n))return null;const r=Gh(n,wr);Mh(r)&&(t[wr]=r);const o=Gh(n,Ir);return Mh(o)&&(t[Ir]=o),t.marketing={marketingItemId:e.id,offerDecisionId:Gh(e,"meta.metrics.decisionId")},t}class YI{constructor(){this.location=null,this.position=0}}function KI(e,t){const n=oA(e.locationTracker);return n.push(nA(e,t)),n}function QI(e,t){const n=oA(e.locationTracker);return n.push(rA(e,t)),n}function JI(e,t){const n=new YI;n.location=nA(e,t),e.locationTracker.locationStack.push(n)}function XI(e,t){const n=new YI;n.location=rA(e,t),e.locationTracker.locationStack.push(n)}function ZI(e){0!==e.locationStack.length?e.locationStack.pop():Oh.unexpectedType(Uf,"non-empty location stack","empty location stack")}function eA(e){const t=iA(e);return t?t.position:e.rootPosition}function tA(e){const t=iA(e);t?t.position++:e.rootPosition++}function nA(e,t){var n;const r=rA(e,t);if(!e.id&&e.locationTracker)r.idType=oh,r.id=eA(e.locationTracker).toString();else{r.idType=BI(e);let t=e.id;(null===(n=e.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&(t=e.anonymizationOptions.anonymizationString),r.id=VI(t)}return e.fcKind&&(r.fcKind=e.fcKind),e.displayStyle&&(r.displayStyle=e.displayStyle),r}function rA(e,t){var n;let r=t;(null===(n=e.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&(r=e.anonymizationOptions.anonymizationString);const o={locationPosition:eA(e.locationTracker),locationType:UI(e),name:VI(r)};return e.recoMetricsData&&Object.assign(o,e.recoMetricsData),o}function oA(e){return e.locationStack.map(e=>e.location)}function iA(e){const t=e.locationStack.length;return 0===t?null:e.locationStack[t-1]}function sA(e,t,n,r){n||(n=pA(e));let o=PI(e,n,t);return o||(o=mI(e,t,r)),o}function aA(e,t){let n=function(e,t,n){const r=SI(e,t);return Lh(r)?[]:Bh(r,n)}(e,pA(e),t);return Fh(n)&&(n=gI(e,t)),n}function cA(e,t,n=eh){let r=kI(e,pA(e),t,n);return r||(r=yI(e,t,n)),r}function lA(e,t,n,r=eh){n||(n=pA(e));let o=function(e,t,n,r=eh){const o=SI(e,t);return Lh(o)?null:Wh(o,n,r)}(e,n,t,r);return o||(o=TI(e,t,r)),o}function uA(e,t,n){n||(n=pA(e));let r=function(e,t,n){const r=SI(e,t);return!Lh(r)&&qh(r,n)}(e,n,t);return r||(r=wI(e,t)),r}function dA(e,t,n=eh){let r=function(e,t,n,r=eh){const o=SI(e,t);return Lh(o)?null:Vh(o,n,r)}(e,pA(e),t,n);return Lh(r)&&(r=II(e,t)),r}function pA(e){return By(e,"bestAttributePlatformFromData",()=>{const t=FI(e,[Rf,Mf,Bu],!0),n=LI(e,lp),r=LI(e,Ch),o=LI(e,Eh);let i=null;if(n?i=bp:r?i=Jp:t?i=Ff:o&&(i=Eh),!Lh(i))return i;const s=function(){const e=fA();switch(e){case Ff:return[Ff,bp,Jp];case Jp:return[Jp,Ff,bp];case bp:return[bp,Ff,Jp];case Eh:return[Ff,Eh,Jp];default:return[e]}}();for(const t of s)if(bI(e,t))return t;return fA()})}function fA(){switch(Dm){case kh:case Ph:return Ff;case"tv":return bp;case Ch:return Jp;case Eh:return Eh;default:return null}}function hA(e){var t,n;let r=e.id,o=e.title;if(Mh(e.anonymizationOptions)){const i=null!=(n=null===(t=e.anonymizationOptions)||void 0===t?void 0:t.anonymizationString)?n:"ANONYMOUS";r=i,o=i}const i={id:VI(r),name:VI(o),idType:BI(e),impressionType:UI(e)};if(e&&e.kind&&(i.kind=e.kind),e&&e.softwareType&&(i[Vc]=e.softwareType),e&&e.recoMetricsData&&Object.assign(i,e.recoMetricsData),e&&e.mercuryMetricsData&&Object.assign(i,e.mercuryMetricsData),e&&e.lockupDisplayStyle&&(i[$c]=e.lockupDisplayStyle),e&&e.locationTracker){const t=eA(e.locationTracker);i.impressionIndex=t,""===i.id&&(i.id=t.toString(),i.idType=oh)}return Nh(e.offerType)&&(i[fl]=e.offerType),e&&Nh(e.displaysArcadeUpsell)&&(i[er]=e.displaysArcadeUpsell),e&&Nh(e.isPreorder)&&(i[ih]=e.isPreorder),Nh(e.adamId)&&Fh(e.anonymizationOptions)&&(i[Pf]=e.adamId),e&&Nh(e.badges)&&(i.badges=e.badges),""===i.id&&console.log(`impressionId missing. Tracking broken for ${i.name} of ${i.impressionType}`),i}function mA(e,t){e&&(e.impressionMetrics=new Sg(hA(t)))}function gA(e,t,n,r,o){const i=yA(e,t.title,r);return i.lockupDisplayStyle=n,o&&uL(e)&&(i.displaysArcadeUpsell=!0),i}function yA(e,t,n){return Oh.context("impressionOptions",()=>{const r=GI(e),o=qI(e),i={...n,kind:r,softwareType:o,title:t,id:e.id};return lA(e,ih)&&(i.offerType=Ip),i})}function TA(e,t){var n,r;const o=hA((n=e.term,e.entity,r=t,Oh.context("impressionOptionsForSearchHint",()=>({...r,id:"",kind:null,softwareType:null,title:n}))));e.entity&&(o[lu]=e.entity),e.impressionMetrics=new Sg(o)}function wA(e){if(null==e)return e;const t=Object.create(Object.getPrototypeOf(e));return Object.assign(t,e),t}function IA(e,t){return e instanceof t}function AA(e,t){const n=Math.pow(10,t);return(e>0?Math.floor:Math.ceil)(e/n)*n}class SA{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=Gh(n,"fieldName");if(Lh(t))continue;const r=Vh(e,t);if(Lh(r))continue;let o=Vh(n,"magnitude");Lh(o)&&(o=1048576);let i=Vh(n,"significantDigits");if(Lh(i)&&(i=2),o<=0||i<0){e[t]=Number.NaN;continue}const s=r/o;e[t]=AA(s,i)}}_derezFastImpressions(e){const t=Gh(e,ha),n=Vh(e,ma);if(t!==cr||4!==n)return;const r=Bh(e,xp);e[xp]=r.map(e=>{const t=Bh(e,lr);return 0===t.length||(e[lr]=t.map(e=>{const t=Vh(e,"d");return e.s=0,e.d=AA(t,2),e})),e})}_decorateSearchResultImpressions(e){const t=Gh(e,Jd),n=Gh(e,ku);t===pp&&n!==Zu&&function(e){const t=Bh(e,xp);let n;for(const e of t){if(Gh(e,Sr)===ra){n=e[Ia];break}}n&&(e[xp]=t.map(e=>(Gh(e,Sr)===Fl&&(e.impressionParentId=n),e)))}(e)}_decorateAll(e,t){const n=this._options.bagProvider,r=n("metricsBase",t);Lh(r)||typeof r!==qu||Object.assign(e,r),e.clientBuildType=this._options.buildType,e.resourceRevNum=this._options.jsVersion,e.xpSendMethod="jet-js",this._options.buyDecorator.useApp(Gh(e,sf)),delete e.jet_adamId;const o=function*(e){if(Lh(e))return;const t=e.split(";");for(const e of t){const t=e.indexOf("=");if(-1===t){const t=decodeURIComponent(e).trim();yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim();yield{key:n,value:r}}}}(Gh(e,"cookie"));for(const t of o)if("xp_ci"===t.key){this._options.buyDecorator.useClientId(t.value),e.clientId=t.value,delete e.clientGeneratedId;break}delete e.cookie;const i=Gh(e,Jd),s=Gh(e,ku);if(!Lh(i)&&!Lh(s)){const r=Gh(n("compoundSeparator",t))||"_";e[hh]=`${i}${r}${s}`}const a=Bh(n("deResFields",t));this._reduceFieldAccuracy(e,a)}_decorateClick(e){!function(e){const t=Gh(e,wu),n=Gh(e,Sa);Lh(t)&&Mh(n)&&(e[wu]=n),"pending"===Gh(e,ba)&&delete e[Pa]}(e),this._decorateSearchResultImpressions(e)}_decorateImpressions(e){if(Fh(e[xp]))throw new Error("Empty impressions event filtered");this._derezFastImpressions(e),this._decorateSearchResultImpressions(e);const t=Gh(e,hd);Mh(t)&&(e[ef]=WI(t),delete e[hd])}_decorateMedia(e){const t=Vh(e,qs);Lh(t)||(e[qs]=Math.round(t))}_decoratePage(e){const t=Gh(e,hd);Lh(t)||(e.refApp=HI(t),e[ef]=WI(t));const n=Gh(e,hh);Lh(n)||(e.pageHistory=this._options.buyDecorator.getPageHistoryFor(n))}_decorateSearch(e){e[ma]=3,function(e){var t;const n=null!=(t=e[xd])?t:{},r=n[wu],o=Gh(e,Sa);Lh(r)&&Mh(o)&&(n[wu]=o,e[xd]=n),"pending"===Gh(e,ba)&&delete e[Pa],"input"===e[mu]&&delete e[Pa]}(e)}_decorateEnter(e){if(Fh(Bh(e,ur))){const t=Xh.language;e[ur]=[t]}}_filterExtraneous(e){!function(e){delete e[Sa],delete e[ba],delete e.searchGhostHintTermLastDisplayed}(e)}makeEvent(e){const t=Gh(e,Dp);this._options.isLoggingEnabled&&console.log("Building event for topic: "+t);const n=Gh(e,"topic")||this._options.defaultTopic;this._decorateAll(e,n);const r=e.extRefUrl;switch(r&&""===r&&delete e.extRefUrl,t){case"enter":this._decorateEnter(e);break;case ul:this._decorateClick(e);break;case"exit":break;case xp:this._decorateImpressions(e);break;case"media":this._decorateMedia(e);break;case hh:this._decoratePage(e);break;case Vf:this._decorateSearch(e)}return this._filterExtraneous(e),new kg(e)}}function bA(e){var t;if(!(host.platform===fs))return e;const n=$m;if(dI.isUnderThirteen&&n)return e;const r=null!=(t=e.excludingFields)?t:[];return r.push("amsMetricsID"),new Pg(e.fields,e.includingFields,r,e.topic,e.shouldFlush)}function PA(e,t,n,r){const o={};Object.assign(o,n),o[Dp]=ul,o[fa]=t,o.targetId=e;const i=["impressionsSnapshot",td];return r&&i.push(...r),bA(new Ag(o,i,[],_A(o),CA(o)))}function kA(e,t,n,r,o,i){const s={};Object.assign(s,o),s[du]=e,s[fa]=t,s[mu]=n,r&&(s[yu]=r),s[Dp]=Vf;const a=[gu];return i&&a.push(...i),bA(new Ag(s,a,[],_A(s),CA(s)))}function EA(e,t){const n={};let r;return Object.assign(n,e),n[Dp]=xp,n[ha]="data-metrics",n[ma]=4,r=t?[xp,td,gu,nd]:[xp,td,gu],bA(new Ag(n,r,[],_A(n),CA(n)))}function CA(e){const t=e[Dp];let n=!1;if(!Mh(t))return n;switch(t){case ul:n=qh(e,SA.hasIAdData);break;case"exit":n=!0;break;case xp:n=qh(e,SA.hasIAdData)}return host.clientIdentifier!==vm||Kh("subscribePageExtensionEnterExitEvents")||(n=!0),n}function _A(e){return e.topic||"xp_amp_appstore"}function RA(e){const t={};return e?(Object.assign(t,e.baseFields),e.pageUrl?t[dl]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(t[dl]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(t,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(t,e.mercuryMetricsData),e.iAdInfo&&Mh(e.iAdInfo.placementId)&&(t[Ld]=e.iAdInfo.placementId),$I(t)):t}function OA(e,t){const n=RA(t.pageInformation);n.id=VI(t.id),n.idType=BI(t),n[Bp]=lf,n.typeDetails="iTunesStoreContent",n[Tu]=KI(t,null),t.actionDetails&&(n[xd]=t.actionDetails),e.templateMediaEvent=function(e){const t={};return Object.assign(t,e),t[Dp]="media",bA(new Ag(t,[],[],_A(t),CA(t)))}(n);const r=wA(n);r[yu]=e.videoUrl,e.templateClickEvent=function(e,t,n){const r={};return Object.assign(r,n),r[Dp]=ul,r[fa]=t,r.targetId=e,bA(new Ag(r,[td],[],_A(r),CA(r)))}(null,wh,r)}SA.hasIAdData="hasiAdData";class vA extends Zh{constructor(e,t,n){super(),this.title=e,this.annotations=t,this.forceExpanded=n}}class DA extends Zh{constructor(e,t,n,r){super(),this.title=e,this.summary=n,this.items=t,this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class xA extends Zh{constructor(e,t,n,r){super(),this.text=e,this.heading=t,this.subText=n,this.listText=r}}class LA extends Zh{constructor(e){super(),this.annotationGroups=e}}class FA extends em{constructor(e){super(),this.art=e}}class NA extends Zh{constructor(e,t){super(),this.allowsAutoPlay=!0,this.type=e,this.lockup=t}}NA.backgroundColor=Ny(xy(ka),xy(Hc));class MA extends Zh{constructor(e,t,n){super(),this.message=e,this.action=t,this.fullProductAction=n}}class UA extends Zh{constructor(e){super(),this.lockup=e}}UA.backgroundColor=Ny(xy(ka),xy(Hc));class BA extends Zh{constructor(e,t,n){super(),this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.showPlaybackControls=n.showPlaybackControls,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class qA extends Zh{}class GA extends Zh{constructor(e,t){super(),this.items=e,this.mediaPlatform=t}}class VA extends Zh{constructor(e,t){super(),this.type=e,this.linkAction=t}}class HA extends Zh{constructor(e,t,n){super(),this.paragraph=e,this.developerAction=n,this.developerLinks=t}}class $A extends Zh{constructor(e){super(),this.text=e,this.presentationStyle=[],this.clickAction=null}}class WA extends Zh{}class zA extends em{isValid(){return!!this.title&&(!(!this.icon||!this.icon.isValid())&&super.isValid())}}class jA extends zA{isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class YA extends zA{constructor(){super(),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null}}class KA extends zA{isValid(){return!(!this.trailers||!this.trailers.isValid())&&(!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid())}}class QA extends Zh{constructor(e,t){super(),this.allowsAutoPlay=!0,this.looping=!0,e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0&&super.isValid()}}class JA extends zA{}class XA extends em{}class ZA extends zA{isValid(){if(this.children)for(const e of this.children)if(!e.isValid())return!1;return super.isValid()}}class eS extends Zh{constructor(e,t,n){super(),this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}class tS extends em{constructor(){super(),this.adamId=null,this.caption=null,this.title=null,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.crossLinkLockupIsDark=null,this.decorations=[],this.flowPreviewActionsConfiguration=null}isValid(){return!!this.clickAction&&(!(!this.artwork||!this.artwork.isValid())&&(!(!this.caption||!this.title)&&super.isValid()))}}class nS extends em{constructor(){super(),this.flowPreviewActionsConfiguration=null}}class rS extends em{constructor(){super(),this.artwork=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=kf,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null}isValid(){return this.clickAction&&this.artwork&&this.artwork.isValid()&&super.isValid()}}class oS extends em{constructor(e,t,n,r=!0){super(),this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class iS extends Zh{constructor(e,t){super(),this.styledText=e,this.linkedSubstrings=t}}class sS extends Zh{constructor(e,t,n){super(),this.text=e,this.clickAction=t,this.type=n}}class aS extends Zh{constructor(e){super(),this.disclaimer=e}}class cS extends Zh{constructor(e){super(),this.buttons=e}}class lS extends Zh{constructor(e,t){super(),this.title=e,this.action=t}}class uS extends em{constructor(e,t,n=mf,r=null,o=null,i=null){super(),this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===Bf?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class dS extends em{constructor(e,t,n=mf,r=null,o=null,i=null){super(),this.canPlayFullScreen=!0,this.allowsAutoPlay=!0,this.looping=!0,this.showAudioControl=!0,this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===Bf?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class pS extends Zh{constructor(e,t,n,r){super(),this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class fS extends em{constructor(e,t,n,r){super(),this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class hS extends em{constructor(e,t){super(),this.text=e,this.attribution=t}}class mS extends Zh{constructor(e,t,n){super(),this.style=e,this.color=t,this.isFullWidth=n}}class gS extends em{constructor(e,t,n,r,o){super(),this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class yS extends em{constructor(e,t){super(),this.title=e,this.buttonAction=t}}class TS extends Zh{constructor(e,t,n,r,o,i){super(),this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class wS extends em{constructor(e,t,n,r,o,i){super(),this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.backgroundColor=i}}class IS extends em{constructor(e,t,n){super(),this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class AS extends em{constructor(e,t){super(),this.unsubscribedAction=e,this.subscribedAction=t}}AS.shelfBackgroundColor=Ny(xy(ka),xy(Hc));class SS extends em{constructor(e,t,n,r,o,i,s,a,c){super(),this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class bS extends em{constructor(e){super(),this.contentType=e,this.items=[],this.url=null,this.mergeWhenFetched=!1,this.batchGroup=null,this.seeAllAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.title=null,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.backgroundColor=null,this.rowsPerColumn=null,this.background={type:kf},this.isPersonalized=!1,this.shouldFilterApps=!1}}class PS extends em{constructor(e,t,n,r,o){super(),this.title=e,this.artwork=t,this.heading=n,this.description=r,this.clickAction=o,this.shelfBackground=null}}class kS extends zA{isValid(){const e=this.posterArtwork,t=this.posterVideo;return!(!e&&!t)&&super.isValid()}}const ES={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},CS={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:Dm===Ch,muteUnmute:!0},_S={playbackControls:ES,autoPlayPlaybackControls:CS},RS={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1};var OS=function(){if(Dm===Eh){const e=new Map;for(const t of Xh.hideableSystemApps){const n=Gh(t,"bundle-id",eh),r=Gh(t,"id",eh);e.set(r,n)}const t=new Map;return{bundleIdFromData(t){const n=e.get(t.id);return Lh(n)?cA(t,bf):n},isDeletableSystemAppFromData:t=>e.has(t.id),isUnsupportedDeletableSystemAppFromData(n){if(e.has(n.id)){const r=e.get(n.id);if(Mh(r)){if(t.has(r))return t.get(r);const e=!Zm(r);return t.set(r,e),e}}return!1}}}return{bundleIdFromData:e=>cA(e,bf),isDeletableSystemAppFromData:e=>wI(e,gd),isUnsupportedDeletableSystemAppFromData:e=>!1}}();function vS(e,t=63486){let n=!1;return 2&t&&(n=n||function(e){if(Dm===Eh)return!1;return uA(e,$)||uA(e,W)}(e)),4&t&&(n=n||function(e){return By(e,"shouldFilterDeletableSystemApp",()=>{if(!OS.isDeletableSystemAppFromData(e))return!1;const t=OS.bundleIdFromData(e),n=host.deviceModel,r=n.startsWith("iPhone"),o=n.startsWith("iPad");let i;switch(i=!!OL("12.3")||Xh.isTVAppEnabled,t){case"com.apple.Bridge":return!r;case"com.apple.calculator":case"com.apple.weather":return o;case"com.apple.Photo-Booth":return!o;case"com.apple.tv":return!i;case"com.apple.videos":return i;case"com.apple.iCloudDriveApp":return!0;case"com.apple.facetime":return!Ym(["any-telephony"])||!Ym(["venice"]);case"com.apple.Fitness":if(o){let e=!1;return Nh(dI.isFitnessAppInstallationAllowed)&&(e=dI.isFitnessAppInstallationAllowed),!e}return!qm;case"com.apple.measure":return!Ym(["arkit"]);case"com.apple.Jellyfish":return!Ym(["front-depth-camera"]);case z:case j:return!0;case"com.apple.NanoHeartRhythm":return!!Kh("ECG")&&!Gm;case"com.apple.NanoCompass.watchkitapp":return!Ym(["magnetometer"]);case"com.apple.NanoOxygenSaturation.watchkitapp":return!Vm;case"com.apple.Translate":return o}return!1})}(e)),8&t&&(n=n||function(e){return By(e,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const t=uA(e,Cf),n=e.type===gh;return host.clientIdentifier===Em&&!t&&!n})}(e)),16&t&&(n=n||function(e){if(e.type!==Tf)return!1;return!wI(e,"isMerchandisedEnabled")}(e)),32&t&&(n=n||function(e){return By(e,"shouldFilterLegacyApps",()=>{const t=cA(e,bf);if(Dm===kh||Dm===Ph)switch(t){case"com.apple.mobileme.fmip1":case z:return!0}if(Dm===Eh)switch(t){case j:case"com.apple.findmy.findpeople":return!0}if(Dm===Ch)switch(t){case"com.apple.FaceTime":return!0;case"com.apple.InstallAssistant.Seed.macOS1013Seed1":case"com.apple.InstallAssistant.OSX12PublicSeed2":case"com.apple.InstallAssistant.OSX12CustomerSeed1":case"com.apple.InstallAssistant.OSX12Seed2":return!0;case"com.apple.Server.v3":case"com.apple.Server.v2":case"com.apple.Server.v1":return!0}return!1})}(e)),64&t&&(n=n||function(e){return By(e,"isLegacyMacOSInstaller",()=>{const t=cA(e,bf);if(!(Dm===Ch))return!1;switch(t){case"com.apple.InstallAssistant.ElCapitan2":case"com.apple.InstallAssistant.ElCapitan":case"com.apple.InstallAssistant.Yosemite":case"com.apple.InstallAssistant.Mavericks":case"com.apple.InstallAssistant.MountainLion":case"com.apple.InstallAssistant.Lion":case"com.apple.InstallAssistant.Sierra":case"com.apple.InstallAssistant.HighSierra":case"com.apple.InstallAssistant.Mojave":return!0}return!1})}(e)),128&t&&(n=n||function(e){return By(e,"shouldFilterUnsupportedPlatform",()=>{if(e.type!==Ah&&e.type!==gh)return!1;const t=$x(e),n=Wx(e,by);return!Kx(t,Dm,n)})}(e)),256&t&&(n=n||function(e){return By(e,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!wI(e,ih))return!1;if(e.type!==Ah)return!1;const t=$x(e),n=Wx(e,by);return!Jx(t,Dm,n)})}(e)),512&t&&(n=n||function(e){if(Dm===kh&&uA(e,cp)){if(!function(e){if(Lh(e)||0===e.length)return!0;const t=e.split("."),n=Vh(t[0])||0,r=Vh(t[1])||0,o=Vh(t[2])||0;return Km(n,r,o)}(cA(e,Ol)))return!0}if(Dm===Eh){return!OL(cA(e,Ol))}return!OL(zx(e,by))}(e)),1024&t&&(n=n||function(e){return!(!Xh.isArcadeComingSoonEnabled||!wI(e,Ja))}(e)),2048&t&&(n=n||function(e){if(Dm===Eh)return!1;const t=wI(e,gd),n=!uA(e,fi)&&uA(e,cp);return t&&n}(e)),4096&t&&(n=n||function(e){if(Dm!==Eh)return!1;if(uA(e,cp)||uA(e,pi))return!1;const t=pA(e);return!function(e){if(Lh(e)||0===e.length)return!0;return Qm(e)}(kI(e,t,Xf))}(e)),8192&t&&(n=n||function(e){if(Dm!==Ch)return!1;return uA(e,Y,fA())&&!by}(e)),16384&t&&(n=n||function(e){const t=TI(e,ih);return!Kh(Xa)&&t&&uL(e)}(e)),32768&t&&(n=n||function(e){const t=$x(e);if(Dm!==Ch||!t.includes(Ch))return!1;return!Qx(e,by,Py)}(e)),n}class DS{constructor(e,t,n,r){this.placementType=e,this.placementId=this.placementIdFromType(e),this.pageFields={},this.clickFields={},this.impressionsFields={},this.fastImpressionFields={},this.iAdClickEventFields={},this._iAdApplied=!1,this._iAdId=t,this._iAdAdamId=null,this.pageFields[SA.hasIAdData]=!0,this.pageFields[mr]=n,this.pageFields[Xu]=VI(t),Nh(r)&&(this.pageFields.iAdOdmlSuccess=r)}get iAdIsPresent(){return this._iAdApplied}get iAdAdamId(){return this._iAdAdamId}apply(e,t){if(this._iAdAdamId=e,t){this.impressionsFields[SA.hasIAdData]=!0,this.clickFields[SA.hasIAdData]=!0;const n=VI(this._iAdId);this.impressionsFields[Xu]=n,this.clickFields[Xu]=n;const r=VI(t[Ia]);this.fastImpressionFields[gr]=r,this.clickFields[gr]=r;const o=VI(t.metadata);this.clickFields[yr]=o,this.fastImpressionFields[yr]=o,this.pageFields[Pf]=e,this.pageFields.iAd={iAdFormat:$I($h(zh(t),"format")),iAdAlgoId:VI(t.algoId),iAdImpressionId:VI(t[Ia]),iAdMetadata:VI(t.metadata)},Mh(this.placementId)&&(this.pageFields[Ld]=this.placementId,this.impressionsFields[Ld]=this.placementId,this.clickFields[Ld]=this.placementId),Object.assign(this.iAdClickEventFields,t),this._iAdApplied=!0}}applyClickFieldsFromPageRequest(e,t){this._iAdApplied=!0,this._iAdAdamId=e,Object.assign(this.clickFields,t)}setSpecifiedCreativeUsed(e){this.fastImpressionFields[Tr]=e,this.clickFields[Tr]=e}setMissedOpportunity(e){this.pageFields[hl]=e,this.clickFields[hl]=e,this.impressionsFields[hl]=e,this.fastImpressionFields[hl]=e,"APSLA"===e&&delete this.pageFields[mr]}placementIdFromType(e){switch(e){case $u:return Aa;case Ql:return"APPSTORE_SEARCH_RESULT_PAGE";default:MI()}}}class xS{constructor(e={}){this.baseFields=e}}function LS(e){return Fh(e)?null:(-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/")))}function FS(e){const t=function(e){return Lh(e)?null:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e);return Lh(t)?null:t.getTime()}function NS(e,t){return Oh.context("clickOptionsForLockup",()=>{var n;const r=e.id.slice();let o=e.id;Mh(null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&(o=t.anonymizationOptions.anonymizationString);const i={...t,id:o,contextualAdamId:r,targetType:Yp,softwareType:qI(e)};return TI(e,ih)&&(i.offerType=Ip),i})}function MS(e,t,n,r,o,i){const s={};r&&r instanceof xS&&(i&&r.iAdInfo&&r.iAdInfo.iAdAdamId===e.adamId&&Object.assign(s,r.iAdInfo.clickFields),r.searchTermContext&&(s[ef]=r.searchTermContext.term)),s[xd]={buyParams:e.purchaseConfiguration.buyParams},s[Tu]=o,s.jet_adamId=e.adamId,n&&(s[fl]=Ip,Nh(e.expectedReleaseDate)&&(s[Ta]=FS(e.expectedReleaseDate)));const a=PA(t,wh,s);s.jet_adamId=e.adamId,a.includingFields.push("appState"),e.purchaseConfiguration.isArcadeApp&&a.includingFields.push(fr),i&&a.includingFields.push(nd),e.actionMetrics.addMetricsData(a)}function US(e,t){BS(e,{...t,actionType:Ic,subscriptionSKU:Xh.arcadeProductId,actionContext:ap,targetType:wh})}function BS(e,t,n=!1){var r;let o=t.actionType;o||(o=_f);const i={actionType:o};if(e instanceof Bg){const t=e;i[yu]=t.pageUrl}else if(e instanceof Vg){const t=e;i[yu]=t.url}t.actionDetails&&(i[xd]=t.actionDetails),t.actionContext&&(i.actionContext=t.actionContext),Nh(t.offerType)&&(i[fl]=t.offerType),Nh(t.offerReleaseDate)&&(i[Ta]=FS(t.offerReleaseDate));let s=e.title;Mh(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(s=t.anonymizationOptions.anonymizationString),i[Tu]=KI(t,s),t.pageInformation&&t.pageInformation.searchTermContext&&(i[ef]=t.pageInformation.searchTermContext.term),Nh(t.softwareType)&&(i[Vc]=t.softwareType),t.isAdvert&&n&&t.pageInformation.iAdInfo&&Object.assign(i,t.pageInformation.iAdInfo.clickFields),t.mercuryMetricsData&&Object.assign(i,t.mercuryMetricsData);const a=PA(t.id,UI(t),i);t.actionContext===ap&&("buy"===t.actionType||t.actionType===Ic)&&(a.includingFields.push(fr),a.fields.jet_adamId=t.contextualAdamId),t.isAdvert&&a.includingFields.push(nd),e.actionMetrics.addMetricsData(a)}function qS(e,t,n){const r={};Nh(t)&&(r[yu]=t),n.targetType||(n.targetType=wh),r[Tu]=QI(n,e.title),r[mu]=_f,r[Wa]="button_See All";const o=PA("See All",wh,r);e.actionMetrics.addMetricsData(o)}function GS(e,t){const n={actionType:"filter"},r=PA("filter_"+t,wh,n);r.includingFields.push(st),e.actionMetrics.addMetricsData(r)}function VS(e,t,n){const r=function(e){switch(e){case Dd:return Dd;case Ci:return Ci;case Zu:return"hint";case ta:return"searchInsteadFor";case na:return Mn;case sa:return sa;default:return"submit"}}(e.origin),o={actionType:r,actionUrl:VI(e.url),location:QI({pageInformation:null,locationTracker:n,targetType:t},e.term),page:pp,pageType:pp,searchTerm:e.term,pageDetails:"Apps"},i={targetId:e.term},s={};Mh(e.prefixTerm)&&(s[wu]=e.prefixTerm),Mh(e.entity)&&(s[lu]=e.entity),Mh(s)&&(i[xd]=s),Mh(e.originatingTerm)&&(o[wa]=e.originatingTerm,i[wa]=e.originatingTerm);const a=PA("",t,o,[hr]);e.actionMetrics.addMetricsData(a);const c=kA(e.term,t,r,e.url,i,[hr]);e.actionMetrics.addMetricsData(c)}class HS extends em{constructor(e,t,n,r,o,i,s){super(),this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s,this.detailsDisplayProperties={wantsBlur:n.wantsBlur,position:n.detailsPosition},this.backgroundColor=n.backgroundColor}}function $S(e,t,n,r){const o=t(e,r);if(!o)return Promise.resolve({originalData:e,additionalData:null});const i=Array.from(o),s=[];for(const e of i){const t=n(e);if(Lh(t)){const t=i.indexOf(e);i.splice(t,1)}else s.push(t)}return Promise.all(s).then(t=>{const n=new Map;for(const[e,r]of i.entries()){const o=t[e];n.set(r,o)}return{originalData:e,additionalData:n}})}let WS=0,zS=0;function jS(e,t){const n=OI(e).toString();WS+=1,WS>zS&&(zS=WS,zS>=6&&console.warn("Too many ("+zS.toString()+") simultaneous MediaAPI requests triggered; requests will start queuing."));const r=Date.now();return mediaToken.refreshToken().then(e=>function e(t,n,r={},o=!1){const i=new uI(t),s=YS(i);for(const e of s)i.removeParam(e);let a=r.headers;a||(a={});a.Authorization="Bearer "+n;return net.fetch({url:t,headers:a,method:r.method,body:r.requestBodyString,timeout:r.timeout}).then(n=>{try{if(401===n.status||403===n.status){if(o)throw Error("We refreshed the token but we still get 401 from the API");return mediaToken.resetToken(),mediaToken.refreshToken().then(n=>e(t,n,r,!0))}if(404===n.status)QS();else if(!n.ok){const e=new KS(`Bad Status code ${n.status} for ${t}`);throw e.statusCode=n.status,e}const s=Date.now(),a=JSON.parse(n.body),c=Date.now();if(a){if(a[My.pageInformation]=jh(function(e){const t=Mm;let n=null;if(Mh(t)){const e=t.split("-");Mh(e)&&(n=e[0])}return{serverInstance:e.headers["x-apple-application-instance"],storeFrontHeader:t,language:Xh.language,storeFront:n,environmentDataCenter:e.headers["x-apple-application-site"]}}(n)),n.metrics.length>0){const e=n.metrics[0];e.parseStartTime=s,e.parseEndTime=c,a[My.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:s,parseEndTime:c};a[My.timingValues]=e}Array.isArray(a.data)&&(Nh(i=a.data)&&0===i.length)&&QS()}return a[My.requestedUrl]=t,a}catch(e){if(e instanceof KS)throw e;throw new Error(`Error Fetching: ${t}, ${e.name}, ${e.message}`)}var i})}(n,e,t)).then(t=>{const o=Date.now();WS-=1,e.canonicalUrl&&(t[My.requestedUrl]=e.canonicalUrl);const i=o-r;return i>500?console.warn("Fetch took too long ("+i.toString()+"ms) "+n):console.log("Fetch took ("+i.toString()+"ms) "+n),t})}function YS(e){return Xh.redirectUrlWhitelistedQueryParams.filter(t=>Nh(e.query[t]))}class KS extends Error{}function QS(){const e=new KS("No content");throw e.statusCode=204,e}var JS=function(){const e=new Set;for(const t of Xh.suppressedPrivacyAppIds)e.add(t);return{shouldSuppressPrivacyInformationForAdamId:t=>!Fh(t)&&e.has(t),shouldSuppressPrivacyInformationForBundleId:t=>!Fh(t)&&(!(!e.has("com.apple.InstallAssistant.*")||!t.startsWith("com.apple.InstallAssistant."))||e.has(t))}}();const XS=[Xh.mediaHost,Xh.mediaEdgeHost,Xh.mediaEdgeSearchHost],ZS=[Sf,us,Ss,Xf,Zl,wn,Gp,As,Jc,Od,wp,Xc,Vp,js,Fu];function eb(e){const t=e.host;if(Lh(t))return!1;for(const e of XS)if(!Lh(e)&&-1!==t.indexOf(e))return!0;return!1}function tb(e){return OI(new Ry(e)).toString()}const nb=/id([0-9]+)\/?$/i;function rb(e){let t=e.query.id;const n=e.pathname;if(Lh(t)&&Mh(n)){const e=nb.exec(n);e&&e.length>1&&(t=e[1])}if(!Uh(t)){const n=e.pathComponents();Mh(n)&&(t=n[n.length-1])}return t}const ob={915249334:"1462947752"};function ib(e){let t=rb(e);if(!Uh(t))throw new Error(`Unable to map ${e.build()} to a media api url`);t in ob&&(t=ob[t]);let n=Ah,r=ZS,o=[nu,au,mh,gh,Zc,nl,iu,Gc];-1!==e.pathname.indexOf(or)&&(n=gh,r=[Gp,wp,Xf,js,Fu],o=[au,Ah,mh,iu]),Kh(zc)&&Xh.enablePrivacyNutritionLabels&&!JS.shouldSuppressPrivacyInformationForAdamId(t)&&r.push(Wu),by&&r.push(Jf);const i=Wh(e.query[pw]);(null===i||i)&&(r.push(cs,ls,sh),o.push(Lf));const s=(new Ry).forType(n).withIds([t]).includingAdditionalPlatforms(Ey()).includingRelationships(o).includingAttributes(r).addingRelationshipLimit(mh,Cy()).includingMacOSCompatibleIOSAppsWhenSupported(!0),a=e.query[eI];return Nh(a)&&s.addingQuery(eI,a),s.attributingTo(e.build())}function sb(){const e=[lh,sh,xf,Xf];return Dm===Ch?e.push(Gp):e.push(Cf),by&&e.push(Jf),e}const ab=[Hd,ui,Up,gh,Ka,Ya,El,Cl],cb=[Hd,Up,gh,Cu];function lb(){let e=[];switch(Dm){case Ch:e=e.concat(cb),by&&e.push(_l);break;case Eh:e.push("watch-apps");break;default:e=e.concat(ab)}return e}let ub;function db(e,t){if(Fh(e))return;const n=function(e){return Gh(e,"meta.metrics.clusterId")}(t);Fh(n)||hb(e,n)}function pb(e){return Fh(e)?null:function(e){return function(e){const t=ub.retrieveString(e);return Mh(t)?t:null}(fb(e))}(e)}function fb(e){return e+"-cohort-id"}function hb(e,t){const n=fb(e);var r,o;r=n,o=t,ub.storeString(o,r)}ub=typeof ask!==yh&&typeof ask.storage!==yh?ask.storage:function(){const e={};return{storeString(t,n){e[n]=t},retrieveString:t=>e[t]}}();class mb{constructor(e){this.builderClass=e}handleShelf(e,t,n,r,o){o(new Error(this.builderClass+" does not implement handleShelf"))}handlePagination(e,t,n,r,o,i){i(new Error(this.builderClass+" does not implement handlePagination"))}get shelfRoute(){return[{protocol:Gy.internal,path:this.shelfPath+"{data}"}]}get paginationRoute(){return[{protocol:Gy.internal,path:""+this.paginationPath}]}shelfUrl(e){return`${Gy.internal}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${Vy}/`}get paginationUrl(){return`${Gy.internal}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${Wy}/`}static createFlowAction(e,t,n){const r=new Bg(t);return r.pageUrl=n.build(),r.pageData=e,r}}class gb extends mb{handlePage(e,t,n,r,o){this.renderPage(e,t)}renderPage(e,t){throw new Error("renderPage is not supported on: "+this.builderClass)}handlePageError(e,t,n,r,o){n(e)}handleShelf(e,t,n,r,o){this.renderShelf(e,t).then(r,e=>{this.handleShelfError(e,r,o,t)})}renderShelf(e,t){throw new Error("renderShelf is not supported on: "+this.builderClass)}handleShelfError(e,t,n,r){n(e)}}class yb extends mb{defaultAttributes(){return[]}defaultTab(e){return null}prepareRequest(e,t,n){e.includingAdditionalPlatforms(this.defaultPlatforms()),e.includingAttributes(this.defaultAttributes())}defaultAction(e,t,n){return yb.createFlowAction(e,this.pageType(),n)}handlePage(e,t,n,r,o){Oh.context(this.builderClass+".handlePage",()=>{let n;const i=e.build();n=eb(e)?new Ry(i):this.generatePageRequest(e,t),n||o(new Error("Could not construct media API request for: "+e)),this.prepareRequest(n,e,t),n.attributingTo(i);const s=this.generateAdditionalPageRequirements(e,t),a=Object.keys(s),c=a.map(e=>s[e]),l=jS(n),u=[l,...c];l.then(e=>{db(dI.dsid,e)}),Promise.all(u).then(n=>{const r=n[0],o=n.slice(1),i={};for(let e=0;e<o.length;e++){const t=a[e];i[t]=o[e]}return this.supportsDataAugmenting()?this.augmentData(e,t,r).then(e=>this.renderPage(e.originalData,t,i,e.additionalData)):this.renderPage(r,t,i,null)}).then(n=>{const r=this.defaultTab(n),o=this.defaultAction(n,t,e),i=t[Fw];if(e.removeParam(Fw),null===r||i)return o;{const e=new qg(r);return e.actions=[o],e}}).then(r,n=>{this.handlePageError(n,r,o,e,t)})})}handlePageError(e,t,n,r,o){n(e)}handleShelf(e,t,n,r,o){Oh.context(this.builderClass+".handleShelf",()=>{let n;const i=e.build();n=eb(e)?new Ry(i):this.generateShelfRequest(e,t),n?(this.prepareRequest(n,e,t),n.attributingTo(e.build()),jS(n).then(e=>{const n=this.renderShelf(e,t);return this.shelfRequiresAdditionalModification(n,t)?this.performAdditionalShelfModifications(n,t):n}).then(r,e=>{this.handleShelfError(e,r,o,t)})):o(new Error("Could not construct media API request for: "+e))})}performAdditionalShelfModifications(e,t){return Promise.resolve(e)}shelfRequiresAdditionalModification(e,t){return!1}handleShelfError(e,t,n,r){n(e)}handlePagination(e,t,n,r,o,i){Oh.context(this.builderClass+".handlePagination",()=>{let n;const s=e.build();n=eb(e)?new Ry(s):this.generatePaginationRequest(e,t,r),n?(this.prepareRequest(n,e,t),n.attributingTo(e.build()),jS(n).then(e=>this.renderPaginatedPage(e,r)).then(o,e=>{this.handlePaginationError(e,o,i,t,r)})):i(new Error("Could not construct media API request for: "+e))})}handlePaginationError(e,t,n,r,o){n(e)}generateAdditionalPageRequirements(e,t){return{}}generateShelfRequest(e,t){throw new Error("generateShelfRequest is not supported on: "+this.builderClass)}generatePaginationRequest(e,t,n){throw new Error("generatePaginationRequest is not supported on: "+this.builderClass)}supportsDataAugmenting(){return!1}augmentData(e,t,n){const r={url:e,parameters:t};return $S(n,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,r)}additionalDataKeysNeededForData(e,t){return null}fetchAdditionalDataForKey(e){return null}renderShelf(e,t){throw new Error("renderShelf is not supported on: "+this.builderClass)}renderPaginatedPage(e,t){throw new Error("renderPaginatedPage is not supported on: "+this.builderClass)}}function Tb(e){return e&&e.remainingContent?e.remainingContent.slice(0,e.maxPerPage):[]}function wb(e){const t={...e};if(e&&e.ids){const n=Ib(e.ids,e.maxPerPage);t.ids=n}if(e&&e.remainingContent){const n=Ib(e.remainingContent,e.maxPerPage);t.remainingContent=n}return t}function Ib(e,t){return e.slice(t,e.length)}function Ab(e,t){return e.slice(t,e.length)}function Sb(e,t,n=null,r,o){return{remainingContent:e,maxPerPage:20,highestOrdinal:0,url:t,metricsPageInformation:r,metricsLocationTracker:o}}function bb(e){const t=Bh(e,$d);return t.length>1&&(console.warn("tried to extract data from container but more than one member present"),console.log(JSON.stringify(e))),1!==t.length?null:t[0]}function Pb(e){return Bh(e,$d)}function kb(e){return Nh(e.attributes)}function Eb(e){return Bh(e,Yn)}function Cb(e){return Hh(e,sr)}class _b extends Zh{constructor(){super(),this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class Rb extends Zh{constructor(e,t){super(),this.type=e,this.values=t}}class Ob extends Zh{constructor(e,t,n=null){super(),this.name=e,this.value=t,this.isSelected=t===n}}class vb extends Zh{constructor(e,t){super(),this.type=e,this.resultModel=t}}class Db extends em{constructor(e,t,n,r){super(),this.heading=e,this.title=t,this.items=n,this.detailAction=r}}class xb extends Zh{constructor(e,t,n,r){super(),this.instanceId=e,this.iAd=t,this.impressionId=n,this.iconStyle="regular",this.transparencyAction=r}}class Lb extends Ug{constructor(e){super("AdTransparencyAction"),this.adTransparencyData=e}}class Fb extends em{}class Nb extends Ug{constructor(e,t,n,r,o){super("SearchAction"),this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.presentationStyle=[Ei]}}class Mb extends Zh{constructor(e,t){super(),this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class Ub extends Zh{constructor(e,t){super(),this.title=e,this.searches=t}}class Bb extends Zh{constructor(e,t){super(),this.primaryText=e,this.secondaryText=t}}class qb{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[Xu],this.sponsoredSearchRequestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=this.sponsoredSearchRequestData&&this.sponsoredSearchRequestData.length>0,t=this.routingInfo&&this.routingInfo.length>0;return e&&t}}const Gb={showPlaybackControls:!1,canPlayFullScreen:!1,playbackControls:{}};function Vb(e,t,n,r,o){const i=Fh(o),s=Hb(e,t,r,o);if(Lh(s))return null;const a={platform:e.mediaPlatformUsedForDisplayStyle,style:s};if(Jb(`[${t}] tentatively resolved to: ${Qb(a)}`),"DUP"===n){!function(e,t){switch(e){case"PI3":t.portraitScreenshots.splice(0,3);break;case"PI2":t.portraitScreenshots.splice(0,2);break;case"PI1":t.portraitScreenshots.splice(0,1);break;case"PV3":t.videos.splice(0,1),t.portraitScreenshots.splice(0,2);break;case"PV2":t.videos.splice(0,1),t.portraitScreenshots.splice(0,1);break;case"LI1":t.landscapeScreenshots.splice(0,1);break;case"PV1":case"LV1":t.videos.splice(0,1)}}(s,e);const n=Hb(e,t,r,null),c=function(e){switch(e){case"PV3":case"PI3":case"LI1":case"LV1":return!0;case"PV2":case"PI2":return 2===Kb();default:return!1}}(n);return c&&i?(Jb(`[${t}] Organic Dupe would be full creative as ${n} so choosing tentative style for ad`),a):c&&!i&&$b(s,o)?(Jb(`[${t}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${s}`),a):$b("TEXT",o)?(Jb(`[${t}] tentative style would not yield full creative for organic result so returning TEXT`),{style:"TEXT"}):(Jb(`[${t}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}return Nh(o)&&"TEXT"===o.style?(Jb(`[${t}] tentative style would be filtered since the first ad has style: ${Qb(o)}, so returning TEXT`),{style:"TEXT"}):a}function Hb(e,t,n,r){if(!n)return Jb(`[${t}] is not allowed to display media because of iAd configuration.`),"TEXT";if(e.mediaPlatformUsedForDisplayStyle&&r&&r.mediaPlatform&&!e.mediaPlatformUsedForDisplayStyle.isEqualTo(r.mediaPlatform))return Jb(`[${t}] filtered because media is derived from: ${e.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${r.mediaPlatform.mediaType}`),null;let o,i=null;if(Mh(e.videos)){i=e.videos[0].preview}if(Mh(i)&&i.isLandscape()&&$b("LV1",r))o="LV1";else if(Mh(i)&&i.isPortrait()&&$b("PV3",r))o=Mh(e.portraitScreenshots)&&e.portraitScreenshots.length>=2?"PV3":Mh(e.portraitScreenshots)?"PV2":"PV1";else if(Mh(e.landscapeScreenshots)&&$b("LI1",r))o="LI1";else if(Mh(e.portraitScreenshots)&&$b("PI3",r))o=e.portraitScreenshots.length>=3?"PI3":e.portraitScreenshots.length>=2?"PI2":"PI1";else{if(!$b("TEXT",r))return Jb(`[${t}] filtered because we could not create a compatible style for the first style of: ${Qb(r)}`),null;o="TEXT"}return 2===Kb()&&("PI3"===o?o="PI2":"PV3"===o&&(o="PV2")),o}function $b(e,t){if(Lh(t))return!0;let n=!0;switch(e){case"TEXT":n="TEXT"===t.style;break;case"LV1":case"LI1":n="LV1"===t.style||"LI1"===t.style;break;case"PI3":case"PI2":case"PI1":case"PV3":case"PV2":case"PV1":n="PI3"===t.style||"PI2"===t.style||"PI1"===t.style||"PV3"===t.style||"PV2"===t.style||"PV1"===t.style;break;default:n=!1}return n}function Wb(e){let t=null;const n=e.trailers[0];let r=null;Mh(n)&&(n.videos.sort((e,t)=>Xb(e.preview,t.preview)),r=n.videos,t=n.mediaPlatform);const o=e.screenshots[0],i=[],s=[];return Mh(o)&&(o.artwork.forEach(e=>{e.isPortrait()?i.push(e):s.push(e)}),t=o.mediaPlatform),{portraitScreenshots:i,landscapeScreenshots:s,videos:r,mediaPlatformUsedForDisplayStyle:t}}function zb(e,t){let n=null;const r=Gh(mI(e,"iads"),t);return r&&r.length&&(n=JSON.parse(r)),n}function jb(e,t){return Fh(t)?"NOORGANIC":t.id===e.id?"DUP":"NORMAL"}function Yb(e,t,n,r){const o=n&&!r;if(Mh(e.trailers)){const t=e.trailers.shift();t.videos.sort((e,t)=>Xb(e.preview,t.preview)),e.trailers.unshift(t)}let i,s=[],a=[];if(Mh(e.screenshots)){const t=e.screenshots.shift();t.artwork.forEach(e=>{e.isPortrait()?s.push(e):a.push(e)}),i=t.mediaPlatform}switch(t.style){case"PI3":e.trailers=null,a=null,o?s.splice(0,3):s.splice(3);break;case"PI2":e.trailers=null,a=null,o?s.splice(0,2):s.splice(2);break;case"PI1":e.trailers=null,a=null,o?s.splice(0,1):s.splice(1);break;case"LI1":e.trailers=null,s=null,o?a.splice(0,1):a.splice(1);break;case"PV3":a=null,o?(e.trailers[0].videos.splice(0,1),s.splice(0,2)):(e.trailers[0].videos.splice(1),s.splice(2));break;case"PV2":a=null,o?(e.trailers[0].videos.splice(0,1),s.splice(0,1)):(e.trailers[0].videos.splice(1),s.splice(1));break;case"LV1":case"PV1":o?e.trailers[0].videos.splice(0,1):e.trailers[0].videos.splice(1),a=null,s=null;break;case"TEXT":e.trailers=null,a=null,s=null}if(Mh(e.trailers)){const t=e.trailers.shift();e.trailers=[t]}const c=[].concat(...[a,s].filter(Nh));if(Mh(c)){const t=new sm(c,i);e.screenshots=[t]}else e.screenshots=null;return e}function Kb(){return Dm===kh?3:2}function Qb(e){if(Fh(e))return"";let t="";return e&&e.mediaPlatform&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function Jb(e){console.log("[Ads] "+e)}const Xb=(e,t)=>{const n=e.isLandscape();return n===t.isLandscape()?0:n?-1:1};function Zb(e,t){if(!(t.resultModel instanceof YA))return;const n=t.resultModel,r=e.resultModel;if(r.adamId!==n.adamId)return;const o=new Set;if(Mh(r.screenshots))for(const e of r.screenshots[0].artwork)o.add(e.template);if(Mh(r.trailers))for(const e of r.trailers[0].videos)o.add(e.preview.template);if(Mh(n.screenshots)){const e=n.screenshots[0].artwork.filter(e=>!o.has(e.template));n.screenshots[0]=new sm(e,n.screenshots[0].mediaPlatform)}if(Mh(n.trailers)){const e=n.trailers[0].videos.filter(e=>!o.has(e.preview.template));n.trailers[0]=new QA(e,n.trailers[0].mediaPlatform)}}function eP(){return host.platform===Yf||host.platform===dh}class tP extends Zh{constructor(e,t,n,r,o,i,s,a,c,l=qf){super(),this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r}}class nP extends Zh{constructor(e,t,n,r){super(),this.titleStyle=e,this.title=t,this.subtitle=n,this.body=r}}class rP extends Zh{constructor(e,t){super(),this.type=e,this.shelfId=t}}class oP extends Zh{constructor(e,t){super(),this.title=e,this.subtitle=t}}class iP extends zA{constructor(){super(),this.pageMetrics=new Cg,this.pageRenderMetrics={}}}function sP(e,t,n){const r=eA(n.locationTracker),o={impressionIndex:r,id:r.toString(),idType:oh,name:e.displayName,impressionType:t,parentId:Ar};e.impressionMetrics=new Sg(o)}function aP(e,t,n,r){const o=$h(n,My.pageInformation,{}),i=$h(n,My.timingValues),s=Gh(n,My.requestedUrl),a=o;if(a.pageType=e,a.pageId=t,r&&(a[sd]=r),e===kd){const e=bb(n),t=yI(e,bh),r=yI(e,Qp);a[sd]=`${r}_${t}`,uL(e)&&(a[Vc]=ap)}else e===pc?a[sd]=`${e}_${t}`:e===pp&&(a[sd]="Apps");const c=new xS($I(a));c.timingMetrics=i,c.pageUrl=s;const l=Gh(n,"X-AppStore-iAdClickToken");if(l){const e=JSON.parse(l),n=Gh(e,Ld)===Aa?$u:Ql;c.iAdInfo=new DS(n,Gh(e,Xu)),c.iAdInfo.applyClickFieldsFromPageRequest(t,e)}return c.recoMetricsData=Cb(n),c}function cP(e,t,n,r){const o=new xS({pageType:e,pageId:t,page:`${e}_${t}`,pageDetails:n});if(r){const e=Gh(r,Ld)===Aa?$u:Ql;o.iAdInfo=new DS(e,Gh(r,Xu)),o.iAdInfo.applyClickFieldsFromPageRequest(t,r)}return o}function lP(e,t,n){Lh(t)||(e.pageMetrics.pageFields=RA(t),e.pageMetrics.addManyInstructions(function(e,t){var n,r;const o=TP(e,t);e.searchTermContext&&(o[ef]=e.searchTermContext.term);const i=wA(o);e.iAdInfo&&Object.assign(i,e.iAdInfo.impressionsFields);e.guidedSearch&&Object.assign(i,e.guidedSearch);const s=null!==(r=null===(n=e.iAdInfo)||void 0===n?void 0:n.iAdIsPresent)&&void 0!==r&&r,a=EA(i,s),c=[new bg(a,["appExit","pageExit"])];if(s){const e=function(e){const t=EA(e,!0).fields;return t[ha]=cr,bA(new Ag(t,["fastImpressions",td,gu,nd],[],_A(t),CA(t)))}(i);c.push(new bg(e,["appExit","pageExit","timer"]))}return c}(t,n)),e.pageMetrics.addData(function(e,t){var n,r;const o=TP(e,t);e.iAdInfo&&Object.assign(o,e.iAdInfo.pageFields);Nh(e.offerReleaseDate)&&(o[Ta]=FS(e.offerReleaseDate));const i=e.searchTermContext;i&&(o[ef]=i.term,i.suggestedTerm&&(o.searchSuggestedTerm=i.suggestedTerm),i.correctedTerm&&(o.searchCorrectedTerm=i.correctedTerm),i.originatingTerm&&(o[wa]=i.originatingTerm));e.guidedSearch&&Object.assign(o,e.guidedSearch);const s=function(e,t,n){const r={};Object.assign(r,n),r[Dp]=hh,t&&(r[ar]=t.clientCorrelationKey,r.requestStartTime=t.requestStartTime,r.responseStartTime=t.responseStartTime,r.responseEndTime=t.responseEndTime);const o=[td,gu];return e&&o.push(ts),bA(new Ag(r,o,[],_A(r),CA(r)))}(!1,e.timingMetrics,o);null!==(r=null===(n=e.iAdInfo)||void 0===n?void 0:n.iAdIsPresent)&&void 0!==r&&r&&s.includingFields.push(nd);return s}(t,n),["pageEnter"]),e.pageMetrics.pageRenderFields=yP(t,n),e.pageRenderMetrics=yP(t,n),e instanceof _b||e.pageMetrics.addData(gP(t,n),["backButton"]))}function uP(e,t){return new xS({pageId:e||"",pageType:t})}function dP(e){return new xS({pageType:"Room",pageId:e,page:"Room_"+e})}function pP(e,t){const n=new xS({pageId:Zu,pageType:pp});return n.pageUrl=t,n}function fP(e,t,n,r,o,i,s){const a=Gh(t,["meta",rd,Dn]),c=aP(pp,a,t);return c.searchTermContext=n,c.searchTerm=n.term,c.pageUrl=r,s&&(c.guidedSearch=function(e,t){const n={};if(Mh(e.guidedSearchTokens)&&(n.searchSelectedGuidedFacets=e.guidedSearchTokens),t&&t.finalTerm&&(n.searchGuidedFinalQuery=t.finalTerm),!Fh(n))return n}(e,s)),eP()&&null!=o&&(c.iAdInfo=new DS(Ql,o.iAdId,o.appStoreClientRequestId,i)),c}function hP(e,t,n,r){const o=aP(pp,r,e);return o.searchTermContext=t,o.searchTerm=t.term,o.pageUrl=n,o}function mP(e){if(Lh(e)||Lh(e.pageMetrics))return;const t=e.pageMetrics.instructions;if(!Lh(t))for(const e of t)e.data.fields[Dp]===hh&&e.data.includingFields.push(ts);if(e instanceof iP){const t=[];if(e.buttonAction instanceof $g)t.push(e.buttonAction);else if(e.buttonAction instanceof Wg&&e.buttonAction.buyAction instanceof $g)t.push(e.buttonAction.buyAction);else if(e.buttonAction instanceof zg&&e.buttonAction.completionAction instanceof $g)t.push(e.buttonAction.completionAction);else if(e.buttonAction instanceof Yg){if(e.buttonAction.buyAction instanceof $g&&t.push(e.buttonAction.buyAction),e.buttonAction.defaultAction instanceof $g&&t.push(e.buttonAction.defaultAction),e.buttonAction.openAction instanceof $g&&t.push(e.buttonAction.openAction),e.buttonAction.subscribePageAction instanceof Bg&&e.buttonAction.subscribePageAction.page===ml&&Mh(e.buttonAction.subscribePageAction.pageUrl)){const t=uI.from(e.buttonAction.subscribePageAction.pageUrl);t.param(Bw,Fp),e.buttonAction.subscribePageAction.pageUrl=t.build()}e.buttonAction.subscribePageAction instanceof Bg&&e.buttonAction.subscribePageAction.pageData instanceof Og&&e.buttonAction.subscribePageAction.pageData.postSubscribeAction instanceof $g&&t.push(e.buttonAction.subscribePageAction.pageData.postSubscribeAction),e.buttonAction.subscribePageAction instanceof Bg&&e.buttonAction.subscribePageAction.pageData instanceof Lg&&e.buttonAction.subscribePageAction.pageData.purchaseSuccessAction instanceof $g&&t.push(e.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const e of t)e.purchaseConfiguration&&(e.purchaseConfiguration.excludeAttribution=!1)}}function gP(e,t){return function(e){const t={};return Object.assign(t,e),t[mu]="back",PA("back",wh,t)}(TP(e,t))}function yP(e,t){const n=TP(e,t);return e.searchTermContext&&(n[ef]=e.searchTermContext.term),e.baseFields&&Object.assign(n,e.baseFields),function(e,t){const n={};return Object.assign(n,t),n[Dp]="pageRender",e&&(n[dl]||(n[dl]=e.pageURL),n[ar]=e.clientCorrelationKey,n.platformRequestStartTime=e.requestStartTime,n.platformResponseStartTime=e.responseStartTime,n.platformResponseEndTime=e.responseEndTime,n.platformResponseWasCached=e.responseWasCached,n.platformJsonParseStartTime=e.parseStartTime,n.platformJsonParseEndTime=e.parseEndTime),n}(e.timingMetrics,n)}function TP(e,t){const n={};return Nh(e.offerType)&&(n[fl]=e.offerType),n&&t&&t(n),n}class wP extends Zh{constructor(e){super(),this.shelves=e,this.title=null,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new Cg}}class IP extends Zh{constructor(){super(),this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class AP extends wP{}class SP extends wP{}class bP extends wP{constructor(e,t=null){super(e),this.sort=Ap,this.displayStyles=t}}function PP(e){switch(yI(e,"editorialContext")){case"Watch":return"com.apple.AppStore.BridgeStoreExtension";case Xo:return"com.apple.MobileSMS";default:return null}}class kP{constructor(){this.profile=Yp,this.maxPerPage=20}}class EP extends yb{defaultAttributes(){const e=[lh,sh,Cf,xf];return by&&e.push(Jf),e}defaultPlatforms(){return Ey()}pageType(){return hh}generatePaginationRequest(e,t,n){return new Ry(n.remainingContent)}renderPaginatedPage(e,t){const n=t;return this.pageWithContent(e,n)}handlePaginationError(e,t,n,r,o){t(this.renderPaginatedPage({data:[]},o))}pageWithContent(e,t){return Oh.context("pageWithContent",()=>{const n=t.preferredShelfContentType||"mediumLockup",r=new bS(n),o={id:null,kind:null,softwareType:null,targetType:ah,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,recoMetricsData:Cb(e)};mA(r,o),JI(o,t.title),r.isHorizontal=!1,r.shouldFilterApps=t.shouldFilter;const i=Pb(e);t.remainingContent=[],r.items=Ax(i,{contentUnavailable:(e,n)=>(t.remainingContent=Ab(i,n),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:Ox(n)}});const s=new wP([r]);return t.remainingContent.length&&(s.nextPage=t),s})}}class CP extends EP{constructor(){super("RoomBuilder")}generatePageRequest(e,t){let n=e.query[JT];if(this.isValidRoomId(n)||(n=t.id),!this.isValidRoomId(n))throw new Error(`Unable to map ${e.build()} to a media api url`);return(new Ry).forType(Vl).includingMacOSCompatibleIOSAppsWhenSupported(!0).withIds([n])}prepareRequest(e,t,n){super.prepareRequest(e,t,n),e.includingMacOSCompatibleIOSAppsWhenSupported(!0)}renderPage(e,t,n){return Oh.context(Kp,()=>{const t=bb(e),n=CI(t,fh),r=aP(Gd,t.id,e),o=new kP;o.remainingContent=n.data,o.url=this.paginationUrl,o.shouldFilter=!wI(t,yi),o.metricsPageInformation=r,o.metricsLocationTracker={rootPosition:0,locationStack:[]};const i=yI(t,yd);o.preferredShelfContentType=this.preferredShelfStyleForFcKind(Number(i)),o.clientIdentifierOverride=PP(t),o.title=yI(t,fd);const s=this.pageWithContent(n,o);return s.title=o.title,CP.platformPrefersLargeTitles()&&(s.presentationOptions=[Vd]),lP(s,r),s})}get pageRoute(){return[{protocol:Gy.https,path:`/${Hy}/${oT}`,query:[JT]},{protocol:Gy.https,path:`/${$y}/${rT}`},{protocol:Gy.https,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:Gy.https,path:"/{countryCode}/collection/today-view-widgets",query:[JT]},{protocol:Gy.https,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return Uh(e)}preferredShelfStyleForFcKind(e){if(null==e)return null;switch(e){case 431:return Pi;default:return null}}static seeAllPage(e,t){const n=new bS(t||"mediumLockup");n.isHorizontal=!1,n.items="parentShelfItems";const r=new wP([n]);return r.isIncomplete=!0,r.title=e,CP.platformPrefersLargeTitles()&&(r.presentationOptions=[Vd]),r}static platformPrefersLargeTitles(){return Dm===Eh||Dm===Ch}}class _P extends EP{requestWithFilter(e,t){return(new Ry).forType(Ah).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(e,t)}renderPage(e,t,n){return Oh.context(Kp,()=>{const n=new kP;n.url=this.paginationUrl,n.metricsPageInformation=this.pageInformation(e,t),n.shouldFilter=!1,n.metricsLocationTracker={rootPosition:0,locationStack:[]};const r=this.pageWithContent(e,n);return lP(r,n.metricsPageInformation),r})}}class RP extends EP{handlePage(e,t,n,r,o){r(this.action())}generatePageRequest(e,t){throw new Error("generatePageRequest is not supported on: "+this.builderClass)}renderPage(e,t,n){throw new Error("renderPage is not supported on: "+this.builderClass)}}class OP{constructor(e){this._count=e,this._triggers=[]}countDown(){if(0!==this._count&&(this._count--,0===this._count)){for(const e of this._triggers)e();this._triggers.splice(0)}}then(e){0===this._count?e():this._triggers.push(e)}}const vP=[Gy.https,Gy.itmsApps,Gy.itmsAppss,Gy.itmsMessages,Gy.itmsMessagess,Gy.itmsWatch,Gy.itmsWatchs,Gy.macappstore,Gy.macappstores,Gy.tvappstoreLegacy,Gy.tvappstore,Gy.arcade];function DP(e){return-1!==vP.indexOf(e.protocol)}function xP(e){const t=e.indexOf("{"),n=e.indexOf("}");return t>=0&&n>t+1}function LP(e){const t=e.indexOf("{"),n=e.indexOf("}");return t>=0&&n>t?e.substring(t+1,n):e}function FP(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1));return n>=0&&r>n?e.substring(n,r):e}class NP{constructor(e){var t;this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={};return e.forEach((e,n)=>{xP(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[];if(!e)return t;for(const n of e){const e=n.split("=");let r=e[0];const o=-1!==r.indexOf("?");r=r.replace("?","");let i=null;e.length>1&&(i=decodeURIComponent(e[1])),t.push({key:r,value:i,optional:o})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map((function(e){return new NP(e)})):this._exclusions=null}matches(e){if(this._regex){if(!this._regex.length)return!1;let t=!1;for(const n of this._regex)if(n.test(e.toString())){t=!0;break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1;if(this._hostName&&e.host!==this._hostName)return!1;if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents();if(t.length!==n.length)return!1;const r=t.length;for(let e=0;e<r;e++){const r=t[e];if(xP(r))continue;if(r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1;if(this._query)for(const t of this._query){const n=e.query[t.key];if(!n&&!t.optional)return!1;if(t.value&&t.value!==n)return!1}if(this._hash&&e.hash!==this._hash)return!1;if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?");if(t.matches(e))return!1}return!0}extractParameters(e){const t={};if(this._pathComponents){const n=e.pathComponents();for(const e of Object.keys(this._pathParameterMap)){const r=LP(e),o=FP(n[this._pathParameterMap[e]],e);t[r]=decodeURIComponent(o)}}if(this._query)for(const n of this._query)t[n.key]=e.query[n.key];return t}}class MP{constructor(){this._routeMappings=[]}associate(e,t){const n=[];for(const t of e)n.push(new NP(t));this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===Ih?new uI(e):e;t=function(e){let t=typeof e===Ih?new uI(e):e;if(!DP(t))return t;const n=t.query,r=n.url;return(!t.host||0===t.host.length)&&null!=r&&(t=new uI(r),n.dsid&&(t=t.append(dp,{dsid:n.dsid})),n[nr]&&(t=t.append(dp,{signatureResumption:n[nr]}))),uI.fromComponents(Gy.https,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){const t=typeof e===Ih?new uI(e):e;if(!DP(t))return t;const n=t.build();let r,o=wA(t.query);const i={},s=[{key:"MZSearch.woa",action:Vf},{key:Vf,action:Vf},{key:"buyLandingPage",action:ic},{key:"buyCharityGiftWizard",action:"donate"},{key:"longUrlHandler",action:rr},{key:cl,action:cl}],a={"accessory-lookup":"accessoryLookup","finance-app":Gf,viewEula:md,software:Ah};let c=!1;for(const e of Object.keys(i))if(t.host&&-1!==t.host.indexOf(e)){c=!0,r=i[e];break}let l=!1;for(const e of s){const n=e.key;if(t.pathname&&-1!==t.pathComponents().indexOf(n)){l=!0,r=e.action,void 0!==o[n]&&delete o[n];break}}for(const e of Object.keys(a)){const n=void 0!==t.query[e]&&null!==t.query[e],i=t.query[hf]&&-1!==t.query[hf].indexOf(e);if(n||i){r=a[e],void 0!==o[e]&&delete o[e];break}}if(r===Gf&&-1!==n.indexOf("getPass")&&(r="addToPassbook",delete o.getPass),r){const e=null,n=null,i={action:r};return r===Ii&&(o[Zd]||o.certId)?i[Zd]=o[Zd]||o.certId:r!==Gf&&r!==cl&&r!==rr||!l&&!c||(i[Ua]=t.toString()),o={...o,...i},uI.fromComponents(t.protocol,n,e,o,t.hash)}return t}(t);for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier};return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}class UP extends Zh{constructor(e,t){super(),this.title=e,this.sections=t||[],this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class BP extends Zh{constructor(e,t){super(),this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class qP extends Zh{constructor(e){super(),this.type=e}}class GP extends qP{constructor(e,t,n){super(Wf),this.title=e,this.action=t,this.displayType=n||hf}}class VP extends qP{constructor(e,t){super("infoListItem"),this.title=e,this.value=t}}class HP extends qP{constructor(e){super(up),this.text=e}}const $P="https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink";function WP(e,t,n){const r=new Bg(e,t);return n&&(r.presentationContext="push"),r}function zP(e){const t=[],n=new BP,r={};r[sg(Qo)]=new Bg(Nf,Gf);const o=new hm(sg("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",sg(Qo)));n.footer=new iS(o,r);const i=new mm(sg("PERSONALIZATION_DESCRIPTION_OPTED_IN"));n.addContentItem(new HP(i)),t.push(n);const s=new BP(sg("PERSONALIZATION_INTERACTIONS")),a=new hm(sg("PERSONALIZATION_INTERACTIONS_FOOTER"));s.footer=new iS(a),s.addContentItem(new GP(sg("PERSONALIZATION_PURCHASES"),WP(y,null,!0),yl)),s.addContentItem(new GP(sg("PERSONALIZATION_SUBSCRIPTIONS"),WP(Nf,$P,!1),yl)),s.addContentItem(new GP(sg("PERSONALIZATION_PREORDERS"),WP(Nf,"https://finance-app.itunes.apple.com/preorders",!0),yl)),s.addContentItem(new GP(sg("PERSONALIZATION_RATINGS"),WP(Nf,"https://itunes.apple.com/WebObjects/MZStore.woa/wa/genericPageTemplate?pageComponent=finance_internet_eraser_page&additionalResources=p7financebootstrap",!0),yl)),t.push(s);const c=new BP(sg("PERSONALIZATION_ADDITIONAL_INFO")),l=[sg("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),sg("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),sg("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),sg("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),sg("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),u=new mm(l);c.addContentItem(new HP(u)),t.push(c);const d=xh(e,"results.derived-user-info");if(Mh(d)){const e=new BP(sg("ACCOUNT_INFO")),n=["gender","birthyear"];for(const t of n){const n=Gh(d,t+".label"),r=Gh(d,t+".value");Mh(n)&&Mh(r)&&e.addContentItem(new VP(n,r))}const r=new hm(sg("PERSONALIZATION_ACCOUNT_INFO_FOOTER"));e.footer=new iS(r),t.push(e)}return new UP(sg(T),t)}let jP;jP=ask.arcade;function YP(e){return jP.getMarketingItemFromMarketingItems&&Mh(e)?jP.getMarketingItemFromMarketingItems(e):null}function KP(e=Ap,t,n){const r=uI.fromComponents(Gy.internal,null,"/"+Zy,{sort:e}),o=new Bg(Sp,r.build());o.title=sg(nt);return BS(o,{id:rt,targetType:wh,actionType:_f,actionContext:ap,pageInformation:t,locationTracker:n}),o}function QP(e,t,n,r){let o;if(Kh(Dl)){let r;r=Kh(_e)||e!==ql&&e!==zd?e:Mp;const i=new Lg(Th,r,t);i.purchaseSuccessAction=n,i.carrierLinkSuccessAction=n,o=new Bg(hp),o.pageData=i}else{const n=new uI(`${Gy.internal}://${GT}`).param(dw,e);Nh(t)&&n.param(Lw,t),o=new Bg(ml,n.build())}return Nh(r)&&US(o,r),o}function JP(e,t){if("tv"===Dm)return XP();{const n=new qg(Th);return host.platform!==Ef||Kh("tabChangeWillDismissesModal")?new Hg([n]):KP(Ap,e,t)}}function XP(){return new Vg("com.apple.Arcade://")}function ZP(e=!1){const t=(new Ry).forType(Up);return e?t.addingQuery(Ec,ot):t}function ek(e){return ZP().withSparseLimit(e).asPartialResponseLimitedToFields([uh])}function tk(e,t){return function(e,t){Fh(e)&&(e=Mp);const n=(new Ry).forType(hp).addingQuery("serviceType",Th).addingQuery("placement",e).includingMetaKeys(gf,[rd]).includingRelationships([fh]).includingAttributes([E,C]);Nh(t)&&n.addingQuery("seed",t);return n}(e,t)}function nk(e=null,t=!1,n=null){return new Promise((r,o)=>{if(!Kh("recentlyPlayedGames"))return void r(null);let i;i=Kh("getRecentlyPlayedGamesWithTimeout")?(e=>jP.getRecentlyPlayedGamesWithTimeout(e))(n):jP.getRecentlyPlayedGames(),i.then(n=>{if(Lh(n)||0===n.length)r(null);else if(Uh(e)&&n.length>e&&(n=n.slice(0,e)),t){jS((new Ry).forType(Ah).withIds(n).includingAttributes([lh,sh,Sf,Xf])).then(e=>r(e))}else{const e={data:[]};n.forEach(t=>{e.data.push({id:t,type:Ah})}),r(e)}}).catch(e=>{console.log("getRecentlyPlayedGames() failed with: "+e),r(null)})})}function rk(e){let t=null;const n=CI(e,"upsell")||CI(e,gf);if(Fh(n)||Fh(n.data))return null;for(const e of n.data)switch(e.type){case gf:t=YP([e]);continue}return Lh(t)?null:{marketingItemData:t}}function ok(e){if(!e)return null;let t=null;const n=Bh(e,ji);return n.length>0&&(t=n[0]),Nh(t)?{marketingItemData:t}:null}function ik(e=!1,t=!1,n=0,o=r){return sk(function(e,t){let n;switch(host.clientIdentifier){case Na:case gl:n=!1;break;default:n=t.supportsHEIF}const r=n?"heic":"jpeg",o=n?"heic":"png";return e?o:r}(e,o),t,n,o)}function sk(e,t=!1,n=0,o=r){const i=function(e,t,n){switch(e){case"heic":return"tv"===n.deviceType&&20===t?70:60;default:return 70}}(e,n,o);return new om(e,i,t)}function ak(e,t=0,n=0,o=null,i=null,s=r){const a=new im(e,t,n,[ik(!1,!1,0,s)]);return a.backgroundColor=o,a.checksum=i,a}class ck extends Zh{constructor(e,t,n){super(),this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class lk extends em{constructor(e){super(),this.kind=e}}class uk extends lk{constructor(){super(oc),this.allowsAutoPlay=!0,this.looping=!0}isValid(){const e=this.art&&this.art.isValid(),t=this.video&&this.video.isValid();return(e||t)&&super.isValid()}}class dk extends lk{constructor(e,t){super(uh),this.art=e,this.titleBackingGradient=t}}class pk extends lk{constructor(e){super(zu),this.icon=e}}class fk extends lk{constructor(e,t,n){super(Zp),this.icon=e,this.art=t,this.titleBackingGradient=n}}fk.noArtBackgroundColor=xy("BBBBBB");class hk extends lk{constructor(e,t){super("list"),this.lockups=e,this.marketingText=t}}class mk extends lk{constructor(e,t){super(pu),this.lockups=e,this.additionalText=t}}class gk extends lk{constructor(e){super(Kd),this.lockup=e}}class yk extends lk{constructor(e){super("river"),this.lockups=e,this.lockupImpressionLimit=10}}class Tk extends lk{constructor(e,t){super(Ed),this.lockups=e,this.artworkGridType=t,this.lockupImpressionLimit=3}}class wk extends lk{constructor(e,t){super(lf),this.allowsAutoPlay=!0,this.looping=!0,this.video=e,this.description=t}}class Ik extends Zh{constructor(e){super(),this.kind=e}}class Ak extends Ik{constructor(e){super(Yp),this.lockup=e,this.displaysIcon=!0}}class Sk extends Ik{constructor(e,t,n,r){super("marketingLockup"),this.marketingText=null,this.lockup=e,this.paragraph=t,this.hideBackground=n,this.artworkBackgroundColor=r}}class bk extends Ik{constructor(e){super(Wn),this.lockups=e}}class Pk extends Ik{constructor(e,t){super(tf),this.paragraph=e,this.style=t}}class kk extends Ik{constructor(e){super(hf),this.action=e}}class Ek extends Ik{constructor(e,t,n){super("threeLine"),this.heading=e,this.title=t,this.description=n}}class Ck extends Ik{constructor(e){super("arcadeLockup"),this.arcadeLockup=e}}class _k extends em{constructor(){super(),this.heading=null,this.title=null,this.media=null,this.heroMedia=null,this.overlay=null,this.style=null,this.clickAction=null,this.backgroundColor=null,this.inlineDescription=null,this.collapsedHeading=null}}class Rk extends em{constructor(e){super(),this.cards=e}}class Ok extends Zh{constructor(e,t,n,r){super(),this.shelves=e,this.title=n,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new Cg,this.pageRenderMetrics={}}}function vk(e,t=null){switch(e){case Ch:return function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER";e&&(t+="&installMajorOSBundle="+e);return t}(t);default:return null}}function Dk(e){return Nh(e)?yI(e,"customUrl"):null}function xk(e,t,n,r){if(!Mh(n)&&Dm!==Ch)return e;const o=new Yg(t,e),i=new Vg(n);return BS(i,{actionType:za,actionDetails:{actionUrl:n},id:t,pageInformation:r.pageInformation,locationTracker:r.locationTracker}),o.openAction=i,o}function Lk(e){const t=lA(e,"usesExternalPurchase"),n=lA(e,"usesExternalLinkPurchase");return t||n}function Fk(e){return(Dm===Ph||Dm===kh)&&Xh.enableExternalPurchases&&Xh.enabledExternalPurchasesPlacements.includes(e)}function Nk(e,t,n){const r=Xh.externalPurchasesLearnMoreEditorialItemId;if(Fh(r)||!Xh.enableExternalPurchases)return null;const o=new Bg(jf);return o.title=e,o.pageUrl="https://apps.apple.com/story/id"+r,BS(o,{id:"LearnMore",targetType:Wf,actionType:_f,pageInformation:t,locationTracker:n}),o}function Mk(e,t,n,r,o,i){return Oh.context("purchaseConfigurationFromProduct",()=>{const s=yI(e,bh);let a=yI(e,Qp);a||(a="test");const c=OS.bundleIdFromData(e),l=$x(e),u=yI(e,Pe),d=cA(e,"preflightPackageUrl"),p=uL(e),f=Wx(e,by),h=new tm(t,a,s,c,l,n,r,i,u,!1,d,p,f);return h.pageInformation=o,h})}function Uk(e){return Oh.context("offerDataFromData",()=>{const t=aA(e,Ml);return 0===t.length?null:t[0]})}function Bk(e){const t=gI(e,Ml);return 0===t.length?null:t[0]}function qk(e,t,n,r,o,i=nh){return Oh.context("media_offerActionFromOfferData: "+t.id,()=>{let s=Gh(e,Ul);if(Lh(s))return Oh.unexpectedNull(Uf,Ih,xi),null;t.type===gh&&(s.indexOf("rebuy")>=0?s=s.replace("rebuy=false",ke):(s.length>0&&(s+="&"),s+=ke));const a=t.id;if(Lh(a))return Oh.unexpectedNull(Uf,Ih,"item.offer.id"),null;const c=Mk(t,s,n,o.excludeAttribution,o.pageInformation,r),l=$k(e,a,c,i);return function(e,t,n){var r;const o=t.pageInformation,i=KI(t,e.title);let s=e.adamId;Mh(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(s=t.anonymizationOptions.anonymizationString),MS(e,s,n,o,i,t.isAdvert)}(l,o,n),l})}function Gk(e){return Lh(e)||Lh(e.price)||0===e.price}function Vk(e){return Oh.context("expectedReleaseDateFromData",()=>LS(yI(e,"offers.0.expectedReleaseDate")))}function Hk(e){const t=Gh(e,Bp);return"buy"===t||t===La||t===Ip?Vh(e,Td):null}function $k(e,t,n,r=nh){return Oh.context("offerActionFromOfferData",()=>{const o=Gh(e,Bp);let i;switch(o){case"get":i=r===wf?sg(Ee,"Get"):sg(Fa,Fd);break;case Ip:i=r===wf?sg(Ce,"Pre-Order"):sg(Fa,Fd);break;default:i=o}let s=null,a=null;const c=Hk(e);c>0&&(s=c,a=Gh(e,Nl));const l=LS(Gh(e,Bl)),u=new $g(i,t,n);return u.price=s,u.priceFormatted=a,u.expectedReleaseDate=l,u})}function Wk(e,t,n,r,o=nh,i=!1,s=null,a=!1){if(fL(t)){if(o===wf)return null;if(o===nh)return Sx(t,r,null,i);const n=cA(t,bf);if(Mh(n)){const t=vk(Ch,n),r=new Vg(t);return new Yg(e.adamId,r)}}if(o===nh){if(t.type===gh||hL(t)||a)return Sx(t,r,null,i);if(n&&"tv"!==Dm&&!uL(t))return function(e,t,n,r=!1){if(Lh(e))return null;const o=Sx(t,n,null,r);if(!o)return e;const i=new Yg(e.adamId,o);return i.buyAction=e,i}(e,t,r)}if(LI(t,lp)&&"tv"!==Dm){return function(e,t){const n=new ny(nh);n.title=sg("BUY_TV_ONLY_ALERT_TITLE"),n.message=sg("BUY_TV_ONLY_ALERT_MESSAGE"),n.isCancelable=!0,n.buttonActions=t?[Yk(e)]:[e];n.buttonTitles=[sg("BUY_TV_ONLY_ALERT_BUTTON_TITLE")];const r=new Yg(e.adamId,n);return r.title=e.title,r}(e,uA(t,yc))}if(!uA(t,fi)&&uA(t,cp)&&Dm!==Eh)return function(e){const t=new ny(nh);t.title=sg("BUY_WATCH_ONLY_ALERT_TITLE"),t.message=sg("BUY_WATCH_ONLY_ALERT_MESSAGE"),t.isCancelable=!0,t.buttonActions=[e],t.buttonTitles=[sg("BUY_WATCH_ONLY_ALERT_BUTTON_TITLE")];const n=new Yg(e.adamId,t);return n.title=e.title,n}(e);const c=cA(t,Ol);if(Mh(s)&&s===Em&&vL(c))return function(e,t){const n=new ny(nh);n.title=sg("AppStore.ProductPage.WatchOSUpdateRequired.Title").replace(jd,t),n.message=sg("AppStore.ProductPage.WatchOSUpdateRequired.Message").replace(jd,t),n.buttonActions=[e],n.buttonTitles=[sg(Wo)];const r=new Yg(e.adamId,e);return r.buyAction=n,r}(e,c);const l=uL(t);if(l||"tv"===Dm){const i=function(e,t,n,r){if(Lh(e))return{startAction:null,underlyingOfferAction:null};if("tv"!==Dm)return{startAction:e,underlyingOfferAction:null};const o=new zg,i=Gk(e),s=e.purchaseConfiguration.appName;if(o.shouldCheckForAvailableDiskSpace=!n,Kh(De)){const e=cA(t,Fu);if(host.isOSAtLeast(14,5,0))o.remoteControllerRequirement=e;else switch(e){case Li:case Fi:o.remoteControllerRequirement=e;break;case Ni:case wd:case Mi:default:o.remoteControllerRequirement=wd}o.shouldCheckForGameController=!1}else o.remoteControllerRequirement=wd,o.shouldCheckForGameController=uA(t,yc);o.shouldPromptForConfirmation=!0;const a=II(t,xe);Nh(a)&&(o.checkRestrictionsForContentRating=a);if(i){const e=sg(n?"TV_OFFER_ALERT_TITLE_PREORDER_FREE":"TV_OFFER_ALERT_TITLE_FREE");o.title=e.replace(Md,s)}else{const t=sg(n?"TV_OFFER_ALERT_TITLE_PREORDER_PAID":"TV_OFFER_ALERT_TITLE_PAID");o.title=t.replace(Md,s).replace(Nu,e.priceFormatted)}const c=wA(e);c.title=sg(n?Le:i?Fa:"OFFER_BUTTON_TITLE_BUY");o.completionAction=c,o.shouldIncludeActiveAccountInFooterMessage=!0;const l=[];n&&(Kh("preorderTerms")?l.push(sg(i?"PREORDER_TERMS_FREE":"PREORDER_TERMS_PAID")):l.push(sg("TV_PREORDER_TERMS")));uA(t,Ui)&&l.push(sg("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases"));l.length>0&&(o.footerMessage=l.join(sg(Oe)));o.impressionMetrics=c.impressionMetrics;const u=wA(r);Lh(u)||(u.actionType=Ic,u.targetType=wh,BS(o,r));const d=wA(o);d.shouldPromptForConfirmation=!1,d.title=null,d.footerMessage=null;const p=new Yg(e.adamId,d);uL(t)||(p.buyAction=o);return p.openAction=e,{startAction:p,underlyingOfferAction:c}}(e,t,n,r),s=n&&l;return function(e,t,n,r,o,i,s){if(!uL(n))return e;let a=null;if(Kh(Dl)){const t=Rg(i),r=Kh(_e),o=new Lg(Th,!r&&t?Mp:i,n.id);t&&r&&(o.purchaseSuccessAction=e,o.carrierLinkSuccessAction=e);const s=new Bg(hp);s.pageData=o,a=s}else{const e=new uI(`${Gy.internal}://${GT}`).param(Lw,n.id).param(dw,i);a=new Bg(ml,e.build());const t=new Og(null,null,null,null);t.primaryIcon=Dx(n,s,{useCase:3});const c=NS(n,s);t.postSubscribeAction=zk(n,o,i,r,c),a.pageData=t}s&&s.pageInformation&&(a.referrerUrl=s.pageInformation.pageUrl);e instanceof $g&&(s.actionDetails={buyParams:e.purchaseConfiguration.buyParams,...s.actionDetails});if(US(a,s),r&&e instanceof $g&&"tv"!==Dm){let t=new ly;o===nh&&(t=Sx(n,s,null,!1));const r=new Yg(n.id,t);return r.buyAction=e,r.subscribePageAction=e,e.buyCompletedAction=function(e){if("tv"===Dm)return null;const t=ak("systemimage://bell",95,90),n=new ny(vl);n.title="",n.artwork=t,jm()?(n.message=sg(Re),n.toastDuration=2.5):(n.message=sg(wc),n.toastDuration=1.5);const r=new ny(vl);r.title="",r.artwork=t,r.message=sg(wc),r.toastDuration=1.5;const o=new py(ve,new Hg([e,r]));return o.rateLimit=Xh.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=r,new fy(o,n,n,n)}(a),r}if(r&&null!==t&&"tv"===Dm){const r=new Yg(n.id,new ly);return r.buyAction=e,r.subscribePageAction=e,t.buyCompletedAction=function(e){if("tv"!==Dm)return null;const t=new zg;jm()?t.title=sg(Re):t.title=sg(wc);const n=new zg;n.title=sg(wc);for(const e of[t,n]){e.isCancelable=!1,e.shouldCheckForAvailableDiskSpace=!1,e.remoteControllerRequirement=null,e.shouldCheckForGameController=!1,e.shouldPromptForConfirmation=!0,e.shouldIncludeActiveAccountInFooterMessage=!0,e.completionAction=new ly,e.completionAction.title=sg(Wo);const t=[sg("TV_ARCADE_PREORDER_TERMS")];e.footerMessage=t.join(sg(Oe))}const r=new py(ve,new Hg([e,n]));return r.rateLimit=Xh.arcadePreOrderUpsellLimitSeconds,r.fallbackAction=n,new fy(r,t,t,t)}(a),r}const c=new Yg(n.id,e);return c.subscribePageAction=a,c}(i.startAction,i.underlyingOfferAction,t,n,o,function(e,t){if(t)return Tc;switch(e){case $f:return zd;case nh:case wf:return ql;default:return Mp}}(o,s),r)}return jk(e,n,r)}function zk(e,t,n,r,o){switch(n){case zd:case ql:const n=Lx(e,{useCase:3}),i=NS(e,o);return qk(Uk(e),e,r,zI(e,n),i,t);default:return null}}function jk(e,t,n){if(Lh(e))return null;if(Um||t)return e;const r=new ly;r.impressionMetrics=e.impressionMetrics;const o=wA(n);Lh(o)||(o.actionType=Ic,o.targetType=wh,BS(r,o));const i=new Wg(e,r);return i.confirmationAccessibilityAction=function(e){if(Lh(e))return null;const t=new ny(nh);Lh(e.priceFormatted)?(t.title=sg(Fd),t.message="Are you sure you want to get "+e.purchaseConfiguration.appName):(t.title="Buy App",t.message=`Are you sure you want to buy ${e.purchaseConfiguration.appName} for ${e.priceFormatted}`);t.isCancelable=!0,t.buttonActions=[e];const n=new Yg(e.adamId,e);return n.buyAction=t,n}(e),i}function Yk(e){const t=new ny(nh);return t.title=sg("BUY_TV_GAME_CONTROLLER_REQUIRED_ALERT_TITLE"),t.message=sg("BUY_TV_GAME_CONTROLLER_REQUIRED_ALERT_MESSAGE"),t.buttonTitles=[sg("BUY_TV_GAME_CONTROLLER_REQUIRED_ALERT_BUTTON_TITLE")],t.isCancelable=!0,t.buttonActions=[e],t}function Kk(e,t,n,r,o,i,s,a,c=nh,l=!1){return Lh(e)?null:Oh.context("displayPropertiesFromOfferAction",()=>{let u=o;vS(n,56758)&&(u=Su);Cx(n)||(u=Su);const d=_x(n);let p=null;d&&(p=d.id);let f=new nm(t,e.adamId,u,p,i);f.isPreorder=r,r&&(uL(n)?(f.offerLabelStyle=Tc,f.subtitles[Bl]=xL(n,sg(Ac)),f.subtitles[Bl]===sg(Bi)&&(f.subtitles[Bl]=sg(Ac))):f.offerLabelStyle=Ip);const h=Gk(e);f.isFree=h;let m=null;if(c===nh&&(n.type===gh||fL(n)||hL(n)||l))m=sg("OFFER_BUTTON_TITLE_VIEW");else{if(c===wf&&(n.type===gh||fL(n)||hL(n)))return null;m=h?!r||"tv"!==Dm||i!==$f&&i!==zd?c===wf?sg(r?Ce:Ee):e.title:sg(Le):"tv"!==Dm||i!==$f&&i!==zd?c===wf?r?sg("FLOW_PREVIEW_OFFER_ACTION_PREORDER_WITH_PRICE").replace(Nu,e.priceFormatted):sg("FLOW_PREVIEW_OFFER_ACTION_BUY_WITH_PRICE").replace(Nu,e.priceFormatted):e.priceFormatted:r?sg("OFFER_BUTTON_TITLE_PREORDER_WITH_PRICE").replace(Nu,e.priceFormatted):sg("OFFER_BUTTON_TITLE_BUY_WITH_PRICE").replace(Nu,e.priceFormatted)}if(f.titles[ph]=m,Um||c===wf||(f.titles[Fe]=sg(h?"ACTION_GET_CONFIRM":"ACTION_BUY_CONFIRM")),uL(n))if(c===wf)f.titles[ph]=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_STANDARD"),f.titles[za]=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_OPEN"),f.titles.trial=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_TRY"),f.titles[Ne]=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_NOT_SUBSCRIBED"),r&&(f.titles[Me]=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_PREORDER_SUBSCRIBED"),f.titles[Ue]=sg("FLOW_PREVIEW_OFFER_ACTION_ARCADE_PREORDER_NOT_SUBSCRIBED"));else{const e=sg(Be);f.titles[ph]=e,f.titles.trial=e,f.titles[za]=sg(qe),f.titles[Ne]=e,r&&(f.titles[Me]=sg("OFFER_BUTTON_TITLE_ARCADE_PREORDER_SUBSCRIBED"),f.titles[Ue]=sg("OFFER_BUTTON_TITLE_ARCADE_PREORDER_NOT_SUBSCRIBED"),f.titles.preorderedSubscribed=sg("OFFER_BUTTON_TITLE_ARCADE_PREORDERED_SUBSCRIBED"),f.titles.preorderedNotSubscribed=sg("OFFER_BUTTON_TITLE_ARCADE_PREORDERED_NOT_SUBSCRIBED"))}if(s&&c!==wf){const e=Gh(s,"modeType"),t=Gh(s,Nl);if(Nh(t)&&Nh(e)){let n=null,r=null;switch(e){case"FreeTrial":a?(n=sg(qi),r=sg(qi)):(n=sg(qi),r=sg(Sc));break;case Ae:const e=sg("INTRO_PRICE_OFFER_PAID_UPFRONT_TRIAL").replace(Nu,t);a?(n=e,r=e):(n=e,r=sg(Sc));break;case be:n=sg(Sc),r=sg(Sc)}f.titles[Ge]=n,f.titles[Ve]=r,f.subtitles[Ge]=sg(Gi),f.subtitles[Ve]=sg(Gi);const o=10;let i=!1;for(const e of Object.keys(f.titles)){if(f.titles[e].length>o){i=!0;break}}i&&(f=f.newOfferDisplayPropertiesChangingAppearance(!1,null,"widthConstrainedLockup"))}}const g=uA(n,Ui),y=Lk(n),T=Fk(Yp),w=y&&T;if(f.hasInAppPurchases=g,f.hasExternalPurchases=w,g||w){const e=sg(w?He:$e);f.subtitles[ph]=e,Um||c===wf||(f.subtitles[Fe]=e)}f.isDeletableSystemApp=OS.isDeletableSystemAppFromData(n)&&!hL(n);const I=II(n,xe);return f.contentRating=I,n.type===gh&&c!==wf&&(f.offerToken={offerAction:e,offerDisplayProperties:wA(f)}),f})}function Qk(e,t,n){return Oh.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const r=Bh(e,Ml);if(0===r.length)return null;let o,i=null;for(const e of r)switch(o=Gh(e,Bp),o){case La:case Yo:i=e;break;default:i=null}if(!i)return null;let s=Gh(i,Ul);if(o===La&&Lh(s))return Oh.unexpectedNull(Uf,Ih,xi),null;s||(s="");const a=t.purchaseConfiguration,c=new tm(s,a.vendor,a.appName,a.bundleId,a.appPlatforms,a.isPreorder,a.excludeAttribution,a.metricsPlatformDisplayStyle);c.pageInformation=a.pageInformation;const l=$k(i,t.adamId,c);return function(e,t,n){const r=t.purchaseConfiguration.pageInformation;let o;for(const e of t.actionMetrics.data)if(o=Bh(zh(e.fields),Tu),o)break;MS(e,e.adamId,n,r,o,!1)}(l,t,n),l})}class Jk{constructor(e){this.label=e.label,this.title=e.title,this.meta=e.meta,this.date=Gh(e,_u),this.remainingContents=Bh(e,fh),this.numberOfItemsProcessed=0,this.isFullyHydrated=function(e){for(let t=e.length-1;t>=0;t--){if(!kb(e[t]))return!1}return!0}(this.remainingContents)}}function Xk(e,t){const n={internalContentType:_h,shelf:t};e.push(n)}function Zk(e,t){const n={internalContentType:"contentPool",contentPool:new Jk(t)};e.push(n)}function eE(e,t,n){if(Fh(e))return null;const r=e.shift();if(r.internalContentType===_h)return{contentType:_h,shelf:r.shelf};const o=r.contentPool,i=o.numberOfItemsProcessed,s=i>0;let a;a="greedy"===t&&o.isFullyHydrated?function(e){const t={label:e.label,title:e.title,meta:e.meta,date:e.date,contents:e.remainingContents};return e.numberOfItemsProcessed=e.remainingContents.length,e.remainingContents=[],t}(o):function(e,t){const n=e.remainingContents.length,r=e.remainingContents.slice(0,t),o=e.remainingContents.slice(t,n),i={label:e.label,title:e.title,meta:e.meta,date:e.date,contents:r};return e.numberOfItemsProcessed+=r.length,e.remainingContents=o,i}(o,n);const c=Fh(o.remainingContents);const l={todayModule:a,isContinuationModule:s,isLastOfModule:c,contentOffsetWithinSourceModule:i};return c||e.unshift(r),{contentType:fu,moduleSlice:l}}function tE(e,t,n){const r=eE(e,la,t);if(r.contentType!==fu)return Promise.reject(new Error("dequeueHydratedModuleSlice: TodayContentQueue dequeued unexpected contentType."));return nE(r.moduleSlice).then(t=>{const r=t.todayModule.contents.length;let o=Math.ceil(r/n)*n;0===o&&(o=n);const i=o-r;return!t.isLastOfModule&&i>0?function e(t,n){if(0===n)return Promise.reject(new Error("hydrateContentsUntilCountOrEndOfModule: Hydrating module slice of size 0."));const r=eE(t,la,n);if(r.contentType!==fu)return Promise.reject(new Error("hydrateContentsUntilCountOrEndOfModule: TodayContentQueue dequeued unexpected contentType."));const o=r.moduleSlice;if(o.isLastOfModule)return nE(o);const i=o.todayModule.contents.length;return nE(o).then(n=>{const r=n.todayModule.contents.length,o=i-r;return o>0?e(t,o).then(e=>rE(n,e)):n})}(e,i).then(e=>rE(t,e)):t})}function nE(e){const t=[],n=[];for(const r of e.todayModule.contents)kb(r)?t.push(r):n.push(r);if(0===n.length)return Promise.resolve(e);return jS(new Ry(n).includingAdditionalPlatforms(Ey()).includingAttributes(iE).includingRelationshipsForUpsell(!0)).then(n=>{const r=Pb(n),o=t.concat(r);return e.todayModule.contents=o,e}).catch(()=>(e.todayModule.contents=[],e))}function rE(e,t){const n=e.todayModule,r=t.todayModule;return{todayModule:{label:n.label,title:n.title,meta:n.meta,contents:n.contents.concat(r.contents)},isContinuationModule:e.isContinuationModule,isLastOfModule:t.isLastOfModule,contentOffsetWithinSourceModule:e.contentOffsetWithinSourceModule}}function oE(e,t,n){let r=!1,o=[],i=[];for(let s=e.length-1;s>=0;s--){const a=e[s];if(kb(a)){1===t[a.id]?(n&&0===o.length&&o.unshift(...i),i=[],o.unshift(a),r=!0):(i.unshift(a),t[a.id]-=1)}else i.unshift(a)}return n&&0===o.length&&(o=i),{contents:o,contentsContainsHydratedData:r}}const iE=[lh,sh,Xf];class sE{constructor(){this.locationTracker={rootPosition:0,locationStack:[]}}}class aE{constructor(e,t,n,r){this.todayModule=e,this.metricsPageInformation=n,this.contentOffsetWithinModule=t,this.metricsLocationTracker=r}}function cE(e,t){if(Lh(e))return null;!function(e){let t=!0;const n=Bh(e.results.data),r={};for(const e of n){const t=Bh(e.contents);for(const e of t)if(kb(e)){const t=r[e.id];r[e.id]=t?t+1:1}}for(let e=n.length-1;e>=0;e--){const o=n[e],i=oE(o.contents,r,t);o.contents=i.contents,t=!i.contentsContainsHydratedData}}(e);const n=new sE;n.pageInformation=aP("Today",Lp,e);const r=Pb(t),o=Mh(r),i=[];if(o){!function(e){for(const t of e)t.isOnBoardingCard=!0}(r);for(const e of r)i.push(e.id)}const s=[];let a=!1;for(const t of e.results.data){const e=LS(Gh(t,_u));if(Nh(e)){const t=new Date;if(e.getTime()>t.getTime())continue}if(o&&!a){const e=Bh(t.contents);t.contents=r.concat(e),a=!0}Zk(s,t)}const c=XC(n.pageInformation,n.locationTracker);c&&Xk(s,c);const l=Xh.termsAndConditionsURL;if(!Lh(l)){Xk(s,c_(l))}const u=[];let d=!1,p=!0;for(;!d;){const e=uE(s,n,p);if(!Nh(e))break;u.push(e),d=Nh(e.url),p=!1}const f={queue:s,metricsContext:n};let h=null;e.results.data.length>0&&(h=Gh(e.results.data[0].title));const m=lE(u,f,i,h);return lP(m,n.pageInformation),m}function lE(e,t,n=null,r){const o=sg(Kn),i=new Ok(e,n,r||o,o);return Nh(t)&&Mh(t.queue)&&(i.nextPage=t),i}function uE(e,t,n=!1){const r=eE(e,"greedy",6);if(Lh(r))return null;let o,i=null;if(r.contentType===_h&&(i=r.shelf,o=!0),r.contentType===fu){const e=r.moduleSlice,s={contentOffsetWithinModule:e.contentOffsetWithinSourceModule,hideTitle:e.isContinuationModule,setTitleToDateForTodaySection:n};i=dE(e.todayModule,s,t),o=e.isLastOfModule}return Nh(i)&&o&&tA(t.locationTracker),i}function dE(e,t,n,r=!1){const o=Cb(e),i={id:null,kind:null,softwareType:null,targetType:ah,title:e.title,pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:sp,recoMetricsData:o};n.currentShelfRecoMetricsData=o;const s=new bS(Du);s.isHorizontal=!1,mA(s,i),JI(i,e.title),function(e,t){const n=iA(e);n?n.position=t:e.rootPosition=t}(i.locationTracker,t.contentOffsetWithinModule);const a={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};a.useThreeLineOverlayForBranded=!function(e){const t=xh(e,_u);return"TodayForApps"===e.label||Nh(t)}(e)||r;const c=[],l=Bh(e.contents);let u=0;for(const e of l){if(!kb(e))break;const t=bE(e,a,n);Nh(t)&&(c.push(t),tA(n.locationTracker)),u++}const d=l.slice(u);e.contents=d,s.items=c;const p=Gh(e,_u);if(e.label===ca&&t.setTitleToDateForTodaySection){const e=new Date;s.title=hg("EEEE, MMMM d",e)}else if(Mh(p)){const e=LS(p);s.title=hg("EEEE",e),s.subtitle=hg("MMMM d",e)}else s.title=e.title;if(t.hideTitle&&(s.title=void 0),ZI(n.locationTracker),Mh(e.contents)){const r=t.contentOffsetWithinModule+u,o=new aE(e,r,n.pageInformation,n.locationTracker);s.url=Lh((f=o).todayModule)||Fh(f.todayModule.contents)?null:`${Gy.internal}:/${Jy}/${Vy}/`+encodeURIComponent(JSON.stringify(f))}var f;return s}function pE(e){const t=Fh(n=e.queue)?null:n[0].internalContentType===_h?_h:fu;var n;if(Lh(t))return Promise.reject(new Error("today.nextPageFromPageToken called on end of page"));const r=(o=xm,Dm===Ph?o.isEqualTo(SL)?6:2:1);var o;if(t===_h){const t=eE(e.queue,la,6).shelf;return tA(e.metricsContext.locationTracker),Promise.resolve(lE([t],e))}return tE(e.queue,6,r).then(t=>{const n={contentOffsetWithinModule:t.contentOffsetWithinSourceModule,hideTitle:t.isContinuationModule,setTitleToDateForTodaySection:!1},r=dE(t.todayModule,n,e.metricsContext);return t.isLastOfModule&&tA(e.metricsContext.locationTracker),lE([r],e)})}const fE=new Set([Zp,uh,zu,Ed,pu,lf]),hE=new Set([Zp,uh,zu,Ed,pu,lf]),mE=new Set([Zp,uh,zu,Ed,pu,lf]),gE=new Set([Zp,uh,Ed,lf]);function yE(e,t){switch(t){case yp:return host.platform===Yf?gE.has(e):fE.has(e);case ki:return hE.has(e);case lc:return mE.has(e);case Du:return Dm===Eh;default:return!1}}function TE(e,t,n,r,o){const i={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker};null==o&&(o={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0}),o.prevailingCropCode=function(e){switch(e){case yp:return host.platform===Yf||host.platform===id?"fo":"em";case ki:return"el";case lc:return"ek";default:return null}}(t),Dm!==Eh&&(o.coercedGeneralCardSubType=Nd);const s=[];for(const a of e){if(!Nh(a.attributes)){r&&r(a);continue}const e=bE(a,o,i,n.augmentingData);if(e){if(Dm===kh||Dm===Ph){e.collapsedHeading=IE(e),e.inlineDescription=AE(e,a),Kh(Eu)&&e.inlineDescription===e.collapsedHeading&&(e.inlineDescription=null);const t=e.media;t&&t.kind===Zp&&(e.title=null)}if(t===lc){const t=e.heroMedia;if(!Nh(t)||!Nh(t.art)&&!Nh(t.video))continue}if(yE(e.media.kind,t)){if(Nh(n.filterOutMediaCardKinds)&&n.filterOutMediaCardKinds.has(e.media.kind))continue;s.push(e)}VE(e,a)}}return s}function wE(e,t,n,r,o,i){if(!Nh(t))return null;const s=new bS(t);switch(n&&(s.title=n),s.subtitle=r,t){case Bd:s.items=[SE(e,o.metricsPageInformation,o.metricsLocationTracker,()=>!0,i)];break;default:s.items=TE(e,t,o,i)}return s}function IE(e){return Nh(e.heading)?e.heading.replace(/\n/g," "):e.collapsedHeading}function AE(e,t){if(Kh(Eu))switch(e.media.kind){case Zp:return e.overlay instanceof Sk&&Nh(e.overlay.lockup)?e.overlay.lockup.title:null;default:const n=pL(t,bh);return Nh(n)?n.replace(/\n/g," "):null}switch(e.media.kind){case Zp:return e.overlay instanceof Ek?e.overlay.heading:Nh(e.title)?e.title.replace(/\n/g," "):null;default:const t=sg("TODAY_BRICK_STANDARD_DESCRIPTION");let n,r;return e.overlay instanceof Ek?(n=e.overlay.heading,r=e.overlay.title):(n=e.heading,r=e.title),t&&n&&r?t.replace("{heading}",n).replace(Md,r):null}}function SE(e,t,n,r,o){return Oh.context("todayCardsFromPlatformData",()=>{if(!e)return null;const i={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};i.enableFullScreenVideo=!1,i.coercedGeneralCardSubType=Nd,i.prevailingCropCode="fo";const s={pageInformation:t,locationTracker:n},a=[];for(const t of e){if(!Nh(t.attributes)){o&&o(t);continue}const e=bE(t,i,s);if(e&&r(e)){e.collapsedHeading=IE(e),e.inlineDescription=AE(e,t),Kh(Eu)&&e.inlineDescription===e.collapsedHeading&&(e.inlineDescription=null);const n=e.media;n&&n.kind===Zp&&(e.title=null),a.push(e)}}return a.length?new Rk(a):null})}function bE(e,t,n,r){return Oh.catchingContext("todayCardFromData",()=>{const o=yI(e,cf),i=PP(e);!function(e,t,n){const r=BE(e);let o=yI(e,op);if(o&&n.coercedGeneralCardSubType&&(o=n.coercedGeneralCardSubType),yI(e,cf)!==hu)return!1;if(r.length>=6&&o===Nd)return!1;const i=EE(hu);return!(!wI(e,Qn)&&LE(mI(e,i),n.prevailingCropCode))&&!CE(r)}(e,0,t)?t.clientIdentifierOverride=null:t.clientIdentifierOverride=i,t.crossLinkSubtitle=ME(e);let s=null;switch(o){case Id:s=function(e,t,n){return Oh.context("brandedCard",()=>{let r;Nh(t)&&(r=t.clientIdentifierOverride);const o=DE(e,n,r),i=t.useThreeLineOverlayForBranded;vE(e,o,n);try{const r=EE(Id),s=mI(e,r),a=LE(s,t.prevailingCropCode),c=FE(e,r);a?o.style=NE(s):(o.backgroundColor=fk.noArtBackgroundColor,o.style=Hf);const l=yI(e,cf),u=UE(o.style,l),d=qE(e,t,n,!0,u,"grey");if(!d||1!==d.length)return null;const p=d[0];switch(yI(e,op)){case Ga:case qa:{let t=!0,n=null;if(Nh(a)&&(t=!1,n=a.backgroundColor),i){const t=function(e){const t=yI(e,op);let n=yI(e,$n);Lh(n)&&t===Ga?n="FEATURED APP":Lh(n)&&t===qa&&(n="FEATURED GAME");return n}(e);let n=pL(e,bh);Fh(n)&&(n=p.title);let r=pL(e,af);if(Fh(r)){const t=RI(e,rp);if(0!==t.length){r=pL(t[0],cd)}Lh(r)&&!Lh(p.subtitle)&&(r=p.subtitle)}o.overlay=new Ek(t,n,r),o.style=Qf,o.title=null,Nh(a)&&Dm!==Eh&&(a.crop="fo")}else{const r=pL(e,af);let i=null;Mh(r)&&(i=new mm(r,mf,Jn)),o.overlay=new Sk(p,i,t,n)}break}default:{const e=new Ak(p);e.displaysIcon=!1,o.overlay=e;break}}return i||(o.title=yI(e,Df)),o.media=new fk(p.icon,a,c),o.media.impressionMetrics=p.impressionMetrics,o}finally{ZI(n.locationTracker)}})}(e,t,n);break;case hu:s=function(e,t,n){return Oh.context("contentCard",()=>{let r;Nh(t)&&(r=t.clientIdentifierOverride);const o=DE(e,n,r);vE(e,o,n);try{const r=BE(e),i=CE(r);if(i){const e=hx(i,{offerStyle:Np,metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker},artworkUseCase:1});return e?(e.theme=qf,o.media=new gk(e),o.media.impressionMetrics=e.impressionMetrics,o.media.impressionMetrics.fields[Ps]=o.impressionMetrics.fields.id,o.style=Qf,o):null}{const i=EE(hu),s=RE(e,o,i,t.prevailingCropCode);if(s){const r=yI(e,cf),i=UE(s.style,r),a=qE(e,t,n,!0,i);if(_E(e,s,a),null!==o.overlay&&o.overlay instanceof Pk){o.overlay.style=Qf}return o}if(1===r.length){const r=qE(e,t,n,!0);if(1!==r.length)return null;const i=r[0];return o.media=new pk(i.icon),_E(e,o,r),null!==o.overlay&&o.overlay instanceof Ak&&(o.overlay.displaysIcon=!1),o}{const i=r.filter(e=>{const t=aL(e);return!iL(e)||!t});let s,a,c=yI(e,op);switch(c&&t.coercedGeneralCardSubType&&(c=t.coercedGeneralCardSubType),Dm){case"tv":s=3,a=2;break;default:s=4,a=5}switch(Dm===Eh&&_E(e,o,[]),c){case Va:case Mc:{const r=qE(e,t,n,!1);if(r.length<s&&t.enableListCardToMultiAppFallback)return xE(e,r,o),o;if(c===Mc){let e=1;for(const t of r)t.ordinal=""+e,e++}return o.style=Qf,o.media=new hk(r,null),o}case"River":{t.canDisplayArcadeOfferButton=!1;const r=GE(i,t,n,!0);return 0===r.length?null:r.length<a?(xE(e,r,o),o):(o.style=Qf,o.media=new yk(r),o)}case Nd:{t.canDisplayArcadeOfferButton=!1;const r=GE(i,t,n,!0);if(0===r.length)return null;if(r.length<=a)return xE(e,r,o),o;const s=r.length%2!=0;let c;r.length<=9&&s&&"tv"!==Dm&&r.pop(),o.style=Qf;const l=r.length;return c=l<=13?Ud:l<=25?"mixed":Ou,o.media=new Tk(r,c),o}default:return null}}}}finally{ZI(n.locationTracker)}})}(e,t,n);break;case"Media":s=function(e,t,n){return Oh.context("mediaCard",()=>{let r;Nh(t)&&(r=t.clientIdentifierOverride);const o=DE(e,n,r);vE(e,o,n);try{switch(yI(e,A)){case"Video":return function(e,t,n,r){const o=OE(e);if(!o)return null;const i=vx(Hh(o,dd),{withJoeColorPlaceholder:!0,useCase:15});if(!i)return null;const s=Gh(o,lf);if(!s)return null;let a=ES;Mh(n.videoPlaybackControls)&&(a=n.videoPlaybackControls);let c=CS;Mh(n.videoPlaybackControls)&&(c=n.videoAutoplayPlaybackControls);const l=dL(e,af),u=new BA(s,i,{playbackControls:a,autoPlayPlaybackControls:c,canPlayFullScreen:n.enableFullScreenVideo});Dm===Ch&&(u.playbackControls.scrubber=!0,u.autoPlayPlaybackControls.scrubber=!0);return OA(u,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,id:e.id}),t.style=Qf,t.media=new wk(u,l),t.overlay=new Ek(t.heading,t.title,l),t.title=null,t.collapsedHeading=IE(t),t.heading=null,t}(e,o,t,n);case"FullBleedImage":const r=EE("Media"),i=RE(e,o,r,t.prevailingCropCode);return _E(e,i,[]),i;default:return null}}finally{ZI(n.locationTracker)}})}(e,t,n);break;default:s=null}if(Lh(s))return null;s.inlineDescription=dL(e,af);wI(e,oi)&&(s=function(e,t,n,r){let o=rk(t);!o&&n&&(o=ok(n.arcadeUpsellEditorialResponse));const i=function(e,t){if(!function(){if(!Kh("arcadeLockupOverlay"))return!1;const e=host.platform;return e===Yf||e===Ef}())return null;const n=wx(e,t,ii,qf,qd);return new Ck(n)}(o,r);i&&(e.overlay=i,e.impressionMetrics.fields[er]=!0);return e}(s,e,r,n));const a=new uk,c=PE(e,t.heroDisplayContext,o,t.prevailingCropCode);Nh(c)&&(a.art=c),Nh(s.media)&&s.media instanceof wk&&(a.video=s.media.video);if((Dm===Ch||"tv"===Dm)&&a.isValid()){s.heroMedia=a;let n=NE(mI(e,kE(t.heroDisplayContext,o)));if(!Nh(n)){n=NE(Hh(OE(e),dd))}s.style=n}return Lh(s)?(console.log("Unknown style: "+o),null):s})}function PE(e,t,n,r){return LE(mI(e,kE(t,n)),function(e,t){return e===jf&&Dm===Ch?"fn":t}(t,r))}function kE(e,t){return e===jf&&Dm===Ch?EE(t):Je}function EE(e){if(Dm===Eh)return"editorialArtwork.subscriptionHero";switch(e){case Id:return"editorialArtwork.dayCard";case hu:return"editorialArtwork.generalCard";case"Media":return ce;default:return null}}function CE(e){if(1===e.length){const t=e[0];if(t.type===Tf)return t}return null}function _E(e,t,n){if(!t)return;const r=dL(e,af),o=wI(e,"ignoreITunesShortNotes"),i=n&&0!==n.length,s=i&&1===n.length,a=Mh(Dk(e));if(!r||o||s&&a){if(s)t.overlay=new Ak(n[0]);else if(i){const e=new bk(n);e.displaysTitle=!1,t.overlay=e}}else t.overlay=new Pk(new mm(r,mf,Jn))}function RE(e,t,n,r){return Oh.context("cardWithArtwork",()=>{if(wI(e,Qn))return null;const o=mI(e,n),i=LE(o,r);return i?(t.media=new dk(i,FE(e,n)),t.style=NE(o),t.clickAction instanceof Vg&&(t.overlay=new kk(t.clickAction),t.style=Qf),t):null})}function OE(e){let t;const n=mI(e,"editorialVideo.storeFrontVideo4x3"),r=mI(e,"editorialVideo.storeFrontVideo");return t=Dm===Ph?n||r:r||n,t}function vE(e,t,n){JI({pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:Du,idType:Il,id:e.id},t.title)}function DE(e,t,n){return Oh.context("basicCard",()=>{const r=new _k,o=yI(e,Df),i=yI(e,cf),s=yI(e,op);r.heading=o;let a=dL(e,bh);Lh(a)&&i===Id&&(a=yI(e,Df)),r.title=a;const c=qh(e,"isOnBoardingCard");const l={cardType:i,franchise:o};Nh(s)&&(l[Xn]=s),c&&(l[Zn]=c);const u=yA(e,a,{targetType:Du,pageInformation:t.pageInformation,locationTracker:t.locationTracker}),d=u;return d[xd]=l,r.clickAction=Px(e,d,n,t.currentShelfRecoMetricsData),function(e,t,n,r,o,i){if(!e)return;const s=hA(t);s.franchise=VI(n),s.cardType=VI(r),i&&(s[Xn]=VI(i)),o&&(s[Zn]=o),e.impressionMetrics=new Sg(s)}(r,u,o,i,c,s),r})}function xE(e,t,n){const r=dL(e,af);if(n.media=new mk(t,r),n.clickAction instanceof Bg){const e=uI.from(n.clickAction.pageUrl);e.param(Cw,Fp),n.clickAction.pageUrl=e.build()}}function LE(e,t){if(e){const n=vx(e,{withJoeColorPlaceholder:!0,useCase:15});return n.crop=t||(Dm===Ch||"tv"===Dm?"fn":"sr"),n}return null}function FE(e,t){const n=mI(e,t);return Nh(n)?Gh(n,"bgGradientKind"):null}function NE(e){if(Fh(e))return null;const t=xy(Gh(e,_i)),n=Bh(e,me).map(e=>xy(e)),r=2===n.length;return t||r?r?Ly(n[0])?qd:Hf:Ly(t)?Hf:qd:null}function ME(e){let t=pL(e,af);if(Mh(t)||(t=dL(e,bh)),!Mh(t)){yI(e,cf)===Id&&(t=yI(e,Df))}return t}function UE(e,t){if(t!==Id)return null;switch(e){case Hf:return Hf;default:return null}}function BE(e){return RI(e,rp)}function qE(e,t,n,r,o,i){return GE(RI(e,rp),t,n,r,o,i,Dk(e))}function GE(e,t,n,r,o,i,s){if(Fh(e))return[];return Ax(e.filter(e=>!Mh(e.attributes)||e.type!==Tf),{lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker},offerEnvironment:o,offerStyle:i,clientIdentifierOverride:t.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:t.crossLinkSubtitle,artworkUseCase:1,canDisplayArcadeOfferButton:t.canDisplayArcadeOfferButton},shouldIgnoreLocationIncrement:r,filter:55166})}function VE(e,t){if("tv"!==Dm||!wI(t,oi))return;const n=XP();e.clickAction=n}function HE(e,t,n,r,o){return Oh.context("shareSheetDataForArticle",()=>{let i=r;!i&&o&&(i=function(e){const t=yI(e,cf),n=PE(e,jf,t);return Nh(n)?n:LE(mI(e,EE(t)))}(o));const s=sg("SHARE_STORY_SUBTITLE"),a=new um(e,s,i);return new pm(a,t,n)})}function $E(e){return Oh.context("shareSheetDataForProductFromProductData",()=>{if(Lh(e)||Dm===Eh)return null;let t=yI(e,Sh);const n=yI(e,bh),r=yI(e,Qp),o=e.id,i=Mm;if(!(t&&n&&r&&o))return null;let s=yI(e,"shortUrl"),a=null,c=null;const l=qx(e,4),u=Bx(e),d=cA(e,Ru)||r;Nh(e)&&yI(e,Sh)&&(a=Lx(e,{useCase:1}),c=function(e){return Oh.context("notesMetadataFromProductData",()=>{if(Lh(e))return null;const t=yI(e,bh);if(!t||0===t.length)return null;const n=yI(e,Sh),r=yI(e,Qp),o=yI(e,"genreNames.0"),i=eL(e);let s;switch(e.type){case Ah:s=sf;break;case gh:s=$i;break;case Tf:s="iap";break;default:s=null}return new lm(t,n,r,o,i,s)})}(e));let p=null;switch(host.clientIdentifier){case Cm:p=Zf;break;case Em:p=Eh}if(p){const e=new uI(t);if(e.param(oI,p),t=e.toString(),s){const e=new uI(s);e.param(oI,p),s=e.toString()}}const f=new dm(o,i,n,"iOS",a,l,u,!1,d,null,null,c);return new pm(f,t,s)})}function WE(e,t,n){return Oh.context("shareActionFromData: "+e.type,()=>{const r=e.id;switch(Dm){case Ch:{const o=$E(e);if(o){const e=new oy(o,[]);return BS(e,{targetType:wh,id:r,actionType:Sl,pageInformation:t,locationTracker:n}),e}break}case kh:case Ph:{const o=$E(e),i=[],s=function(e){if(!Xh.isContentGiftingEnabled)return null;if(Lh(e))return null;const t=Uk(e);return Lh(t)||TI(e,ih)?null:Vh(t,Td)>0?e.id:null}(e);if(s){const e=new Bg(Nf);e.presentationContext=Ye,e.title=sg("SHARE_GIFT_APP"),e.artwork=ak("systemimage://app.gift"),e.pageUrl="gift/"+s,BS(e,{targetType:wh,id:r,actionType:ic,actionContext:Qe,pageInformation:t,locationTracker:n}),i.push(e)}if(o){const e=new oy(o,i,"expanded");return e.title=sg("SHARE_APP"),e.artwork=ak(K),BS(e,{targetType:wh,id:r,actionType:Sl,actionContext:Qe,pageInformation:t,locationTracker:n}),e}if(i.length>0){const e=new ty(i);return e.isCancelable=!0,BS(e,{targetType:wh,id:r,actionType:"actionSheet",pageInformation:t,locationTracker:n}),e}break}}return null})}class zE{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1}}function jE(e,t){return Oh.context("articlePageWithResponse",()=>{const n=bb(e);t.metricsPageInformation=aP(Pu,n.id,e),t.metricsLocationTracker={rootPosition:0,locationStack:[]},t.pageId=n.id;const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},o=function(e){if(!Nh(e))return null;const t={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};switch(t.enableListCardToMultiAppFallback=!1,t.clientIdentifierOverride=e.clientIdentifierOverride,Dm){case Ch:t.prevailingCropCode="en",t.coercedGeneralCardSubType=Nd,t.heroDisplayContext=jf;break;case"tv":t.prevailingCropCode="ek",t.coercedGeneralCardSubType=Nd,t.heroDisplayContext=jf}return t}(t),i=bE(n,o,r);t.crossLinkSubtitle=ME(n),t.clientIdentifierOverride=o.clientIdentifierOverride,JI({pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,targetType:jf,id:t.pageId,idType:Il},i.title);const s=function(e,t,n){return Oh.context("renderArticle",()=>{const r=[],o=RI(e,Zo);for(const t of o){n.module=yI(t,"displayType"),n.subStyle=null;const o=JE(t,e,n);o&&(o.title=n.titleForNextShelf,r.push(o),n.titleForNextShelf=null),n.index++,tA(n.metricsLocationTracker)}if((n.showingFallbackMediaInline||Dm===Eh)&&0===r.length){const e=function(e){if(e.media instanceof hk){const t=e.media,n=new bS(ch);return n.items=t.lockups,n}return null}(t);Nh(e)&&r.push(e)}return r})}(n,i,t),a=s[s.length-1],c="tv"===Dm||t.isResilientDeepLink?null:function(e){const t=ZE(e);let n=null;const r=dL(e,bh),o=dL(e,af);r&&o&&(n=sg("SHARE_SHEET_TITLE_SUBTITLE_FORMAT","{title}: {subtitle}").replace(Md,r).replace(I,o));!n&&r&&(n=r);!n&&o&&(n=o);if(!n&&t){const r=yI(t,bh),o=yI(e,op);switch(o){case qa:n=sg("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(Md,r);break;case Ga:n=sg("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(Md,r);break;default:console.log("No title for article with unknown substyle: "+o)}}const i=yI(e,Sh);let s;switch(yI(e,A)){case Nd:case Va:case"River":s=ak("resource://ShareCollectionThumbnail",40,40);break;default:s=null}const a=HE(n,i,null,s,e);if(!Nh(a))return null;return new oy(a,[])}(n);if(c){const e=function(e,t){if(e&&t){const n=e.items.length;if(n>0&&-1!==XE.indexOf(t)){const t=e.items[n-1];switch(e.contentType){case ri:{const e=t;return e&&e.isFullWidth}case Ba:{const e=t;return e&&e.isFullWidth}default:return!0}}}return!1}(a,t.module),n=function(e,t,n){if(!Nh(e))return null;BS(e,{targetType:wh,id:t.pageId,actionType:Sl,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker});const r=new pS(Sl,sg("SHARE_STORY"),!n,e),o=new bS("roundedButton");return o.items=[r],o}(c,t,e);n&&s.push(n)}const l=new ck(i,s,c);return function(e,t,n){const r=ZE(t);if(r){const o=Dk(t);return void(e.footerLockup=function(e,t,n){const r={offerStyle:eC(),metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,externalDeepLinkUrl:n,crossLinkSubtitle:t.crossLinkSubtitle,artworkUseCase:0,canDisplayArcadeOfferButton:DL(ch)};return fx(e,r)}(r,n,o))}const o=wI(t,oi),i=host.platform===Yf||host.platform===Ef;if(Nh(n.additionalData)&&o&&i&&Kh("arcadeFooterLockup")){const r=rk(t);e.arcadeFooterLockup=function(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker};return wx(e,n,ii,qf,null)}(r,n)}}(l,n,t),"tv"===Dm&&(t.hasFocusableElements&&!t.hasNonFocusableElements?l.touchMode="focus":!t.hasFocusableElements&&t.hasNonFocusableElements?l.touchMode="pan":l.touchMode="auto"),l.shouldTerminateOnClose=t.isResilientDeepLink,lP(l,t.metricsPageInformation,e=>{let t=i.title;if(i.media instanceof fk&&i.overlay instanceof Ak){t=i.overlay.lockup.title}if(!t)return;let n=Gh(zh(e[sd]),eh);n=n||Gh(zh(e[ku])),e[sd]=n?`${n}_${t}`:"unknown_"+t}),l})}function YE(e){const t=new Set,n=bb(e),r=RI(n,Zo);for(const e of r){let r;if(r=QE(e,n),Mh(r))for(const e of r)t.add(e)}return t}function KE(e){let t;return e===ei&&(t=tk(Al)),e===ti&&(t=ek(10)),Lh(t)?null:jS(t).catch(()=>null)}function QE(e,t){if(yI(e,"displayType")!==ni)return null;const n=yI(e,"appMarkerType"),r=Lh(rk(t)),o=[];return"Acquisition"===n&&(host.platform===Yf&&o.push(ti),r&&o.push(ei)),o}function JE(e,t,n){return Oh.catchingContext("module: "+n.module,()=>{let r;switch(n.module){case"Header":n.titleForNextShelf=yI(e,ad),r=null;break;case"TextBlock":r=function(e,t){const n=yI(e,ad);if(!n)return null;const r=new mm(n,ip,jf);nC(r,t);const o=new bS(tf);return o.items=[r],o}(e,n),n.hasNonFocusableElements=!0;break;case"CollectionLockup":r=function(e,t){const n=wI(e,"showOrdinals"),r="OrdinalDesc"===yI(e,"collectionLockupDisplayType")?S:"ascending",o=yI(e,"collectionLockupSize");let i;if(t.subStyle=o,o)switch(o){case"Large":i=Pl;break;case"Medium":i=Of;break;case"Small":default:i=ch}const s={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:Ox(i),canDisplayArcadeOfferButton:DL(i)},a=Ax(RI(e,fh),{includeOrdinals:n,ordinalDirection:r,lockupOptions:s});if(!a||0===a.length)return null;const c=new bS(i);return c.items=a,c}(e,n),n.hasFocusableElements=!0;break;case"InlineImage":r=function(e,t){const n=yI(e,"inlineImageDisplayType"),r=vx(mI(e,uh),{useCase:13,allowingTransparency:n===bl});if(!r)return null;const o=new uS(r,!1,ip);if(o.caption=yI(e,ad),t.subStyle=n,n)switch(n){case"BoundingBox":o.isFullWidth=!1,o.hasRoundedCorners=!0;break;case bl:default:o.isFullWidth=!0,o.hasRoundedCorners=!1}nC(o,t);const i=new bS(ri);return i.items=[o],i}(e,n),n.hasNonFocusableElements=!0;break;case"AppLockup":r=function(e,t){const n=tC(e,t);if(!n)return null;const r=yI(e,"appLockupSize");let o;t.subStyle=r;let i=!1;if(r)switch(r){case"Small":o=ch,i=!0;break;case"Medium":o=Of,i=!0;break;case"Large":default:Dm===Eh||"tv"===Dm?(o=ch,i=!0):o=si}let s=null;const a=Dk(e);if(i){const e=new bS(o),r={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,externalDeepLinkUrl:a,artworkUseCase:Ox(o)},i=fx(n,r);e.items=[i],s=e}else s=function(e,t){const n=new bS(si),r="tv"===Dm,o="tv"!==Dm,i=tC(e,t),s=Dk(e),a=fx(i,{offerStyle:Np,metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:t.crossLinkSubtitle,artworkUseCase:1}),c=new NA(Ud,a);c.description=ax(i);let l=null;switch(yI(e,"appLockupVideo")){case"AppTrailer":{const e=Bx(i);e&&e.length>0&&(l=e[0]);break}}l&&(OA(l,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,id:t.pageId}),c.video=l);r&&(c.screenshots=qx(i,14,[Dm]));o&&(n.background={type:gp,color:NA.backgroundColor});return n.items=[c],n}(e,t);return s}(e,n),n.hasFocusableElements=!0;break;case"TipBlock":r=function(e,t){const n=vx(mI(e,uh),{useCase:13});if(!n)return null;const r=yI(e,ad),o=yI(e,"tipNumber"),i=new uS(n,!1,ip);i.isFullWidth=!1,i.hasRoundedCorners=!0,i.caption=r,i.ordinal=o,nC(i,t);const s=new bS(ri);return s.items=[i],s}(e,n),n.hasNonFocusableElements=!0;break;case"PullQuote":r=function(e,t){const n=yI(e,"quote"),r=yI(e,"quoteAttribution"),o=vx(mI(e,uh),{useCase:13}),i=yI(e,"pullQuoteDisplayType")===bl,s=new fS(n,r,o,i);nC(s,t);const a=new bS("quote");return a.items=[s],a}(e,n),n.hasNonFocusableElements=!0;break;case"HorizontalRule":r=function(e,t){let n=Fy("defaultLine");const r=mI(e,"customColor"),o=xy(Gh(r,"lightMode")),i=xy(Gh(r,"darkMode"));Fh(o)||Fh(i)||(n=Ny(o,i));const s=yI(e,"lineStyle"),a=yI(e,cf)===bl,c=new mS(s,n,a),l=new bS("horizontalRule");return l.items=[c],l}(e),n.hasNonFocusableElements=!0;break;case w:r=function(e,t){const n=vx(mI(e,"video.previewFrame"),{useCase:13});if(!n)return null;const r=yI(e,"video.video");if(!r)return null;const o=yI(e,"inlineVideoDisplayType")===bl,i=new BA(r,n,_S);OA(i,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,id:t.pageId});const s=new dS(i,o,ip);s.caption=yI(e,ad),nC(s,t);const a=new bS(Ba);return a.items=[s],a}(e,n),n.hasFocusableElements=!0;break;case"AppMedia":r=function(e,t){const n=tC(e,t);if(!n)return null;const r=yI(e,"appMediaOption"),o=yI(e,"appMediaPlatform");switch(t.subStyle=r,r){case"Screenshots":{let e=null;if(Dm===Ch){e=new bS("productMedia");const t=Gx(n,14);Nh(t)&&t.length&&(e.items=t)}else if(e=new bS(zp),Lh(o)){const t=qx(n,14);t&&t.length>0&&(e.items=[t[0]])}else{const t=function(e){switch(e){case"Watch":return Eh;case Yf:return Dm===Ph?Ph:kh;case id:return"tv";case Xo:return Zf;default:return null}}(o);if(t){const r=qx(n,14,[t]);r&&r.length&&(e.items=[r[0]])}}return Nh(e)&&0===e.items.length?null:e}case"AppTrailers":const e=new bS(Ba),r=Bx(n);if(r&&r.length>0){const n=r[0];OA(n,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,id:t.pageId});const o=new dS(n,!1,mf,null,null,!0);return e.items=[o],e}return null;default:return null}}(e,n),n.hasFocusableElements=!0;break;case"LinkBlock":r=function(e,t){const n=yI(e,Sh);if(!n)return null;const r=new uI(n),o=yI(e,"urlTitle");let i=yI(e,ad);i||(i=r.host);const s=["itunes.apple.com","apps.apple.com","music.apple.com","books.apple.com","podcasts.apple.com"];Kh("watchFaceFileLPF")&&s.push("watch-app.cdn-apple.com");let a=!1;for(const e of s)r.host.endsWith(e)&&(a=!0);const c=new Vg(n);BS(c,{targetType:Wf,pageInformation:t.metricsPageInformation,id:""+t.index,locationTracker:t.metricsLocationTracker});const l=new oS(o,i,c,a);nC(l,t);const u=new bS(Wf);return u.items=[l],u}(e,n),n.hasFocusableElements=!0;break;case"TextList":r=function(e,t){const n=gI(e,ad);if(!n.length)return null;const r=yI(e,"textListDisplayType");t.subStyle=r;let o,i=!1;switch(r){case"Bulleted":i=!0;break;default:i=!1}o=i?"<ul>":"<ol>";for(const e of n)o=`${o}<li>${e}</li>`;o+=i?"</ul>":"</ol>";const s=new mm(o,ip,jf);nC(s,t);const a=new bS(tf);return a.items=[s],a}(e,n),n.hasNonFocusableElements=!0;break;case"IAPLockup":r=function(e,t){const n=tC(e,t);if(!n)return null;const r=hx(n,{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:1});if(!r)return null;const o=new UA(r),i=new bS("inAppPurchaseShowcase");return i.background={type:gp,color:UA.backgroundColor},i.items=[o],i}(e,n),n.hasFocusableElements=!0;break;case ni:r=function(e,t,n){const r=yI(e,"appMarkerType");n.subStyle=r;let o=null;switch(r){case"OSUpgrade":o=function(e,t){const n=Dm;if(n!==Ch)return null;const r=vk(n);if(null===r)return null;const o=new Vg(r);BS(o,{targetType:Wf,pageInformation:t.metricsPageInformation,id:""+t.index,locationTracker:t.metricsLocationTracker});const i=sg("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),s=new yS(i,o);nC(s,t);const a=new bS("clientControlButton");return a.items=[s],a}(0,n);break;case"Acquisition":o=function(e,t,n){if(!Kh(kl))return null;if(host.platform!==Yf&&host.platform!==Ef)return null;let r=rk(t);if(!r&&n.additionalData){const e=n.additionalData.get(ei);r=ok(e)}if(!Nh(r))return null;const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},i=JP(n.metricsPageInformation,n.metricsLocationTracker);let s;i.title=sg(ld,ud);const a=HD(r.marketingItemData);if(Mh(a)){const t=Kh(b);s=t?ZD(r.marketingItemData,Al,o):QP(Al,null,null,{id:e.id,contextualAdamId:e.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),Nh(s)&&(s.title=a)}else s=JP(n.metricsPageInformation,n.metricsLocationTracker),s.title=sg(ld,ud);const c=new AS(s,i),l=JD(r.marketingItemData);c.unsubscribedDescription=l;const u=new nm(Th,Xh.arcadeAppAdamId,Np,null,Hf,null,null,null,null,null,null,null,null,null,null,null,null,Xh.arcadeProductFamilyId);u.titles[ai]=sg(ld,ud),c.offerDisplayProperties=u;const d={...o,targetType:kl,title:a,id:e.id,kind:kl,softwareType:null,displaysArcadeUpsell:!0};if(mA(c,d),host.platform===Yf){if(Lh(n.additionalData))return null;const e=n.additionalData.get(ti);if(Mh(e)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r=Eb(e);c.iconArtworks=xx(r,t,{useCase:2})}}const p=new bS(kl);p.items=[c];host.platform===Yf&&(p.background={type:gp,color:AS.shelfBackgroundColor});return p}(e,t,n)}return o}(e,t,n),n.hasFocusableElements=!0;break;case"StoryList":r=function(e,t){const n=RI(e,fh);if(!n)return null;const r=yI(e,bh),o=yI(e,cd),i=Dm===Ch||Kh(Eu)?yp:Bd,s=wE(n,i,r,o,t,null);Dm===Ch&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!(e instanceof _k)||yE(e.media.kind,i)));return s}(e,n),n.hasFocusableElements=!0;break;default:console.log("Unknown module: "+n.module),r=null}return r})}const XE=["AppLockup","InlineImage",w,ni];function ZE(e){const t=RI(e,rp);if(1!==t.length)return null;const n=t[0];if(!n)return null;switch(n.type){case Ah:case gh:return n;default:return null}}function eC(){switch(Dm){case Ch:return Qf;default:return qf}}function tC(e,t){const n=_I(e,fh);return n||null}function nC(e,t){if(!e)return;let n=t.module;t.subStyle&&(n=n+"_"+t.subStyle);const r={id:""+t.index,impressionIndex:t.index,idType:oh,impressionType:n,kind:"iosModule"};e.impressionMetrics=new Sg($I(r))}class rC extends Zh{constructor(e,t,n,r){super(),this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class oC extends wP{constructor(){super([])}}class iC extends Zh{}class sC extends Zh{}class aC extends Zh{}class cC extends Zh{}class lC extends Zh{constructor(e){super(),this.showsBadge=!1,this.title=null,this.notes=e,this.isCollapsed=!0}}class uC extends Zh{}const dC={11:"43",30:"44"};function pC(e,t){return`${Gy.internal}:/${pT}/${Vy}/${e}/${t}`}function fC(e){if(!Nh(e))return!1;if(wI(e,gd))return!0;return!!wI(e,"reviewsRestricted")}function hC(e,t){const n=uI.from(e),r=Gh(n.query,ze);return t&&Mh(r)&&(n.query[ze]=dC[r]||r),n}function mC(e,t,n=null){const r=new ny(vl);r.title=sg("TOAST_TAP_TO_RATE_TITLE"),r.message=sg("TOAST_TAP_TO_RATE_DESCRIPTION"),r.artwork=ak("resource://ToastStar.png",95,90);const o=new Zg(function(e,t){return hC(Xh.userRateURL,t).param("id",e).build()}(e,t));o.adamId=e,o.method=Au,o.isStoreRequest=!0,o.disableCache=!0,o.successAction=r;const i=new Jg(Hp,"urlQuery",hi),s=new Jg("version-to-review","urlQuery",hi);return o.parameters=[i,s],"tv"===Dm&&Mh(n)&&(o.title=sg("TV_RATE_PRODUCT").replace(Md,n)),o}function gC(e,t,n,r=!1,o=!0){return Oh.context("createReviewItems",()=>{const i=function(e,t){if(t){return 1e3*((new Date).getTime()-e.getTime())<3600?sg("TIME_AGO_EDITED_JUST_NOW"):sg("TIME_AGO_EDITED_TIME").replace("{time}",fg(e,"standalone"))}return fg(e,"standalone")};return n.map(n=>{const s=new sC;s.id=Gh(n,"id",eh),s.title=yI(n,fd);const a=yI(n,_u);a&&(s.date=new Date(a),s.dateText=i(s.date,wI(n,"isEdited"))),s.contents=yI(n,"review"),s.rating=II(n,Hp),s.reviewerName=yI(n,"userName");const c=yI(n,"developerResponse.id");if(Mh(c)){const e=new aC;e.id=c,e.contents=yI(n,"developerResponse.body");const t=yI(n,"developerResponse.modified");t&&(e.date=new Date(t),e.dateText=i(e.date,!1)),s.response=e}if(r&&(s.moreAction=function(e,t,n){if(!n)return null;return Oh.context("singleReviewActionFromReviewData",()=>{const r=TC(e,t,[n]),o=new oC;o.adamId=Gh(t,Pf),o.targetReviewId=Gh(n,"id",eh),o.shelves=[r];const i=new Bg(mh);return i.pageData=o,i.title=kC(),i})}(e,t,n)),o){Gh(t,Pf);s.flowPreviewActionsConfiguration=function(e,t,n){if(Fh(e)||Dm!==kh&&Dm!==Ph&&Dm!==Ch)return null;const r=[_C(e,t,!0),_C(e,t,!1)];Mh(Xh.reportConcernUrl)&&r.push(function(e,t){return Oh.context("reportConcernActionFromApiRow",()=>{const n=Gh(e,"id",eh),r=Xh.reportConcernUrl,o=new Xg(r);o.method=Au,o.isStoreRequest=!0,o.disableCache=!0,o.needsAuthentication=!0,o.headers={"Content-Type":EC.contentType},o.body=(new EC).param(Q,n).param("guid",t).build();const i=new Jg("selectedReason","formBody",hi),s=new Jg("explanation","formBody",up);o.parameters=[i,s];const a=new ny(vl);a.title=sg("TOAST_CONCERN_REPORTED_TITLE"),a.message=sg("TOAST_CONCERN_REPORTED_DESCRIPTION"),a.artwork=ak(Z),o.successAction=a;let c=Xh.reportConcernReasons;Fh(c)&&(c=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}]);const l=c.map(e=>new fm(Gh(e,"reasonId"),Gh(e,bh),Gh(e,"upperCaseName"))),u=new iy(l);return u.title=sg("ACTION_REVIEW_REPORT"),u.explanation=Xh.reportConcernExplanation,Fh(u.explanation)&&(u.explanation="Tell us a little more (Optional)"),u.artwork=ak(Z),u.sendAction=o,u})}(e,t));return new gm(r)}(n,e)}return s})})}function yC(e,t,n,r=!1){return Oh.context("createWriteReviewAction",()=>{const o=sg(r?"EDIT_REVIEW":"WRITE_A_REVIEW"),i=function(e,t){return hC(Xh.writeReviewURL,t).param("id",e).build()}(e,t);let s;switch(Dm){case Ch:{const t=new ey(e,i);t.title=o,t.appIcon=n,s=t;break}default:{const t=new Bg("writeReview");t.title=o,t.pageUrl=i,t.pageData=e,t.presentationContext=Ye,s=t;break}}return s})}function TC(e,t,n,r=!1,o=!0){return Oh.context("reviewsShelfForReviewsData",()=>{const i=new bS(mh);return i.items=gC(e,t,n,r,o),i})}function wC(e,t,n,r,o,i,s,a=!1,c=!0,l=null,u=!1){return Oh.context("reviewsContainerShelfForReviewsData",()=>{const c=function(e,t,n,r,o,i,s=null,a=!1){return Oh.context("reviewsContainerForReviewsData",()=>{const c=new uC,l=Gh(t,Pf),u=qh(t,"isBundle");if(c.adamId=l,c.ratings=function(e,t){return t?Oh.context("ratingsFromApiResponses",()=>{const e=new iC;e.productId=Gh(t,Pf,eh),e.ratingAverage=Vh(t,"ratingAverage"),e.totalNumberOfRatings=Vh(t,je),e.totalNumberOfReviews=Vh(t,"totalNumberOfReviews");const n=Bh(t,"ratingCountList").slice().reverse(),r=n.reduce((e,t)=>e+t,0);e.ratingCounts=r>0?n.map(t=>t/r*e.totalNumberOfRatings):n;if(!(e.ratingAverage>0&&e.ratingCounts)){const n=qh(t,"wasReset");e.status=sg(n?"RATINGS_STATUS_DEVELOPER_RESET":"RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return e}):null}(0,t),a&&"tv"!==Dm||(c.tapToRate=function(e,t,n=null,r=null){const o=new cC;switch(Dm){case"tv":o.title=sg("TV_SELECT_TO_RATE");break;case Ch:o.title=sg("CLICK_TO_RATE");break;default:o.title=sg("TAP_TO_RATE")}return o.rating=r,o.rateAction=mC(e,t,n),o}(l,u,r,s)),Nh(n)&&n.length>0){const r=Dm===Eh,o=!r,i=r?n.slice(0,1):n;c.reviews=gC(e,t,i,o,o)}if(Lh(c.reviews)||0===c.reviews.length){const e=c.ratings.ratingAverage>0&&c.ratings.ratingCounts,n=qh(t,"wasReset");e||n||(c.ratings.status=sg("RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS"))}if(Lh(i)||(c.editorsChoice=i),!a||"tv"===Dm){const e=Nh(s)&&s>0;c.writeReviewAction=yC(l,u,o,e)}const d=Gh(t,"supportUrl");if(d){const e=new Vg(d,!1);e.title=sg("APP_SUPPORT"),c.supportAction=e}return c})}(e,t,n,r,o,i,l,u),d=new bS(Ke);return d.title=kC(),d.items=[c],a&&Nh(c.reviews)&&c.reviews.length>0&&(d.seeAllAction=PC(e,t,n,s,r,o)),d})}function IC(e,t,n){return Oh.context("personalizedReviewsContainerShelf",()=>{const r=II(bb(n),Hp);return wC(e,t.ratingsData,t.reviewItems,t.appName,t.appIcon,t.editorsChoice,t.nextPageHref,t.includeSeeAllAction,!1,r)})}function AC(e,t,n,r){const o=function(e,t){return`${Gy.internal}:/${pT}/${e}/${t}`}(e,t);return new rC(t,n,r,o)}function SC(e,t,n,r,o=null,i=null,s=null,a=null,c="helpful"){const l=new oC;return l.shelves=[],Oh.context("reviewsPageForReviewsData",()=>{let u,d;if(Mh(o)&&Mh(n)&&n.length%2>0){const r=n.slice(0,n.length-1);d=n.slice(n.length-1),u=TC(e,t,r,!1)}else u=TC(e,t,n,!1),d=[];const p=Lh(i)?Gh(t,Pf):i;if(r&&!Lh(t)){l.adamId=p;const n=wC(e,t,[],s,a);l.shelves.push(n)}return u.items.length>0&&(r&&(u.presentationHints={isSortable:!0},Lh(t)||(l.initialSortOptionIdentifier=c,l.sortActionSheetTitle=sg("REVIEWS_SORT_BY"),l.sortOptions=[AC(p,"helpful",sg("REVIEWS_MOST_HELPFUL"),sg("REVIEWS_SORT_BY_MOST_HELPFUL")),AC(p,"favorable",sg("REVIEWS_MOST_FAVORABLE"),sg("REVIEWS_SORT_BY_MOST_FAVORABLE")),AC(p,"critical",sg("REVIEWS_MOST_CRITICAL"),sg("REVIEWS_SORT_BY_MOST_CRITICAL")),AC(p,"recent",sg("REVIEWS_MOST_RECENT"),sg("REVIEWS_SORT_BY_MOST_RECENT"))])),l.shelves.push(u),Mh(o)&&(l.nextPage=function(e,t,n,r){return{url:pC(e,n),remainingContent:r,nextHref:t,profile:Yp,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(p,o,c,d))),l})}function bC(e,t,n,r,o,i){return Oh.context("reviewsPageForReviewsMediaContainer",()=>{let s;return s=Mh(r.data)?n.concat(r.data):n,SC(e,null,s,o,r.next,t,null,null,i)})}function PC(e,t,n,r=null,o=null,i=null){return t?Oh.context("reviewsPageActionFromReviewsData",()=>{const s=SC(e,t,n,!0,r,null,o,i);s.title=Dm===Eh?sg(Hi):null;const a=new Bg(mh);return a.pageData=s,a.title=sg(Tp),a}):null}function kC(){switch(Dm){case"tv":return sg("TV_PRODUCT_SECTION_RATINGS");case Eh:return null;default:return sg(Hi)}}class EC{constructor(){this._params=""}static get contentType(){return Ra}param(e,t){if(e&&t){const n=this._params.length>0?"&":"";this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}function CC(e,t,n,r,o,i,s){return Oh.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(Dm!==kh&&Dm!==Ph)return null;const a=function e(t){return Oh.context("productDataFromData: "+t.type,()=>{switch(t.type){case Ah:case gh:return t;case rh:{const n=RI(t,rp);if(Mh(n)&&1===n.length){const t=n[0];return e(t)}break}case Za:{const n=RI(t,fh);if(Mh(n)&&1===n.length){const t=n[0];return e(t)}break}default:return null}return null})}(e);if(!Mh(a))return null;const c=[];let l=null,u=null;const d=wI(a,ih);if(t){const e=uL(a),t=nx(a.type,e),r=function(e,t,n,r,o,i){if(Lh(e)||e.type!==Ah)return null;const s=Uk(e),a=Lx(e,null,o),c=zI(e,a);return qk(s,e,t,c,i,wf)}(a,d,0,0,n,i);u=Kk(r,t,a,d,null,null,null,null,wf);const p=function(e,t,n,r,o,i,s){if(Lh(t))return null;let a=Wk(t,e,n,o,wf,!1,r);Mh(s)&&(a=xk(a,t.adamId,s,i));return a}(a,r,d,n,i,o,s);Nh(p)&&Nh(u)&&(l=c.length,c.push(p))}const p=function(e,t){const n=WE(e,t.pageInformation,t.locationTracker);if(Nh(n))return n.title=sg("FLOW_PREVIEW_ACTION_SHARE"),n.artwork=ak(K),n;return n}(a,o);Nh(p)&&c.push(p);const f=fC(a);if(!d&&!f){if(Nh(r)&&r instanceof Bg&&r.pageData instanceof iP){const e=function(e,t){const n=function(e){return Oh.context("seeRatingsAndReviewsActionFromData",()=>{const t=wA(e);if(e.pageData instanceof iP){const n=new rP(_h,mh),r=new sy(n),o=wA(e.pageData);o.fullProductFetchedAction=r,t.pageData=o}return t})}(t);Nh(n)&&(n.title=sg("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),n.artwork=ak("systemimage://star"),n.animationBehavior=Wp);return n}(0,r);Nh(e)&&c.push(e)}if(!LI(e,lp)){const e=function(e){const t=function(e){return Oh.context("writeReviewActionFromData",()=>{const t=e.id;if(Mh(t)){const n=e.type===gh,r=II(e,Hp);return yC(t,n,null,Nh(r)&&r>0)}return null})}(e);Nh(t)&&(t.title=sg("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),t.artwork=ak("systemimage://square.and.pencil"));return t}(a);Nh(e)&&c.push(e)}}return new gm(c,u,l)})}function _C(e,t,n){const r=Xh.voteUrl,o=Gh(e,"id",eh),i=new uI(r).param(Q,o),s=new Qg(i.build()),a=new ny(vl);return n?(s.title=sg("ACTION_REVIEW_HELPFUL"),a.title=sg("TOAST_HELPFUL_TITLE"),a.message=sg("TOAST_HELPFUL_DESCRIPTION"),s.artwork=ak(J),a.artwork=ak(J)):(s.title=sg("ACTION_REVIEW_NOT_HELPFUL"),a.title=sg("TOAST_NOT_HELPFUL_TITLE"),a.message=sg("TOAST_NOT_HELPFUL_DESCRIPTION"),s.artwork=ak(X),a.artwork=ak(X)),s.method=Au,s.isStoreRequest=!0,s.disableCache=!0,s.headers={"Content-Type":EC.contentType},s.body=(new EC).param("vote",n?"1":"0").param("guid",t).build(),s.successAction=a,s}function RC(e,t){return Oh.context("continuePlayingShelfForGrouping",()=>{if(!function(e){switch(e){case Yf:case id:case Ef:return!0;default:return!1}}(host.platform))return null;const n=function(e,t){return Oh.context("videoCardContinuePlayingShelf",()=>{const n={id:t.id,kind:null,softwareType:null,targetType:ah,title:sg(x),pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,fcKind:t.featuredContentId};JI(n,n.title);const r=new bS("videoCard");r.isHorizontal=!0,r.batchGroup="gameCenterContinuePlaying";const o=e.data,i=[];for(const e of o){if(vS(e))continue;const r=OC(e,n,t.clientIdentifierOverride);r&&(i.push(r),tA(n.locationTracker))}return r.items=i,ZI(t.metricsLocationTracker),mA(r,n),r})}(e,t);return n.mergeWhenFetched=!1,n.title=sg(x),n.subtitle=t.subtitle,n.batchGroup="gameCenterContinuePlaying",n.isHidden=!t.isFirstRender&&0===n.items.length,n})}function OC(e,t,n){return Oh.context("editorialSplashVideoCardForContinuePlaying",()=>{const r=eA(t.locationTracker),o={pageInformation:t.pageInformation,locationTracker:t.locationTracker,targetType:Yp,anonymizationOptions:{anonymizationString:"GAME"+r}},i={metricsOptions:o,artworkUseCase:1,offerEnvironment:Hf,offerStyle:Qf,canDisplayArcadeOfferButton:!0,isSubtitleHidden:!0},s=function(e){return Oh.context("editorialSplashVideoWithTopShelfStill",()=>{let t=null;const n=sA(e,L);return Nh(n)&&(t=vx(n,{withJoeColorPlaceholder:!0,useCase:22,cropCode:"sr"})),rL(e,t)})}(e);if(!s||!s.preview)return null;const a=fx(e,i);if(!a)return null;const c=function(e,t,n,r){const o=NS(e,n),i=Sx(e,o,r);if(t===id){const t=new Kg(e.id,sf),r={actionType:za,id:e.id,contextualAdamId:e.id,anonymizationOptions:n.anonymizationOptions,pageInformation:n.pageInformation,locationTracker:n.locationTracker};BS(t,r);const o=new Yg(e.id,i);return o.openAction=t,o.cancelAction=i,o}return i}(e,host.platform,o,n);if(!c)return null;const l=new nS;l.video=s,l.lockup=a,l.overlayStyle=Hf,l.clickAction=c;const u=NS(e,o);l.flowPreviewActionsConfiguration=CC(e,!0,n,l.clickAction,o,u);return mA(l,yA(e,a.title,o)),l})}function vC(e,t,n,r){return Oh.context("gameCenterReengagementShelf",()=>{if(!Nh(t))return null;const o=new bS("gameCenterReengagement");o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=nf;const i={id:r.id,kind:null,softwareType:null,targetType:Wd,title:ee,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:sp,fcKind:r.featuredContentId,badges:{gameCenter:{}}},s=nL(e.data[0],20);let a=Fy("componentBackground"),c=null;Mh(s)&&(c=s.preview,a=c.backgroundColor);const l={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker},offerStyle:Qf,artworkUseCase:Ox(ch),isSubtitleHidden:!0}};JI(i,i.title);const u=Ix(e,l)[0];ZI(r.metricsLocationTracker);let d=null;Mh(u)&&(d=new my(u.bundleId),d.title=ee,BS(d,i));let p="Game Center";if(Kh(Dl)){let e=sg(te);(Fh(e)||e===te)&&(e=sg("GAME_CENTER_REENGAGEMENT_BADGE_ACHIEVEMENTS")),Mh(e)&&(p=e)}const f=function(e){const t=Gh(e,"id"),n=Gh(e,fd),r=Gh(e,Ru),o=function(e){const t=Gh(e,Bp),n=new Im(t);return n.percent=Vh(e,"percent"),n.date=Gh(e,_u),n.artwork=new im(Gh(e,"artwork.template"),Vh(e,"artwork.width"),Vh(e,"artwork.height"),[]),n}(Hh(e,"status"));return new Am(t,n,r,o)}(t),h=function(e,t){if(!Nh(e))return{title:"",subtitle:null};const n=Kh(Dl),r=Kh("gamecenterReengagementTitleChanges2"),o=Kh("gamecenterReengagementTitleChanges3");if(r){if(0===t.completed)return{title:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_FIRST_TITLE"),subtitle:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_FIRST_SUBTITLE")};switch(e.status.type){case ec:case mi:case tc:return{title:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_KEEPPLAYING_TITLE"),subtitle:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_KEEPPLAYING_SUBTITLE")};case nc:return o?{title:sg(ne),subtitle:cg(re,[t.completed,t.total])}:{title:sg(ne),subtitle:sg(re).replace(oe,pg(t.completed)).replace(ie,pg(t.total))};default:return{title:"",subtitle:null}}}else if(n)switch(e.status.type){case ec:case mi:return{title:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_LOCKED_TITLE"),subtitle:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_LOCKED_SUBTITLE")};case tc:return{title:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_INPROGRESS_TITLE"),subtitle:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_INPROGRESS_SUBTITLE")};case nc:return{title:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_COMPLETED_TITLE"),subtitle:sg("GAME_CENTER_REENGAGEMENT_ACHIEVEMENT_COMPLETED_SUBTITLE").replace(oe,pg(t.completed)).replace(ie,pg(t.total))};default:return{title:"",subtitle:null}}else switch(e.status.type){case ec:case mi:return{title:"Let's Get Started",subtitle:"Unlock your first achievement for this game"};case tc:return{title:"Don't Stop Now",subtitle:"Keep playing to unlock this achievement."};case nc:return{title:"You're On a Roll",subtitle:"You've unlocked 6/24 achievements in this game."};default:return{title:"",subtitle:null}}}(f,function(e){const t=Vh(e,"completedAchievements"),n=Vh(e,"totalAchievements");return{completed:t,total:n}}(n)),m=new SS("gamecenter.fill",p,h.title,h.subtitle,f,u,a,c,d);return o.items=[m],mA(m,i),o})}class DC extends Zh{constructor(e,t,n,r,o){super(),this.instanceId=e,this.adamId=t,this.advertType=n,this.invocation=r,this.reportingDestination=o}}function xC(e){return yI(e,"jet_native_advert_instanceid")}function LC(e,t){Fh(e)&&Lh(e.attributes)||(e.attributes.jet_native_advert_instanceid=t)}function FC(e){return Mh(mI(e,Pp))}function NC(e,t,n){const r=function(e,t){let n=xC(e);Fh(n)&&(n=random.nextUUID(),Jb("Error: instanceId was null or empty. Assigned "+n));const r=mI(e,Pp),o=yI(e,"iad.impressionId"),i=yI(e,"iad.privacy"),s=new Lb(i);s.title=sg("IAD_PRIVACY_MARKER_BUTTON_TITLE");const a=uL(e)?xc:qt,c=UC(t);return s.adActionMetrics=new DC(n,e.id,a,"markerPress",c),new xb(n,r,o,s)}(e,n),o=uL(e)?xc:qt,i=UC(n);if(t.clickAction.adActionMetrics=new DC(r.instanceId,e.id,o,"advertPressed",i),t.buttonAction.adActionMetrics=new DC(r.instanceId,e.id,o,"offerButtonPress",i),!Kh("advertActionMetrics")){const e={};n.pageInformation.iAdInfo.iAdClickEventFields&&Object.assign(e,n.pageInformation.iAdInfo.iAdClickEventFields),t.clickAction=new dy(t.clickAction,r.impressionId,e),t.buttonAction=new dy(t.buttonAction,r.impressionId,e),r.transparencyAction=new dy(r.transparencyAction,r.impressionId,e)}t.searchAd=r,t.itemBackground="ad",t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Np,"ad")),wI(e,"iad.format.userRating")||(t.rating=null,t.ratingCount=null),function(e,t,n){const r=zI(e,t.icon),o=gA(e,t,r,n,!0);t.clickAction.actionMetrics.clearAll(),function(e,t){if(!Lh(e.searchAd)&&(e.clickAction&&BS(e.clickAction,t,!0),e.searchAd.transparencyAction)){const n=t.pageInformation,r={actionType:"ad_transparency"};n.iAdInfo&&Object.assign(r,n.iAdInfo.clickFields);const o=PA(e.adamId,wh,r);o.includingFields.push(nd),e.searchAd.transparencyAction.actionMetrics.addMetricsData(o)}}(t,o),function(e,t,n){if(!e||!n)return;mA(e,t);const r=$I(n.fastImpressionFields);Object.assign(e.impressionMetrics.fields,r),e.impressionMetrics=new _g(e.impressionMetrics,!0),e.impressionMetrics.fields[Ps]=rl}(t,o,o.pageInformation.iAdInfo)}(e,t,n)}function MC(e,t,n){const r=gI(e,"iad.assetOverride");if(r.length){const e=function(e,t){const n=new Set(t),r=[],o=[],i=function(e,r){if(0===n.size)return!1;for(const o of t)if(o===r||-1!==e.indexOf(o))return n.delete(o),!0;return!1};if(t.length&&(e.screenshots.length||e.trailers.length)){if(e.trailers.length)for(const t of e.trailers[0].videos)i(t.videoUrl,t.preview.checksum)&&r.push(t);if(e.screenshots.length)for(const t of e.screenshots[0].artwork)i(t.template,t.checksum)&&o.push(t)}return!(0!==n.size||!r.length&&!o.length)&&(e.trailers.length&&(e.trailers[0].videos=r),e.screenshots.length&&(e.screenshots[0]=new sm(o,e.screenshots[0].mediaPlatform)),!0)}(t,r);n.pageInformation.iAdInfo&&n.pageInformation.iAdInfo.iAdIsPresent&&n.pageInformation.iAdInfo.setSpecifiedCreativeUsed(e)}}function UC(e){var t,n;const r=null===(n=null===(t=e)||void 0===t?void 0:t.pageInformation)||void 0===n?void 0:n.iAdInfo;if(Lh(r))return yh;const o=r.placementType;switch(o){case $u:return"promotedContent";case Ql:return"searchAds";default:MI()}}function BC(e,t){if(!e)return null;const n=e.length,r=n%t;return n>=t?e.slice(0,n-r):e}function qC(e,t){const n=function(e,t){const n={id:t.id,kind:null,softwareType:null,targetType:ah,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,fcKind:t.featuredContentId,badges:{gameCenter:{}}};JI(n,t.title);const r=new bS(Pl);r.isHorizontal=!0;const o="tv"===Dm?20:8,i=e.data,s=[];for(let e=0;e<i.length;e++){const n=i[e],r={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(n),anonymizationOptions:{anonymizationString:"GAME"+(e+1)}},artworkUseCase:3,canDisplayArcadeOfferButton:DL(Pl),shouldShowFriendsPlayingShowcase:!0},o=uA(n,Gl);if(wI(n,ih)||!o)continue;const a=fx(n,r);Nh(a)&&(s.push(a),tA(r.metricsOptions.locationTracker))}let a;switch(Dm){case kh:a=2;break;case Ph:case Ch:case"tv":a=6;break;default:a=0}if(ZI(t.metricsLocationTracker),s.length<a)return r.isHidden=!0,r;const c=s.slice(0,o);if(r.items=c,r.isHidden=!1,r.batchGroup=nf,s.length>o){const e=new bS(Of);e.title=t.title,e.items=s,e.rowsPerColumn=1;const o=new Bg(hh);o.title=sg(Tp),o.pageData=new wP([e]),qS(o,null,{pageInformation:n.pageInformation,locationTracker:n.locationTracker}),r.seeAllAction=o}return mA(r,n),r}(e,t);return n.mergeWhenFetched=!0,n.batchGroup=nf,Kh(xl)?(n.eyebrow=lg(sg(Pc)),n.eyebrowArtwork=ak("tv"===Dm?Vi:kc,16,16),n.subtitle=t.subtitle):n.subtitle=sg("AppleArcade.GameCenter.FriendsArePlaying.Tagline.AzulA"),n.title=t.title,n.isHidden=0===n.items.length,n}class GC extends Zh{constructor(e){super(),this.incidentType=e}}class VC extends GC{constructor(e,t){super("discard"),this.instanceId=e,this.reason=t}}function HC(e,t){Lh(e)||e.incidents.push(t)}function $C(e,t){if(Dm!==kh&&Dm!==Ph)return null;const n=function(e,t){if(Dm!==kh&&Dm!==Ph)return null;const n={id:t.id,kind:null,softwareType:null,targetType:ah,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,fcKind:t.featuredContentId,badges:{gameCenter:{}}};JI(n,t.title);const r=new bS("smallContactCard");r.isHorizontal=!0,r.mergeWhenFetched=!0,r.batchGroup=nf;const o=[];for(let n=0;n<e.length;n++){const r="FRIEND_SUGGESTION"+(n+1),i=e[n];i.buttonText=sg("INVITE"),i.subtitle=sg("FROM_CONTACTS");const s={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,id:r,anonymizationOptions:{anonymizationString:r}};i.buttonAction=new gy(i.contactId),BS(i.buttonAction,{...s,actionType:"inviteFriend"}),i.removeButtonAction=new yy(i.contactId),BS(i.removeButtonAction,{...s,actionType:"removeFriendSuggestion"});const a={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:r,id:r,kind:"friendSuggestion",softwareType:null,anonymizationOptions:{anonymizationString:r}};mA(i,a),o.push(i),tA(t.metricsLocationTracker)}return mA(r,n),r.items=o,r.isHidden=0===r.items.length,ZI(t.metricsLocationTracker),r}(e,t);return Kh(xl)?(n.eyebrow=lg(sg(Pc)),n.eyebrowArtwork=ak(kc,16,16),n.subtitle=t.subtitle):n.subtitle=sg("AppleArcade.GameCenter.FriendSuggestions.Tagline.AzulA"),n.title=t.title,n.batchGroup=nf,n.isHidden=0===n.items.length,n}function WC(e,t){const n=II(e,yd);Oh.catchingContext("walkFeaturedContent: "+n,()=>{const r=_I(e,qp);if(Nh(r))return void WC(r,t);let o=null;const i=yI(e,"gamesFilter");switch(i){case Th:case"nonArcade":case"all":o=i;break;default:495!==n&&500!==n||(o=Th)}let s=null;let a=yI(e,YC(n)),c=null,l=yI(e,cd),u=!1;const d=RI(e,gi)[0];if(476===n&&Mh(d)){if(!Kh(xl))return;s=lg(yI(e,YC(n))),a=yI(d,YC(n)),c=Lx(d,{useCase:1}),l=null,u=!0}const p={featuredContentId:n,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,pageGenreId:t.pageGenreId,featuredContentData:e,id:Gh(e,"id"),eyebrow:s,eyebrowArtwork:null,title:a,titleArtwork:c,subtitle:l,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,ordinalIndex:1,isSearchGrouping:t.isSearchGrouping,isArcadePage:t.isArcadePage},f={id:p.id,kind:null,softwareType:null,targetType:ah,title:u?p.eyebrow:p.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,fcKind:n,recoMetricsData:jC(e)};let h,m=!0,g=!1;switch(n){case 413:case 414:case 254:case 255:case 256:case 266:case 271:zC(e,t);break;case 424:{const n=RI(e,vf);t.topChartIdentifiers=[];for(const e of n){if(f_(II(e,yd))){const n=yI(e,Ll);Mh(n)&&t.topChartIdentifiers.push(n)}}zC(e,t),t.topChartIdentifiers=[];break}case 425:{const n=_I(e,vf);if(n){const e=RI(n,vf);e.length&&(JI(f,p.title),h=QC(e,p),ZI(t.metricsLocationTracker),g=!0)}break}case 415:case 416:case 501:case 417:case 258:JI(f,p.title),p.clientIdentifierOverride=PP(e);h=JC(RI(e,vf),p),ZI(t.metricsLocationTracker),g=!0;break;case 421:case 422:case 423:case 261:{JI(f,p.title);let n=TI(e,"suppressText");Lh(n)&&(n=!0);const r=!n;p.clientIdentifierOverride=PP(e);h=KC(RI(e,vf),p,r),ZI(t.metricsLocationTracker),g=!0;break}case 437:case 265:JI(f,p.title),h=n_(e,p),ZI(t.metricsLocationTracker),g=!0;break;case 436:zC(e,t);break;case 475:{JI(f,p.title);const n=function(e){switch(e){case Ou:return yp;case"medium":return ki;case Ud:return lc;case Fl:return Dm===kh||Dm===Ph?rc:null;default:return null}}(yI(e,cf)),r=RI(e,fh),o={metricsLocationTracker:p.metricsLocationTracker,metricsPageInformation:p.metricsPageInformation};h=n===rc?e_(r,p,o):ZC(r,n,p,o),p.shelfStyle=n,g_(h,p),ZI(t.metricsLocationTracker),g=!0;break}case 480:h=function(e,t,n){const r=yI(e,cf),o=RI(e,fh);switch(r){case Ou:return a_(o,t);case oc:return t_(o,!0,t,n);case Ud:return t_(o,!1,t,n);default:return null}}(e,p,t),0===t.shelves.length&&(h.presentationHints={isFirstShelf:!0}),m=!1;break;case 500:h=function(e){const t=RC({data:[]},e);if(!t)return null;const n=y_(e);return t.url=n+`?${ww}=true`,t.batchGroup="gameCenterContinuePlaying",t}(p),g=!0;break;case 494:h=function(e){const t=vC({data:[]},{},{},e);if(!t)return null;const n=y_(e);return t.url=n+`?${Sw}=true`,t.batchGroup=nf,t}(p),g=!0;break;case 495:h=function(e){const t=qC({data:[]},e),n=y_(e);return t.url=n+`?${Iw}=true`,t}(p),g=!0;break;case 496:h=function(e){if(Dm!==kh&&Dm!==Ph)return null;const t=$C([],e),n=y_(e);return t.url=n+`?${Aw}=true`,t.isHidden=0===t.items.length,t.batchGroup=nf,t}(p),g=!0;break;default:if(u_(n)){if(497===p.featuredContentId&&!Kh(Xa))break;const r=!wI(e,yi),o=yI(e,"chartHref"),i=yI(e,Ll),s=_I(e,"room"),a=CI(e,fh);let c=a?a.data:null;if(d_(n)){const r=476===p.featuredContentId;if(!t.hasAuthenticatedUser&&!p.isSearchGrouping&&!r){console.log(`Skipping recommendations shelf with fcID ${n}: No user logged-in`);break}Lh(c)&&(p.recommendationsHref=e.href);if(wI(e,"noPersonalizationAvailable"))break}if(c&&0!==c.length||(c=RI(e,vf)),Mh(o)){const e=function(e,t=host.clientIdentifier){const n=[Cf,xf,Xf];by&&n.push(Jf);let r=new Ry(e).includingAttributes(n).includingMacOSCompatibleIOSAppsWhenSupported(!0);return t===Em?r.addingContext(Eh):t===Cm&&r.addingContext(Zf),by&&(r=r.includingAdditionalPlatforms([Rf,Mf])),r}(new uI(o).param(sw,i).toString());if(Mh(t.topChartIdentifiers)){const n=t.topChartIdentifiers.join(",");e.addingQuery(aw,n)}p.seeAllUrl=OI(e).toString()}else Mh(s)&&(p.seeAllUrl=tb(s.href));p.shouldFilter=r,p.shelfStyle=function(e,t,n){if(418===e||d_(e)){let t=yI(n,cf);return t||(t=311===e||312===e?Ud:Ou),t+"Lockup"}if(431===e)return Pi;if(429===e)return Rl;if(304===e||305===e||430===e||420===e)return xu;if(p_(e))return ch;if(497===e)return cc;switch(t.shelves.length%3){case 0:return ch;case 1:return Of;default:return Pl}}(p.featuredContentId,t,e),f.displayStyle=p.shelfStyle,p_(n)&&(p.showOrdinals=!0,p.shouldFilter=!1),p.clientIdentifierOverride=PP(e),JI(f,p.title),h=r_(c,p,t.adStitcher),ZI(t.metricsLocationTracker),g=!0;break}console.warn(Ti,n)}const y=h&&Mh(h.url);h&&(Mh(h.items)||y)&&(m&&mA(h,f),t.isSearchGrouping&&l_(h,p),Mh(h.url)&&Mh(t.additionalShelfParameters)&&(h.url=uI.from(h.url).append(dp,t.additionalShelfParameters).build()),t.shelves.push(h)),g&&tA(t.metricsLocationTracker)})}function zC(e,t){const n=RI(e,vf);for(const e of n)WC(e,t)}function jC(e){const t=II(e,yd);switch(t){case 425:case 415:case 416:case 417:case 501:case 258:case 421:case 422:case 423:case 261:return Cb(CI(e,vf));case 437:case 265:{const t=CI(e,vf),n=gI(e,If);return Mh(t)?Cb(t):Mh(n)?Cb(e):null}default:if(u_(t)){let t=CI(e,fh);if(Lh(t))return null;const n=t.data;return n&&0!==n.length||(t=CI(e,vf)),Cb(t)}return console.warn(Ti,t),null}}function YC(e){switch(e){case 495:case 496:return fd;default:return bh}}function KC(e,t,n){const r=[],o=[],i=new bS("brick");i.isHorizontal=!0;for(const n of e){const e={targetType:"brick",pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(n)},i=w_(n,t,e);if(!i){o.push(n);continue}const s=new rS;if(i.artwork&&261!==t.featuredContentId){let e=Hh(i.artwork,se);e||(e=Hh(i.artwork,"originalFlowcaseBrick")),s.artwork=h_(e,17)}else s.artwork=m_(n,1060,520,17);s.accessibilityLabel=i.title,s.shortEditorialDescription=i.title,s.clickAction=i.action;435===II(n,yd)&&(s.personalizationStyle="mso");const a=_I(n,fh);if(Nh(a)){const r=NS(a,e);s.flowPreviewActionsConfiguration=CC(n,!0,t.clientIdentifierOverride,s.clickAction,e,r)}mA(s,yA(n,i.title,e)),s.isValid()&&(r.push(s),tA(e.locationTracker))}return Nh(n)&&(i.presentationHints={showSupplementaryText:n}),delete t.maxItemCount,Nh(xh(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[vf].data=o),i.title=t.title,i.subtitle=t.subtitle,i.items=r,g_(i,t),i}function QC(e,t){const n=[];for(const r of e){const e=_I(r,vu);if(Lh(e))continue;const o=S_(e);if(Lh(r.attributes)||Lh(e.attributes)||b_(t)){t.isDeferring=!0,t.remainingItems.push(e);continue}const i={targetType:"listItem",pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(r)},s=Sx(e,{...i,id:o},t.clientIdentifierOverride);mA(s,{...i,kind:Wf,softwareType:null,title:s.title,id:o});const a=mI(e,uh);Mh(a)&&(s.artwork=vx(a,{allowingTransparency:!0,useCase:19})),n.push(s),tA(t.metricsLocationTracker)}Dm===Ch&&I_(n);const r=function(e,t){const n=new bS(hf);let r;switch(Dm){case"tv":n.isHorizontal=!0,r=7;break;case Ch:n.isHorizontal=!1,r=null;break;default:n.isHorizontal=!1,r=6}if(null!==r&&e.length>r){n.items=e.slice(0,r);const o=new Bg(hh);o.title=sg(Tp),qS(o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),n.seeAllAction=o;const i=new bS(hf);i.isHorizontal=!1,I_(e),i.items=e;const s=new wP([i]);s.title=sg("PAGE_TITLE_CATEGORIES"),o.pageData=s}else n.items=e;return n}(n,t);return r.title=t.title,r.subtitle=t.subtitle,g_(r,t),r}function JC(e,t){const n=new bS("editorialCard");n.isHorizontal=!0,t.relationshipDataToFetch=fh;const r=[];for(const n of e){const e={targetType:oc,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(n),id:n.id,idType:"editorial_id"},o=w_(n,t,e,()=>{t.remainingItems.push(n)});if(!o)continue;Mh(o.content)&&(e.adamId=o.content.id);const i=new tS;let s=yI(n,"designBadge");s||(s=o.caption),i.caption=s;let a=yI(n,fd);a||(a=o.title),i.title=a;let c=k_(yI(n,wi));if(c||(c=o.subtitle),i.subtitle=c,o.artwork&&258!==t.featuredContentId){const e=Hh(o.artwork,se);i.artwork=h_(e,18)}else i.artwork=m_(n,416,204,18);i.clickAction=o.action,i.crossLinkLockup=o.crossLinkLockup,i.adamId=Gh(o.content,"id");const l=_I(n,fh);if(Nh(l)){const r=NS(l,e);i.flowPreviewActionsConfiguration=CC(n,!0,t.clientIdentifierOverride,i.clickAction,e,r)}mA(i,yA(n,o.title,e)),i.isValid()&&(r.push(i),tA(t.metricsLocationTracker))}return delete t.maxItemCount,n.items=r,g_(n,t),n}function XC(e,t){if(dI&&dI.isManagedAppleID)return null;if(Dm===Eh){const n=new bS(hf),r=[],o=new Bg(Gf);o.title=sg("ACCOUNT","Account"),o.artwork=ak("systemimage://person.crop.circle");return BS(o,{targetType:wh,id:Gf,pageInformation:e,locationTracker:t}),r.push(o),n.items=r,n}{const e=new bS(ae),t=[],n=sg("FOOTER_REDEEM","Redeem"),r=new Bg(Nf);r.pageUrl=Ii;const o=new lS(n,r);if(t.push(o),Xh.isMonetaryGiftingEnabled){const e=sg("FOOTER_SEND_GIFT","Send Gift"),n=new Bg(Nf);n.pageUrl=ic;const r=new lS(e,n);t.push(r)}const i=Xh.accountTopUpURL;if(i){const e=sg("FOOTER_ADD_MONEY"),n=new Bg(Nf);n.pageUrl=i;const r=new lS(e,n);t.push(r)}const s=new cS(t);return s.compactLineBreaks=s.buttons.map((e,t)=>t),e.items=[s],e}}function ZC(e,t,n,r){let o;if(Kh(Eu)&&t===yp)o=t;else switch(Dm){case Ch:case"tv":o=t;break;case Eh:o=Du;break;default:o=Bd}return wE(e,o,n.title,n.subtitle,r,(function(e){return n.remainingItems.push(e),!1}))}function e_(e,t,n){const r=[];let o=!1;for(const i of e){if(!AI(i)||o){t.remainingItems.push(i),o=!0;continue}const e=vx(mI(i,ce),{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:16});if(Lh(e))continue;const s=yI(i,"editorialNotes.name"),a=yI(i,Df),c=yI(i,le),l=new PS(s,e,a,c),u=DE(i,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},null);Nh(u)&&(l.clickAction=u.clickAction);const d=Ly(e.backgroundColor)?Hf:qd;l.shelfBackground={type:uh,artwork:e,style:d},r.push(l),tA(n.metricsLocationTracker)}const i=new bS(rc);return i.title=t.title,i.items=r,i.background={type:ue},i}function t_(e,t,n,r){const o=new bS(de);o.isHorizontal=!1;const i=Mh(r)&&Fh(r.pageTitleEffect)&&0===r.shelves.length,s=Mh(e)?[e[0]]:[],a=[];for(const e of s){if(Lh(e.attributes)||b_(n)){n.isDeferring=!0,n.remainingItems.push(e);continue}const o=LL(e);if(zD(e)&&!AI(o)){n.isDeferring=!0,n.remainingItems.push(e),n.relationshipDataToFetch=$a;continue}const s={targetType:t?"heroBreakout":"largeBreakout",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:Cb(e)},c=WD(e),l=$D(e);if(Fh(c.video)&&Fh(l.artwork))continue;const u=c.artworkData||l.artworkData,d=c.backgroundColor||l.backgroundColor,p=t?null:yI(e,"breakoutBadge");let f;const h=yI(e,Df);f=uA(e,sc)?lg(xL(o,h)):h;let m={type:kf};Mh(f)&&(m={type:up,title:f});const g=pL(e,bh)||cA(o,bh),y=pL(e,af)||cA(o,cd),T=MD(e,!0,i,!1),w=BD(e,i,!1),I=new TS(g,y,m,null,T,qD(w,e)),A=new wS(I,{position:w||jp},p,l.artwork,c.video,d),S=yA(e,A.details.title,s),b=uA(ZE(e),ih);S.isPreorder=b,mA(A,S),JI(S,A.details.title);const P=jD(e),k={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:Cb(e),targetType:wh,id:e.id};BS(P,k),A.details.callToActionButtonAction=P,A.clickAction=P,ZI(s.locationTracker),A.flowPreviewActionsConfiguration=CC(e,!0,n.clientIdentifierOverride,P,s,k),a.push(A),i&&(r.pageTitleEffect=P_(u))}return o.items=a,g_(o,n),tA(n.metricsLocationTracker),o}function n_(e,t){if(wI(e,"hide"))return null;const n=[],r=new bS(hf);r.isHorizontal=!1;const o=RI(e,vf),i=Mh(o),s=gI(e,If);let a=[];i?a=o:Mh(s)&&(a=s);for(let e=0;e<a.length;e++){const r=a[e];if(Lh(r))continue;const o={targetType:Wf,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker};i&&(o.recoMetricsData=Cb(r));let s=null;if(t.isSearchGrouping){const n=A_(r,t.metricsLocationTracker);mA(n.action,{...o,kind:Wf,softwareType:null,title:n.action.title,id:""+e,idType:oh}),s=n}else{const e=w_(r,t,o);if(Fh(e)||Fh(e.action.title))continue;s=e.action;const n=S_(r);n&&mA(s,{...o,kind:Wf,softwareType:null,title:s.title,id:n})}Fh(s)||(n.push(s),tA(t.metricsLocationTracker))}return r.items=n,r.title=t.title,r.subtitle=t.subtitle,r.presentationHints={isWidthConstrained:!0},g_(r,t),Fh(r.items)?null:r}function r_(e,t,n,r){let o=[];const i=new bS(t.shelfStyle);if(i.isHorizontal=!0,Mh(e)){const i=function(e,t,n,r){const o=function(e,t){if(Lh(e))return null;const n=e.tasks[t];return Lh(n)?null:(delete e.tasks[t],n)}(e,n);if(Lh(o))return null;const i=o.data,s=o_(i,r);Nh(s)?r.includedAdAdamIds=[i.id]:function(e,t){var n,r;const o=xC(t);HC(e,new VC(o,zn)),null===(r=null===(n=e)||void 0===n?void 0:n.iAdInfo)||void 0===r||r.setMissedOpportunity("METADATA")}(t,i);return s}(n,r,pe,t);i&&(o.push(i),tA(t.metricsLocationTracker),t.ordinalIndex++,e=e.filter(e=>e.id!==i.adamId))}for(const n of e){if(Lh(n.attributes)||b_(t)){t.isDeferring=!0,t.remainingItems.push(n);continue}if(vS(n))continue;const e=o_(n,t);e&&(o.push(e),tA(t.metricsLocationTracker),t.ordinalIndex++)}let s;if(p_(t.featuredContentId)&&(o=BC(o,3)),delete t.maxItemCount,p_(t.featuredContentId))s=new Bg(ac);else{s=new Bg(hh);const e=function(e){if(!e)return null;switch(e){case Lu:case Pi:return e;default:return null}}(t.shelfStyle);s.pageData=CP.seeAllPage(t.title,e)}s.pageUrl=t.seeAllUrl,s.title=sg(Tp),s.referrerUrl=t.metricsPageInformation.pageUrl,qS(s,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker});if(function(e,t,n){if(function(e){switch(e){case 530:case 531:case 532:case 533:return!0;default:return!1}}(t.featuredContentId))return!1;if("tv"===n){if(Mh(t.remainingItems))return!1;return!!(p_(t.featuredContentId)&&Mh(e))}return 497!==t.featuredContentId}(o,t,Dm)&&(i.seeAllAction=s),i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.titleArtwork=t.titleArtwork,i.subtitle=t.subtitle,i.items=o,i.shouldFilterApps=t.shouldFilter,g_(i,t),t.shelfStyle===Rl||t.shelfStyle===xu){const e=!wI(t.featuredContentData,"suppressTagline");Lh(i.presentationHints)?i.presentationHints={showSupplementaryText:e}:i.presentationHints={...i.presentationHints,showSupplementaryText:e}}return t.shelfStyle===cc&&Dm===Ch&&i.items.length<3&&(Lh(i.presentationHints)?i.presentationHints={isLowDensity:!0}:i.presentationHints={...i.presentationHints,isLowDensity:!0}),i}function o_(e,t){if(Fh(e))return null;let n;t.showOrdinals&&(n=ug(t.ordinalIndex));let r,o=null;!Nh(t.shelfBackground)||t.shelfBackground.type!==gp&&t.shelfBackground.type!==ue||(o=Qf),Mh(t)&&(r=t.clientIdentifierOverride);const i={ordinal:n,metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(e),isAdvert:FC(e)},clientIdentifierOverride:r,artworkUseCase:Ox(t.shelfStyle),offerStyle:o,canDisplayArcadeOfferButton:DL(t.shelfStyle),isContainedInPreorderExclusiveShelf:497===t.featuredContentId};let s;var a,c,l;return t.shelfStyle===xu?(a=e,c=i,l=_S,s=Oh.context("trailersLockupFromData",()=>{const e=new KA;return function(e,t,n,r){e&&Oh.context("copyDataIntoTrailersLockup",()=>{rx(e,t,r),t.trailers=Nx(e,n,r.metricsOptions,t.adamId)})}(a,e,l,c),e})):s=t.shelfStyle===Rl?gx(e,i):t.shelfStyle===cc?function(e,t){return Oh.context("posterLockupFromData",()=>{const n=new kS;return function(e,t,n){if(!e)return;Oh.context("copyDataIntoPosterLockup",()=>{rx(e,t,n),t.epicHeading=function(e){const t=sA(e,"editorialArtwork.epicHeading");if(Nh(t)&&Nh("bb"))return vx(t,{cropCode:"bb",useCase:0});return null}(e),t.posterArtwork=function(e){const t=sA(e,"editorialArtwork.postCard");if(Nh(t))return vx(t,{cropCode:"sr",useCase:0,withJoeColorPlaceholder:!0});return null}(e),t.posterVideo=function(e,t){const n=sA(e,[sh,Bt]),r=sA(e,[sh,Bt,dd]),o=vx(r,{useCase:t,withJoeColorPlaceholder:!0,cropCode:"sr"});if(Nh(n)){const e=Gh(n,lf);if(Lh(e))return null;return new BA(e,o,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,showPlaybackControls:!1,playbackControls:RS,autoPlayPlaybackControls:RS})}return null}(e,18),t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Qf,"lightOverArtwork")),t.posterVideo?t.isDark=Ly(t.posterVideo.preview.backgroundColor):t.posterArtwork?t.isDark=Ly(t.posterArtwork.backgroundColor):t.isDark=!1;const r=uA(e,Ja),o=uA(e,ih);r&&o&&(t.footerText=lg(xL(e,sg(Bi))))})}(e,n,t),n})}(e,i):fx(e,i),s.isValid()?s:null}function i_(e,t){t.isFirstRender=!1,t.isDeferring=!1,t.remainingItems=[];let n=new bS(Of);const r=t.featuredContentId;switch(r){case 415:case 416:case 417:case 501:case 258:n=JC(e.data,t);break;case 425:{const r=_I(t.featuredContentData,vf);if(r){n=QC(T_(e.data,RI(r,vf)),t)}break}case 421:case 422:case 423:case 261:n=KC(T_(e.data,RI(t.featuredContentData,vf)),t);break;case 437:case 265:n=n_(t.featuredContentData,t);break;case 475:{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation};n=t.shelfStyle===rc?e_(e.data,t,r):ZC(e.data,t.shelfStyle,t,r);break}case 480:switch(yI(t.featuredContentData,cf)){case Ou:n=a_(e.data,t);break;case oc:n=t_(e.data,!0,t,null);break;case Ud:n=t_(e.data,!1,t,null)}break;default:if(u_(r)){n=r_(e.data,t);break}console.warn(Ti,t.featuredContentId)}if(t.remainingItems.length){const e=t.remainingItems.map(e=>e.id);console.warn("Could not load items for: "+e.join(","))}return n&&(n.mergeWhenFetched=function(e){if(e.shelfStyle===cc&&Dm===Ch)return!1;return!0}(t),n.networkTimingMetrics=e[My.timingValues]),t.hasExistingContent||0!==n.items.length||(n.isHidden=!0),t.isSearchGrouping&&l_(n,t),n}function s_(e,t){const n=bb(e);Fh(t.title)&&(t.title=yI(n,bh));const r=function(e){const t=iA(e);return t?t.location:null}(t.metricsLocationTracker);r&&r.fcKind===t.featuredContentId&&ZI(t.metricsLocationTracker);const o={id:t.id,kind:null,softwareType:null,targetType:ah,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sp,fcKind:t.featuredContentId,recoMetricsData:jC(n),displayStyle:t.shelfStyle};JI(o,t.title);const i=i_(CI(n,fh),t);return ZI(t.metricsLocationTracker),mA(i,o),i}function a_(e,t){const n=new bS(fe);n.isHorizontal=!1;const r=[];for(const n of e){if(Lh(n.attributes)||b_(t)){t.isDeferring=!0,t.remainingItems.push(n);continue}const e=LL(n);if(zD(n)&&!AI(e)){t.isDeferring=!0,t.remainingItems.push(n),t.relationshipDataToFetch=$a;continue}const o={targetType:fe,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(n)};let i;const s=yI(n,Df);i=uA(n,sc)?lg(xL(e,s)):s;let a={type:kf};Mh(i)&&(a={type:up,title:i});const c=pL(n,bh)||cA(e,bh),l=pL(n,af)||cA(e,cd),u=Lx(e,{useCase:5,withJoeColorPlaceholder:!0}),d=xy(Gh(PI(e,pA(n),uh),"textColor4"))||u.backgroundColor,p=new TS(c,l,a,null,UD(d),null),f=new IS(p,u,d),h=yA(n,f.details.title,o),m=uA(ZE(n),ih);h.isPreorder=m,mA(f,h),JI(h,f.details.title);const g=jD(n),y={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(n),targetType:wh,id:n.id};BS(g,y),f.details.callToActionButtonAction=g,f.clickAction=g,ZI(o.locationTracker),f.flowPreviewActionsConfiguration=CC(n,!0,t.clientIdentifierOverride,g,o,y),r.push(f)}return n.items=r,g_(n,t),tA(t.metricsLocationTracker),n}function c_(e,t=!0){const n=new Vg(e),r=sg(he),o=new $A(r);o.clickAction=n,o.presentationStyle=[Ai,Si],t&&o.presentationStyle.push(bi);const i=new bS("footnote");if(i.items=[o],Xh.emailSupportLinkURL){const e=new Vg(Xh.emailSupportLinkURL),n=new $A("Email Support");n.clickAction=e,n.presentationStyle=[Ai,Si],t&&n.presentationStyle.push(bi),i.items.push(n)}return i}function l_(e,t){e.seeAllAction=null,e.isHorizontal=!1,e.shouldFilterApps&&(e.filteredItemsMinimumCount=0,e.filteringExcludedItems=t.includedAdAdamIds)}function u_(e){return p_(e)||d_(e)||418===e||431===e||429===e||430===e||420===e||304===e||305===e||260===e||497===e}function d_(e){return 311===e||312===e||476===e}function p_(e){switch(e){case 117:case 122:case 118:case 195:case 194:case 197:case 369:case 370:case 371:case 372:case 373:case 374:case 375:case 376:case 377:case 378:case 379:case 380:case 395:case 396:case 397:case 398:case 399:case 400:case 491:case 492:case 493:case 504:case 505:case 506:case 530:case 531:case 532:case 533:return!0;default:return!1}}function f_(e){switch(e){case 504:case 505:case 506:return!0;default:return!1}}function h_(e,t){const n=vx(e,{useCase:t});return n&&(n.crop="sr"),n}function m_(e,t,n,r){const o=mI(e,uh);if(o instanceof Array){const e=function(e,t,n){const r=t/n;let o=0,i=null;for(const n of e){const e=Vh(n,Rc),s=e/Vh(n,Oc);(s===r||Math.abs(r-s)<=Math.abs(r-o))&&(!i||e<=t&&e>i.width||i.width>t&&e<i.width&&e>i.width)&&(i=n,o=s)}if(i){return ak(Gh(i,Sh),Vh(i,Rc),Vh(i,Oc),null,Gh(i,ds))}return null}(o,t,n);return e.crop="bb",e}return null!=o?h_(o,r):null}function g_(e,t){t.hasExistingContent=t.hasExistingContent||Mh(e.items)&&t.isFirstRender,(t.remainingItems.length||t.recommendationsHref)&&t.isFirstRender&&(e.url=y_(t))}function y_(e){return`${Gy.internal}:/${Yy}/${Vy}/`+encodeURIComponent(JSON.stringify(e))}function T_(e,t){const n={};for(const t of e)n[t.id]=t;const r=[fh,vu],o=[];for(const e of t){let t=!0;for(const o of r){const r=RI(e,o);if(Nh(r)){const i=[];for(const e of r){const t=n[e.id];Mh(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function w_(e,t,n,r){var o;const i=Mh(Gh(e,Sh)),s=Mh(yI(e,"link.url")),a=EI(e,fh,!1);if(s||i)return function(e,t,n,r){const o=Nh(Gh(e,Sh))?e:mI(e,Wf);if(Lh(o)||b_(t))return i=e,r?r():t.remainingItems.push(i),null;var i;const s=Gh(o,Wa),a=Gh(o,Sh),c=Gh(o,Df),l=k_(yI(e,wi))||c;let u=null;if(s===li)u=new Vg(a),u.title=l;else{const e=xD(a),t=new Bg(e);t.pageUrl=a,t.title=l,u=t}u.presentationStyle=[Ei];const d={...n,id:""};return BS(u,d),{action:u,caption:null,title:l,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,r);if(a){const i=_I(e,fh);if(Lh(i))return null;if(Lh(i.attributes)||b_(t))return t.isDeferring=!0,function(e){r?r():t.remainingItems.push(e)}(i),null;let s=dL(i,cd)||ax(i);const a=Sx(i,NS(e,n),t.clientIdentifierOverride);let c=null,l=null,u=null;const d=yI(i,"itunesNotes.short");switch(i.type){case Af:c=mI(i,uh);break;case rh:{l=yI(i,Df),l&&(l=l.replace(/\n/g," "));const e=_I(i,fh),t=Gh(i,"editorialNotes.tagline");t?s=t:e&&(s=dL(e,af));let r=yI(i,le);if(Mh(r)||(r=s),Dk(i)){const e={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};e.crossLinkSubtitle=r;const t=qE(i,e,{pageInformation:n.pageInformation,locationTracker:n.locationTracker},!0,Hf,Qf);t.length>0&&(u=t[0])}}default:c=sA(i,lh)||mI(i,lh)}if(Nh(a)){a.presentationStyle=[Ei];const t=k_(yI(e,wi)),n=dL(i,bh);a.title=t||n||a.title||s||l}return{action:a,caption:l,title:null===(o=a)||void 0===o?void 0:o.title,subtitle:s,artwork:c,shortEditorialDescription:d,content:i,crossLinkLockup:u}}return null}function I_(e){e.sort((e,t)=>{try{return e.title.localeCompare(t.title,og,{usage:uf})}catch(e){return 0}})}function A_(e,t){const n=Gh(e,Df);if(Fh(n))return null;const r=new Nb(n,n,null,Ci);return VS(r,wh,t),tA(t),new uy(r)}function S_(e){let t=yI(e,Pf);return t||(t=yI(e,"contentId")),t||(t=yI(e,"id")),t}function b_(e){return e.isDeferring&&e.isFirstRender}function P_(e,t=!1){if(Fh(e))return null;let n=null;const r=Fy(Qf),o=Fy("black"),i=xy(Gh(e,_i)),s=Bh(e,me).map(e=>xy(e)),a=UD(i);if(2===s.length){n=new Tm("horizontalGradient");const e=s[0],r=s[1];n.gradientStartColor=Ny(e,e),n.gradientEndColor=Ny(r,r),n.filter="plusLight",t||(n.accessoryColor=n.gradientEndColor)}else n=new Tm(gp),n.color=a===Hf?r:o,t||(n.accessoryColor=n.color),n.isFallbackStyle=!0;return"tv"===Dm&&(n.accessoryColor=r),n}function k_(e){if(Lh(e))return null;const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"");return t.match(/^\s*$/)?null:t}function E_(e){e.includingAdditionalPlatforms(Ey()).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0);let t=[lh,sh,Xf];e.resourceType===Ah&&(t=[lh,Xf,Gp,wp,Vp]),e.includingAttributes(t)}class C_ extends yb{constructor(){super("ArcadePageBuilder")}static get comingSoonGroupingID(){return Dm===Ch?"177564":"175443"}defaultPlatforms(){return Ey()}defaultAttributes(){const e=[lh,Cf,xf,gi];return by&&e.push(Jf),e}pageType(){return Th}get pageRoute(){return[{protocol:Gy.https,path:`/${Hy}/${Yy}`,query:[pw,hw+"?",fw+"?",KT]},{hostName:BT,path:"/WebObjects/{storePreviewInstance}/wa/"+Yy,query:[pw,hw+"?",fw+"?",KT,Rw+"?"]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[pw,hw+"?",fw+"?"]},{protocol:Gy.https,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[pw,hw+"?",fw+"?"]},{protocol:Gy.https,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[pw,hw+"?",fw+"?"]}]}get shelfRoute(){return[{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`,query:[pw,hw+"?",fw+"?"]},{protocol:Gy.internal,path:`/${Xy}/${Vy}/{token}`,query:[mw]}]}generatePageRequest(e,t){let n=null;n=Xh.isArcadeComingSoonEnabled?C_.comingSoonGroupingID:t[KT];const r=Wh(t[fw]);if(!Uh(n))throw new Error(`Unable to map ${e.build()} to a media api url`);const o=[lh,sh,Cf,xf,Vp,sc];by&&o.push(Jf);let i=(new Ry).forType(Af).includingAttributes(o).includingMacOSCompatibleIOSAppsWhenSupported();const s=_y();Nh(s)&&i.addingQuery(tp,s);const a=Dm===Ch;Xh.isArcadeComingSoonEnabled?a||i.addingQuery(qp,Et):r?i.addingQuery(qp,Et):(i.addingQuery(qp,"nonsubscriber"),i.includingRelationshipsForUpsell(!1)),i.withIds([n]);const c=e.query[Rw];return e.host===BT&&Mh(c)&&(i=i.addingQuery(Ri,c),i.isStorePreviewRequest=!0),i.attributingTo(e.build())}generateAdditionalPageRequirements(e,t){const n=super.generateAdditionalPageRequirements(e,t);if(Xh.isArcadeComingSoonEnabled){const e=(new Ry).forType(rh).withIds(["1469266318"]);return n[C_.comingSoonEIRequirementKey]=jS(e).catch(()=>null),n}if(C_.footerShowsIconsForPlatform(host.platform)&&!Xh.isArcadeComingSoonEnabled&&!Kh(Ct)){const e=ek(this.numberOfIconsForArcadeAppGrid(Dm));n[C_.footerIconsRequirementsKey]=jS(e).catch(()=>null)}return n}renderPage(e,t,n,r){return Oh.context(Kp,()=>{const o=bb(e);if(Fh(o))return null;const i=CI(o,qp),s=yI(o,"id");if(Fh(i))return null;const a=Wh(t[fw]),c=Wh(t[hw]),l="tv"===Dm,u=Dm===Ch,d={};d[pw]="true",d[fw]=""+a,d[hw]=""+c;const p={shelves:[],metricsPageInformation:aP(pc,o.id,e),metricsLocationTracker:{rootPosition:0,locationStack:[]},groupingData:i,pageGenreAdamId:s,pageGenreId:null,hasAuthenticatedUser:Nh(dI.dsid),additionalShelfParameters:d,isArcadePage:!0};let f=null,h=null;if(Xh.isArcadeComingSoonEnabled){f=bb(n[C_.comingSoonEIRequirementKey]),h=YD(f,p)}else if(!a){const e=rk(o);if(e)f=e.marketingItemData;else if(r){Oh.unexpectedNull(Uu,"nonnull","relationships.upsell");const e=ok(r.get(ss));e&&(f=e.marketingItemData)}h=YD(f,p)}const m=C_.insertShelfForUpsellBreakoutIfNecessary(h,a,p);WC(o,p);const g=new SP(p.shelves);lP(g,p.metricsPageInformation),g.tabTitle=yI(o,bh);const y=host.clientIdentifier===_m;(a&&!l||y||!m)&&(g.title=yI(o,bh));const T=new Tm(gp);T.color=Fy("primaryText"),T.isFallbackStyle=!0,g.titleEffect=p.pageTitleEffect||T,g.presentationOptions=u?[ge]:[];let w=!1;if(p.shelves.length>0){const e=p.shelves[0].contentType===de,t=p.shelves[0].contentType===Mu;w=e||t}if(w&&g.presentationOptions.push("prefersOverlayedPageHeader"),!a&&Mh(h)){g.subscriptionOfferAction=C_.createSubscribeAction(h,{id:null,pageInformation:p.metricsPageInformation,locationTracker:p.metricsLocationTracker,targetType:wh}),g.subscriptionOfferDisplayProperties=new nm(Th,Xh.arcadeAppAdamId,Np,null,Th,null,null,null,null,null,null,null,null,null,null,null,null,Xh.arcadeProductFamilyId),g.subscriptionOfferTitle=h.details.title,g.subscriptionOfferSubtitle=h.buttonCallToAction||h.details.description;const e={pageInformation:p.metricsPageInformation,locationTracker:p.metricsLocationTracker},t={marketingItemData:f};g.subscriptionLockup=wx(t,e,zl,Np,Dm===Ch?Th:"navigationBar")}if(!Xh.isArcadeComingSoonEnabled){const e={featuredContentId:null,featuredContentData:null,metricsPageInformation:p.metricsPageInformation,metricsLocationTracker:p.metricsLocationTracker,pageGenreId:p.pageGenreId,id:"arcade-see-all-games-footer",title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,ordinalIndex:1,isSearchGrouping:p.isSearchGrouping,isArcadePage:p.isArcadePage};if(Kh(Ct)){if(g.shelves.push(this.createFooterShelf(null,!0,e)),Dm===Ch||"tv"===Dm){const e=this.createTermsAndConditionsShelf();Nh(e)&&g.shelves.push(e)}}else this.addFooterToPage(g,n[C_.footerIconsRequirementsKey],e);if(0===g.shelves.length)throw new Error("Missing content for Arcade grouping "+JSON.stringify(t))}return g.autoUpsellAction=QP(Mp,null,null),g})}static insertShelfForUpsellBreakoutIfNecessary(e,t,n){return Oh.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(Fh(e))return t||Oh.unexpectedNull(Uf,"nonnull",Mu),!1;const r=new bS(Mu);return r.isHorizontal=!0,r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t){if(Fh(e))return null;if(Xh.isArcadeComingSoonEnabled)return e.offerButtonAction;if(Dm===Ch)return e.offerButtonAction;{const n=QP(as,null,null,t);return n.title=e.offerButtonAction.title,n}}static footerShowsIconsForPlatform(e){switch(e){case Yf:case Ef:return!0;default:return!1}}createFooterShelf(e,t,n){const r=new ym,o=new bS("arcadeFooter");o.items=[r];const i={targetType:"arcadeSeeAllGamesFooter",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:sg(nt),id:n.id,kind:"footer",softwareType:null};mA(r,i),JI(i,i.title),r.buttonAction=KP(Ap,n.metricsPageInformation,n.metricsLocationTracker);const s={targetType:wh,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:r.buttonAction.title,id:rt,kind:wh,softwareType:null};mA(r.buttonAction,s),ZI(i.locationTracker);const a=Dm===kh||Dm===Ph,c=Xh.termsAndConditionsURL,l=!Lh(c)&&"tv"!==Dm;if(a){if(l){const e=sg(he),t=new Vg(c),n=new $A(e);n.clickAction=t,n.presentationStyle=[Ai,Si,bi],r.footnote=n}o.background={type:gp,color:Fy(_t)}}if(Nh(e)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},o=Eb(e);if(Kh("seeAllGamesFooterArtworkImpressions"))r.icons=xx(o,t,{useCase:2});else{const e=[];for(const t of o)e.push(Lx(t,{useCase:2}));r.icons=e}}else r.icons=[];return t&&(o.url=`${Gy.internal}:/${Xy}/${Vy}/${encodeURIComponent(JSON.stringify(n))}?${mw}=true`),o}createTermsAndConditionsShelf(){const e=Xh.termsAndConditionsURL,t=!Lh(e)&&"tv"!==Dm;return(Dm===Ch||"tv"===Dm)&&t?c_(e,!1):null}addFooterToPage(e,t,n){const r=[],o=C_.footerShowsIconsForPlatform(host.platform);r.push(this.createFooterShelf(o?t:null,!1,n));if(Dm===Ch||"tv"===Dm){const e=this.createTermsAndConditionsShelf();Nh(e)&&r.push(e)}return r}generateShelfRequest(e,t){return t[mw]?this.generateSeeAllGamesShelfRequest():this.generateStandardShelfRequest(e,t)}generateSeeAllGamesShelfRequest(){return ek(this.numberOfIconsForArcadeAppGrid(Dm))}generateStandardShelfRequest(e,t){const n=t[Kf],r=JSON.parse(n),o=Mh(r.remainingItems),i=Mh(r.recommendationsHref);let s=[],a=[lh,sh,Xf,Gp,wp,Vp];if(Kh(it)||Dm!==Ph||(s=s.concat([Lf]),a=a.concat([cs,ls,us])),o){let e=r.remainingItems;Mh(r.relationshipDataToFetch)&&(e=r.remainingItems.map(e=>_I(e,r.relationshipDataToFetch)));let t=[lh,sh,Xf,Vp],n=[];const o=new Ry(e);return o.resourceType===Ah&&(t=a,n=s),o.includingAdditionalPlatforms(Ey()).includingAttributes(t).includingRelationships(n)}if(i){let e=[lh,sh,Xf,Vp],t=[];const n=new Ry(r.recommendationsHref);return n.resourceType===Ah&&(e=a,t=s),n.includingAdditionalPlatforms(Ey()).includingAttributes(e).includingRelationships(t)}return null}renderShelf(e,t){if(t[mw]){const n=t[Kf],r=JSON.parse(n);return this.renderSeeAllGamesShelf(e,r)}return this.renderStandardShelf(e,t)}handleShelfError(e,t,n,r){const o=r[Kf],i=JSON.parse(o);if(i&&!i.hasExistingContent){const e=new bS(i.shelfStyle);e.isHidden=!0,t(e)}else super.handleShelfError(e,t,n,r)}renderSeeAllGamesShelf(e,t){return this.createFooterShelf(e,!1,t)}renderStandardShelf(e,t){const n=t[Kf],r=JSON.parse(n),o=Mh(r.remainingItems),i=Mh(r.recommendationsHref);if(o){let t=e;if(Mh(r.relationshipDataToFetch)){const n={};for(const t of e.data)n[t.id]=t;t={data:[]};for(const e of r.remainingItems){const o=_I(e,r.relationshipDataToFetch);Mh(o)&&(e.relationships[r.relationshipDataToFetch].data=[n[o.id]]),t.data.push(e)}}return i_(t,r)}if(i){const t=bb(e);Fh(r.title)&&(r.title=yI(t,bh));return i_(CI(t,fh),r)}return null}numberOfIconsForArcadeAppGrid(e){switch(e){case kh:return 9;default:return 20}}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t){if(Lh(t))return null;const n=bb(e),r=Wh(t.parameters[fw]),o=rk(n);return!r&&Lh(o)?new Set([ss]):null}fetchAdditionalDataForKey(e){return Oh.context("fetchAdditionalDataForKey",()=>{let t;return e===ss&&(t=tk(zl),Oh.unexpectedNull(Uf,gf,"upsellRecovery.marketingItem")),Lh(t)?null:jS(t).catch(()=>null)})}}C_.footerIconsRequirementsKey="footerIconsRequirements",C_.comingSoonEIRequirementKey="comingSoonEIRequirementKey";const __=[{identifier:Sp,protocol:Gy.internal,path:`/${Zy}/${eT}`}];function R_(e,t){return ZP(!0).includingAdditionalPlatforms(Ey()).attributingTo(e.build())}function O_(e,t,n){return Oh.context(Kp,()=>{const t=$h(e),n={rootPosition:0,locationStack:[]},r=aP(Gd,Sp,t),o=function(e,t=null,n,r){const o=Sb([],uI.fromComponents(Gy.internal,null,`/${Zy}/${eT}`).build(),null,n,r);return o.maxPerPage=20,o}(0,null,r,n),i=Eb(t).sort(M_);if(Fh(i))return null;const s=Dm===kh||Dm===Ph,a={};a.default=s?xu:Yd,a.compact=ch;const c=new bP(x_(i,o,(function(e){o.remainingContent.push(e)})),a);return Mh(o.remainingContent)&&(c.nextPage=o),c.title=sg(Ki),lP(c,r),c})}function v_(e,t,n){return new Ry(Tb(n))}function D_(e,t){const n=wb(t),r=new bP(x_(Pb(e),n));return Mh(n.remainingContent)&&(r.nextPage=n),r}function x_(e,t,n){const r=[];let o=null,i=null,s=!1;for(const a of e){if(F_(a,s)){Lh(n)||n(a),s=!0;continue}const e={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:Cb(a)},artworkUseCase:1,canDisplayArcadeOfferButton:DL(Yd)},c=TI(a,ih);if(!Kh(Xa)&&uL(a)&&c)continue;const l=yx(a,e,_S);let u=!0;if(!Mh(l.trailers)){u=!1;const e=rL(a);if(Mh(e)){const t=new QA;e.playbackControls=ES,e.autoPlayPlaybackControls=CS,e.canPlayFullScreen=!0,t.videos=[e],l.trailers=[t],u=!0}}l.editorialTagline=null,l.developerTagline=null,u||N_(l);const d=L_(a),p=Lh(o)||i!==d;if(Lh(o)||p){0!==t.metricsLocationTracker.locationStack.length&&(ZI(t.metricsLocationTracker),tA(t.metricsLocationTracker)),o=new bS(Yd),o.title=d,i=d,o.presentationHints={showSupplementaryText:!1};const e={id:""+r.length,kind:null,softwareType:null,targetType:ah,title:d,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:oh};mA(o,e),JI(e,d),r.push(o)}o.items.push(l),tA(e.metricsOptions.locationTracker)}return r}function L_(e){const t=LS(kI(e,pA(e),Ap));if(new Date<t)return sg(Ac);if(Kh("allGamesDaySentenceFormatting")){return mg(sg(Ji),Wl,t)}if(Kh("allGamesSentenceFormatting")){return mg(sg(Ji),Wl,t)}{const e=hg(Wl,t);return sg("ALL_GAMES_SECTION_TITLE_RELEASE_DATE").replace(at,e)}}function F_(e,t){return!AI(e)||t}function N_(e){const t=e.screenshots[0].artwork[0],n=new BA("x-as3-internal:/today/test",t,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,showPlaybackControls:!1,autoPlayPlaybackControls:{},playbackControls:{}}),r=new QA;r.videos=[n],e.trailers=[r]}function M_(e,t){const n=kI(e,pA(e),Ap),r=kI(t,pA(t),Ap),o=yI(e,bh),i=yI(t,bh);if(n===r){if(o===i)return 0;if(Nh(o)&&Nh(i)){return o.toLowerCase()<i.toLowerCase()?-1:1}return Lh(o)?1:-1}return LS(n)>LS(r)?-1:1}class U_ extends Zh{constructor(e,t,n=null){super(),this.title=e,this.value=t,this.metricsValue=n}}U_.defaultValue="pageFacetsDefaultValue",U_.trueValue=new U_(Fp,al),U_.falseValue=new U_(al,al);class B_ extends Zh{constructor(e,t,n,r=null,o=[],i=null,s=null,a=null,c=!1,l=!1){super(),this.parameterName=e,this.title=t,this.displayType=n,this.defaultOptions=i,this.defaultOptionTitle=r,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l}}class q_ extends Zh{constructor(e=[],t=null){super(),this.title=t,this.facets=e}}class G_ extends Zh{constructor(e,t,n){super(),this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return typeof e!==yh&&null!==e&&0!==Object.keys(e).length}}G_.requestValuesForSelectedFacetOptions=function(e){if(G_.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>G_.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={};for(const e of r){const t=e.split("=");2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null};const V_=new U_(sg("PAGE_FACETS_SORTS_RELEASE_DATE"),"-releaseDateByDay&sort=name",Ap),H_=new U_(sg("PAGE_FACETS_SORTS_LAST_UPDATED"),"-lastUpdatedByDay&sort=name","lastUpdated"),$_=new U_(sg("PAGE_FACETS_SORTS_NAME"),"alphabet&sort=name",bh),W_=new U_(sg("PAGE_FACETS_SORTS_CATEGORY"),"category&sort=-releaseDate",$l),z_=new U_(sg("PAGE_FACETS_DEFAULT_ALL"),null),j_=new U_(sg("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),Y_=new U_(sg("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),K_=new U_(sg("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),Q_=new U_(sg(ct),Fp),J_=new U_(sg(lt),Fp),X_=new U_(sg(ut),Fp),Z_={};Z_[Nw]={releaseDate:[V_],lastUpdated:[H_],name:[$_],category:[W_]},Z_[Hw]={"4plus":[j_],"9plus":[Y_],"12plus":[K_]},Z_[$w]={true:[Q_],false:[]},Z_[Ww]={true:[J_],false:[]},Z_[zw]={true:[X_],false:[]};const eR={};function tR(e={}){const t={"filter[ageRating]":[z_]};t.groupBy=[V_],t.with=[X_];const n=[Nw,Hw,$w,Ww,zw];for(const r of n){const n=e[r];if(Fh(n))continue;const o=Z_[r][n],i=eR[r];Nh(o)&&Mh(i)&&(t[""+i]=o)}return t}function nR(e){const t=new ly;return GS(t,e),t}eR[Nw]="groupBy",eR[Hw]=dt,eR[$w]=pt,eR[Ww]=ft,eR[zw]="with";function rR(){const e=[lh,sh,Cf,xf,wp,Gp];return by&&e.push(Jf),e}const oR=[{protocol:Gy.internal,path:`/${Zy}/${Vy}/`,query:[""+qw]}],iR=[{identifier:Sp,protocol:Gy.internal,path:`/${Zy}/${eT}`}];function sR(e,t){return Oh.context("generatePageRequest",()=>{const e=hR(t);let n=[];Kh(it)||Dm!==Ph||(n=n.concat([Lf]));let r=ZP().includingAdditionalPlatforms(Ey()).includingRelationships(n).withSparseLimit(10).includingAttributes(rR());const o=Mh(e.selectedFacetOptions)?e.selectedFacetOptions:tR();let i=!1;for(const e of Object.keys(o))if("with"===e&&Mh(o[e])){const t=o.groupBy;if(Mh(t))switch(t[0].value){case"-releaseDateByDay&sort=name":case"-lastUpdatedByDay&sort=name":o[e][0].value="comingSoonGrouping";break;case"alphabet&sort=name":o[e][0].value="comingSoonApps";break;case"category&sort=-releaseDate":o[e][0].value="comingSoonApps",i=!0}}i&&(r=r.withSparseCount(4));for(const e of Object.keys(o)){const t=G_.requestValuesForSelectedFacetOptions(o[e]);if(Mh(t)){Mh(t.value)&&r.addingQuery(e,t.value);for(const e of Object.keys(t.additionalKeyValuePairs))r.addingQuery(e,t.additionalKeyValuePairs[e])}}return r})}function aR(e,t,n){return Oh.context(Kp,()=>{const n=$h(e),r=hR(t),o={rootPosition:0,locationStack:[]},i=aP(Gd,Sp,n),s={url:uI.fromComponents(Gy.internal,null,`/${Zy}/${eT}`).build(),metricsPageInformation:i,metricsLocationTracker:o,remainingGroups:[],lastShelfIndex:0,isCompactMode:r.isCompactMode},a=new bP(pR(Bh(n,"results.groups"),s));a.title=sg(Ki),a.pageFacets=function(){const e=sg(Dm===Ch?"PAGE_FACETS_AGE_RATINGS_TITLE":"PAGE_FACETS_FILTERS_AGE_RATINGS"),t=new B_(dt,e,Sd,null,[z_,j_,Y_,K_],[z_],"age",nR(uf)),n=new B_("groupBy",sg(ht),Sd,null,[V_,H_,$_,W_],null,uf,nR(uf)),r=sg(Dm===Ch?"PAGE_FACETS_FILTERS_CONTROLLERS":ct),o=new B_(pt,r,Xi,null,[Q_],null,mt,nR("controllerSupportFacetOption")),i=sg(Dm===Ch?lt:"PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),s=new B_(ft,i,Xi,null,[J_],null,gt,nR("multiplayerSupportFacetOption")),a=new B_("with",sg(ut),Xi,null,[X_],[X_],Zi,nR(Zi)),c=new G_([],!1,null);switch(Dm){case Ch:c.facetGroups.push(new q_([t])),Xh.enableComingSoonToggle&&c.facetGroups.push(new q_([a],sg(yt))),c.facetGroups.push(new q_([o,s],sg("PAGE_FACETS_SUPPORTS_TITLE"))),c.facetGroups.push(new q_([n]));break;case"tv":c.facetGroups.push(new q_([t],sg("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")));const e=[o,s];Xh.enableComingSoonToggle&&e.push(a),c.facetGroups.push(new q_(e,sg("PAGE_FACETS_FILTERS_TITLE"))),c.facetGroups.push(new q_([n],sg("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")));break;default:n.displayOptionsInline=!0,c.facetGroups.push(new q_([n],sg(ht))),t.showsSelectedOptions=!0;const r="PAGE_FACETS_FILTER_BY_TITLE",i="PAGE_FACETS_FILTER_BY_TITLE_WITH_COLON";let l=sg(r);l===r&&(l=sg(i)),c.facetGroups.push(new q_([o,s,t],l)),Xh.enableComingSoonToggle&&c.facetGroups.push(new q_([a],sg(yt)))}return c}(),a.selectedFacetOptions=Mh(r.selectedFacetOptions)?r.selectedFacetOptions:tR(),lP(a,i);const c=a.pageMetrics.instructions;if(!Lh(c))for(const e of c)e.data.includingFields.push(st);return s.remainingGroups.length>0&&(a.nextPage=s),a})}function cR(e,t){const n=$h(JSON.parse(t[Kf])).remainingContent.slice(0,20);return new Ry(n).includingAdditionalPlatforms(Ey()).includingAttributes(rR())}function lR(e,t){const n=$h(JSON.parse(t[Kf]));return n.remainingContent=e.data.concat(n.remainingContent.slice(20,n.remainingContent.length)),n.isFirstRender=!1,fR(n)}function uR(e,t,n){const r=$h(n);let o=[],i=20,s=!0;for(const e of r.remainingGroups)s=s&&(e.data.length<i||0===o.length),s&&(o=o.concat(e.data),i-=e.data.length);return new Ry(o).includingAdditionalPlatforms(Ey()).includingAttributes(rR())}function dR(e,t){const n=$h(t),r=[];let o=20;const i={};for(const t of e.data)i[t.id]=t;let s=!0;for(const e of n.remainingGroups){if(s=s&&(e.data.length<o||0===r.length),s){for(let t=0;t<e.data.length;t++){const n=i[e.data[t].id];Mh(n)&&(e.data[t]=n)}o-=e.data.length}r.push(e)}n.remainingGroups=[];const a=pR(r,n),c=new bP(a);return c.title=sg(Ki),n.remainingGroups.length>0&&(c.nextPage=n),c}function pR(e,t){return Oh.context("createShelves",()=>{const n=[];if(0===e.length)return n;let r=!1;for(const o of e)if(r=r||!AI(o.data[0]),r)t.remainingGroups.push(o);else{const e={index:t.lastShelfIndex,title:gR(o),contentType:mR(t.isCompactMode),shouldFilter:!1,remainingContent:o.data,groupKind:o.kind,isCompactMode:t.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker},r=fR(e);n.push(r),t.lastShelfIndex++,tA(e.metricsLocationTracker)}return n})}function fR(e){const t=[],n=new bS(e.contentType);n.title=e.title,n.presentationHints={showSupplementaryText:!1},n.isHorizontal=e.groupKind===Qi||e.groupKind===$l;const r={id:""+e.index,kind:null,softwareType:null,targetType:ah,title:n.title,pageInformation:e.metricsPageInformation,locationTracker:e.metricsLocationTracker,idType:oh};for(mA(n,r),JI(r,n.title);Mh(e.remainingContent)&&AI(e.remainingContent[0]);){const n=e.remainingContent.shift(),r=TI(n,ih);if(!Kh(Xa)&&uL(n)&&r)continue;const o=yx(n,{metricsOptions:{pageInformation:e.metricsPageInformation,locationTracker:e.metricsLocationTracker,recoMetricsData:Cb(n)},artworkUseCase:1,canDisplayArcadeOfferButton:DL(e.contentType)},_S);yR(o,n)&&(o.editorialTagline=null,o.developerTagline=null,t.push(o),tA(e.metricsLocationTracker))}return n.mergeWhenFetched=e.hasExistingContent,e.hasExistingContent=e.hasExistingContent||t.length>0,n.items=t,Mh(e.remainingContent)?n.url=function(e){if(Fh(e.remainingContent))return null;return`${Gy.internal}:/${Zy}/${Vy}/?${qw}=${encodeURIComponent(JSON.stringify(e))}`}(e):"tv"!==Dm&&e.isCompactMode&&n.items.length<3&&(n.rowsPerColumn=n.items.length),ZI(e.metricsLocationTracker),n}function hR(e){const t=tR(e),n={};for(const e of Object.keys(t))n[e]=t[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue}));const r={url:`${Gy.internal}:/${Zy}`,isCompactMode:!1,selectedFacetOptions:n},o=e[Vw];if(Mh(o)){const e=$h(JSON.parse(o));r.isCompactMode=e.isCompactMode,Object.assign(r.selectedFacetOptions,e.selectedFacetOptions)}return r}function mR(e){return e?ch:Dm===kh||Dm===Ph?xu:Yd}function gR(e){let t,n,r=null,o=null;switch(e.kind){case"releaseDateByDay":r=e.name.split("-"),o=new Date(parseInt(r[0]),parseInt(r[1])-1,parseInt(r[2])),n=sg(Ji),t=mg(n,Wl,o);break;case"lastUpdatedByDay":r=e.name.split("-"),o=new Date(parseInt(r[0]),parseInt(r[1])-1,parseInt(r[2])),n=sg("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),t=mg(n,Wl,o);break;case Qi:t=sg(Ac);break;default:t=e.name}return t}function yR(e,t){let n=!0;if(!Mh(e.trailers)){n=!1;const r=rL(t);if(Mh(r)){const t=new QA;r.playbackControls=ES,r.autoPlayPlaybackControls=CS,r.canPlayFullScreen=!0,t.videos=[r],e.trailers=[t],n=!0}}return n||function(e){const t=e.screenshots[0];if(Fh(t))return;const n=t.artwork[0],r=new BA("x-as3-internal:/today/test",n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,showPlaybackControls:!1,autoPlayPlaybackControls:{},playbackControls:{}}),o=new QA;o.videos=[r],e.trailers=[o]}(e),Mh(e.trailers)}class TR extends yb{constructor(){super("ArcadeSubscribeBuilder")}defaultPlatforms(){return Ey()}defaultTab(e){return Th}defaultAttributes(){const e=[lh,Cf,xf];return by&&e.push(Jf),e}pageType(){return ml}get pageRoute(){return[{hostName:""+VT,query:[Lw+"?",dw+"?",vw+"?",xw+"?",Dw+"?",Bw+"?"]},{hostName:""+GT,query:[Lw+"?",dw+"?",vw+"?",xw+"?",Dw+"?",Bw+"?"]},{path:"arcade/subscribe",query:[Lw+"?",dw+"?",vw+"?",xw+"?",Dw+"?",Bw+"?"]},{path:"{countryCode}/arcade/subscribe",query:[Lw+"?",dw+"?",vw+"?",xw+"?",Dw+"?",Bw+"?"]}]}generatePageRequest(e,t){return tk(this.marketingItemContextFromContextString(Gh(t,dw)),Gh(t,Lw)).attributingTo(e.build())}renderPage(e,t,n){const r=n[TR.contextualAppRequirementKey];let o=null;Mh(r)&&(o=bb(r));const i=YP(Bh(e,ji).map(e=>jh(e))),s=i,a=XD(s,o,!1,!1,Cc),c=new nm(Th,Xh.arcadeAppAdamId,Np,null,Tt,null,null,null,null,null,null,null,null,null,null,null,null,Xh.arcadeProductFamilyId);c.titles[ai]=sg(ld,ud);const l=Gh(t,Lw),u=this.marketingItemContextFromContextString(Gh(t,dw)),d={rootPosition:0,locationStack:[]},p=function(e,t,n){const r=aP(e,t,n);return Nh(n)&&(r.mercuryMetricsData=jI(n)),r}("Upsell",s.id,s);p.offerType=es,p.baseFields.upsellType=this.metricsUpsellType(u),p.baseFields.subscriptionSKU=Xh.arcadeProductId;const f={pageInformation:p,locationTracker:d},h=ex({marketingItemData:i},KD(s),f);if(!(h instanceof ay))throw new Error("Only buy actions are supported on the upsell page");const m=new Og(a,sg(wt),h,c);let g;m.askToBuyMessage=Gh(t,vw),m.askToBuyId=Gh(t,xw),lP(m,p);let y=!1;if(Mh(o)){m.primaryIcon=Dx(o,f,{useCase:3});const e=TI(o,ih),n=NS(o,f);n.excludeAttribution=!Wh(t[Bw]),g=zk(o,nh,u,e,n),m.postSubscribeAction=g,y=!0}if(!Wh(t[Bw])){const e=m.pageMetrics.instructions;if(!Lh(e))for(const t of e)t.data.includingFields.push(ts)}let T=[];const w=n[TR.contextualIconsRequirementKey];if(Mh(w)&&(T=Eb(w)),Nh(i)&&(T=RI(i,fh)),Mh(T)){const e=[];for(const t of T)if(t.id===l){if(!y){m.primaryIcon=Dx(t,f,{useCase:3});const e=TI(o,ih),n=NS(t,f);g=zk(t,nh,u,e,n),m.postSubscribeAction=g}}else e.push(Dx(t,f,{useCase:2}));m.icons=e}return Nh(g)&&(h.postSubscribeAction=g),u===_c&&Nh(l)&&Kh("postSubscribeAppOpenAction")&&(Kh("subscribePageOpenAppAction")?m.openAppAction=new Kg(l):m.postSubscribeAction=new Kg(l)),Mh(m.icons)||Nh(m.primaryIcon)||(m.artwork=this.genericArtworkFromData(s)),u===_c&&(m.singleIcon=m.primaryIcon),m.subscribedOfferButtonAction=new qg(Th),m}genericArtworkFromData(e){if(!Nh(e))return null;const t=Dm===kh,n="tv"===Dm,r=function(e,t){return Hh(function(e){return VD(e)}(e),t)}(e,t?R:O);if(!Mh(r))return null;let o=null;return o=t?"of":n&&!Kh("adjustedTVGenericUpsell")?"eq":"og",vx(r,{cropCode:o,allowingTransparency:!0,useCase:7})}metricsUpsellType(e){return Nh(e)?e:Mp}marketingItemContextFromContextString(e){switch(e){case It:return _c;case"askToBuy":return At;default:return e}}}TR.contextualIconsRequirementKey="contextualIconsRequirement",TR.contextualAppRequirementKey="contextualPrimaryIconRequirement";const wR={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:"000000",textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},IR={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:"000000",textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"};function AR(e){const t=new qg(Th);t.popToRoot=!0;const n=new Hg([t]);return n.title=e,n}function SR(e){const t={rootPosition:0,locationStack:[]},n=function(e){if(Rg(e)){const e=new ly;return e.title=sg(St),e}return AR(sg(bt))}(e);BS(n,{id:os,actionType:_f,pageInformation:new xS,locationTracker:t,targetType:wh});const r=function(e){return Rg(e)?AR(sg(rs)):null}(e);r&&BS(r,{id:Pt,actionType:_f,pageInformation:new xS,locationTracker:t,targetType:wh});let o=wR,i="oe";Dm===Ph&&(o=IR,i="og");const s=new Dg(sg(is),sg("AppStore.Arcade.Welcome.Family.Description"),[new vg(null,null,vx(o,{useCase:23,cropCode:i}))],n,r);if(Kh("dismissingPostSubscribeActions"))if(Rg(e)){s.nonDismissingContinueAction=AR(sg(rs)),n.title=s.nonDismissingContinueAction.title;const e=new ly;e.title=sg(wt),s.dismissingFamilyAction=e,r.title=s.dismissingFamilyAction.title}else s.nonDismissingContinueAction=AR(sg(rs)),n.title=s.nonDismissingContinueAction.title;return new xg(s,s)}function bR(e){return"tv"===Dm?function(){const e={rootPosition:0,locationStack:[]},t=new ly;t.title=sg(St),BS(t,{id:os,actionType:_f,pageInformation:new xS,locationTracker:e,targetType:wh});const n=new Dg(sg(is),null,[new vg(sg("ARCADE_WELCOME_TV_DEVICES_HEADING"),sg("ARCADE_WELCOME_TV_DEVICES_BODY"),ak("resource://DeviceSharing")),new vg(sg("ARCADE_WELCOME_TV_INDIVIDUAL_PEOPLE_HEADING"),sg("ARCADE_WELCOME_TV_INDIVIDUAL_PEOPLE_BODY"),ak("resource://FamilySharing")),new vg(sg("ARCADE_WELCOME_TV_CONTROLLERS_HEADING"),sg("ARCADE_WELCOME_TV_CONTROLLERS_BODY"),ak("resource://ControllerSupport"))],t,null);return new xg(n,n)}():Dm===Ch?function(){const e={rootPosition:0,locationStack:[]},t=new ly;t.title=sg(bt),BS(t,{id:os,actionType:_f,pageInformation:new xS,locationTracker:e,targetType:wh});const n=new Vg(kt);n.title=sg("ARCADE_WELCOME_INDIVIDUAL_FAMILY_BUTTON"),BS(n,{id:Pt,actionType:_f,pageInformation:new xS,locationTracker:e,targetType:wh});const r=new Vg(kt);r.title=sg("ARCADE_WELCOME_FAMILY_MEMBER_FAMILY_BUTTON"),BS(r,{id:"arcade-welcome-invite-to-family",actionType:_f,pageInformation:new xS,locationTracker:e,targetType:wh});const o=new Dg(sg(is),sg("ARCADE_WELCOME_INDIVIDUAL_SUBTITLE"),[new vg(null,null,ak("resource://WelcomeArcade"))],t,n),i=new Dg(sg("ARCADE_WELCOME_FAMILY_MEMBER_TITLE"),sg("ARCADE_WELCOME_FAMILY_MEMBER_SUBTITLE"),[new vg(null,null,ak("resource://WelcomeArcade"))],t,r);return new xg(o,i)}():SR(e)}class PR{}class kR{}function ER(e){return Oh.context("developerPageFromResponse",()=>{const t=e.data.length?e.data[0]:null;if(!t)return null;const n=aP("Artist",t.id,e),r=function(e,t,n){switch(Dm){case Ch:return function(e,t,n){by?(xR(e,Up,[Cu,_l]),xR(e,Cu,[_l])):xR(e,Up,[Cu]);let r=0;const o=[];for(const i of OR){const s=CI(e,i),a=Bh(s,$d),c=a.length;if(0===c)continue;const l=RR(i,e);JI({pageInformation:t,locationTracker:n,idType:oh,id:""+r,targetType:ah},l);const u={lockupOptions:{metricsOptions:{pageInformation:t,locationTracker:n},artworkUseCase:1},filter:55028},d=vR(a,"smallLockup",u);if(d.title=l,s.next){const r=new Bg(hh),o=new kR;o.title=l,o.href=s.href,o.developerId=e.id,o.relationshipId=i,r.pageUrl=DR(o),r.title=sg(Tp),d.seeAllAction=r,qS(r,r.pageUrl,{pageInformation:t,locationTracker:n}),r.pageData=CP.seeAllPage(l)}if(i===Hd&&0===c)continue;const p=a.filter(e=>Fh(e.attributes)),f=d.items.length+p.length;f<3&&(d.rowsPerColumn=f);const h={id:null,kind:null,softwareType:null,targetType:ah,title:d.title,pageInformation:t,locationTracker:n,idType:null};if(ZI(n),mA(d,h),tA(n),p.length){const e=new PR;e.contentType=ch,e.remainingData=p,e.lockupListOptions=u,d.url=`${Gy.internal}:/${uT}/${Vy}/`+encodeURIComponent(JSON.stringify(e))}d.items.length>0&&(o.push(d),r++)}return o}(e,t,n);case Eh:return function(e,t,n,r,o,i){const s=RI(t,n),a={lockupOptions:{metricsOptions:{pageInformation:o,locationTracker:i},artworkUseCase:1},filter:55028};JI({pageInformation:o,locationTracker:i,idType:oh,id:"0",targetType:ah},r);const c=vR(s,e,a),l=s.filter(e=>Fh(e.attributes)),u={id:null,kind:null,softwareType:null,targetType:ah,title:r,pageInformation:o,locationTracker:i,idType:null};if(ZI(i),mA(c,u),tA(i),l.length){const t=new PR;t.contentType=e,t.remainingData=l,t.lockupListOptions=a,c.url=`${Gy.internal}:/${uT}/${Vy}/`+encodeURIComponent(JSON.stringify(t))}return[c]}(ch,e,"watch-apps",sg(F),t,n);default:return function(e,t,n){host.platform===Yf&&xR(e,Up,[Ka,Cl]);let r,o;switch(Dm){case"tv":r=Of,o=2;break;default:r=ch,o=1}let i=0;const s=[];for(const a of _R){const c=CI(e,a),l=Bh(c,$d),u=l.length;if(0===u)continue;let d,p=!1;a===Ya?d=Cm:a===El?d=Em:a===Cl?(d=Rm,"tv"!==Dm&&(p=!0)):d=km;const f=CR(a,e);JI({pageInformation:t,locationTracker:n,idType:oh,id:""+i,targetType:ah},f);const h={excludeIconInSidepacksIfNotTvOnly:p,lockupOptions:{metricsOptions:{pageInformation:t,locationTracker:n},clientIdentifierOverride:d,artworkUseCase:o},filter:55028},m=vR(l,r,h);if(m.title=f,c.next){const r=new Bg(hh),o=new kR;o.title=f,o.href=c.href,o.developerId=e.id,o.relationshipId=a,r.pageUrl=DR(o),r.title=sg(Tp),m.seeAllAction=r,qS(r,r.pageUrl,{pageInformation:t,locationTracker:n}),r.pageData=CP.seeAllPage(f)}if(a===Hd&&0===u)continue;const g=l.filter(e=>Fh(e.attributes)),y=m.items.length+g.length;y<3&&(m.rowsPerColumn=y);const T={id:null,kind:null,softwareType:null,targetType:ah,title:m.title,pageInformation:t,locationTracker:n,idType:null};if(ZI(n),mA(m,T),tA(n),g.length){const e=new PR;e.contentType=ch,e.remainingData=g,e.lockupListOptions=h,m.url=`${Gy.internal}:/${uT}/${Vy}/`+encodeURIComponent(JSON.stringify(e))}m.items.length>0&&(s.push(m),i++)}return s}(e,t,n)}}(t,n,{rootPosition:0,locationStack:[]});1===r.length&&(r[0].isHorizontal=!1);const o=dL(t,ph);if(o){const e=new mm(o,ip),t=new bS(tf);t.items=[e],r.unshift(t)}const i=new wP(r);i.title=yI(t,bh),Dm!==Eh&&(i.presentationOptions=[Vd]),lP(i,n);const s=mI(t,ja);return s&&(i.uber=vx(s,{cropCode:"sr",useCase:20})),i})}function CR(e,t){switch(e){case Hd:return sg(N);case ui:return sg("DEVELOPER_SYSTEM_APPS");case Ya:return sg("DEVELOPER_IMESSAGE");case El:return sg(F);case Cl:return sg("DEVELOPER_TV");case gh:return sg(M);case Ka:const e=wI(t,"hasApps"),n=wI(t,"hasGames");return sg(e&&n?U:n?B:q);case Up:return sg(G);default:return null}}const _R=[Hd,Up,ui,gh,Ka,Ya,El,Cl];function RR(e,t){switch(e){case Hd:return sg(N);case gh:return sg(M);case Cu:if(by)return sg("DEVELOPER_MAC_APPS");{const e=wI(t,"hasApps"),n=wI(t,"hasGames");return sg(e&&n?U:n?B:q)}case _l:return sg("DEVELOPER_PHONE_PAD_APPS");case Up:return sg(G);default:return null}}const OR=[Hd,Up,gh,Cu,_l];function vR(e,t,n){const r=new bS(t);switch(t){case Rl:r.items=function(e,t){return Oh.context("screenshotsLockupsFromData",()=>{if(!e)return[];const n=[];for(let r=0;r<e.length;r++){const o=e[r];if(Lh(o.attributes)){t.contentUnavailable&&t.contentUnavailable(o.id,r);continue}const i=t.lockupOptions;let s=63486;if(null!==t.filter&&(s=t.filter),vS(o,s))continue;const a=gx(o,i);a.isValid()&&(n.push(a),tA(t.lockupOptions.metricsOptions.locationTracker))}return n})}(e,n),r.isHorizontal=!1,r.presentationHints={showSupplementaryText:!1};break;case ch:default:r.items=Ax(e,n),r.isHorizontal=Dm!==Eh}return r}function DR(e){return Nh(e)?`${Gy.internal}:/${uT}/${oT}/`+encodeURIComponent(JSON.stringify(e)):null}function xR(e,t,n){const r=CI(e,t);if(Lh(r))return;const o=Pb(r);if(Lh(o))return;const i=o.map(e=>e.id);for(const t of n){const n=CI(e,t);if(Lh(n))continue;const r=Pb(n);Lh(n)||(e.relationships[t].data=r.filter(e=>!i.includes(e.id)))}}const LR=typeof ask!==yh&&typeof ask.ads!==yh?ask.ads:{processAdvertsForSponsoredSearch:(e,t,n,r)=>Promise.resolve([]),fetchOnDeviceAd:(e,t)=>Promise.resolve({clientRequestId:null,iAdId:null,failureReason:"unsupportedOsVersion"})};async function FR(e,t,n){if(!e.validAdRequest())return Jb("ODML fetch skipped - Malformed request"),{adverts:[],error:"invalidAdRequest"};const r=await n,o=function(e){const t=Pb(e.results[Vn]),n=[];for(const e of t){const t=Gh(e,"id"),r=mI(e,"iads");Fh(t)||Fh(r)||n.push({instanceId:random.nextUUID(),adamId:t,assetInformation:{},adData:r})}return n}(r),i=function(e,t){const n=Pb(e.results.search),r=[];for(const e of n){const t=Gh(e,"id");Fh(t)||r.push({adamId:t,assetInformation:{}})}return r}(r);try{if(typeof ask===yh||typeof ask.ads===yh)return Jb("ODML fetch skipped - Unsupported client"),{adverts:o,error:"unsupportedClient"};{const e=await function(e,t,n,r){return LR.processAdvertsForSponsoredSearch(e,t,n,r)}(o,i,t,Xh.sponsoredSearchODMLTimeout);return Jb("ODML fetch completed"),{adverts:e}}}catch(e){return Jb("ODML fetch failed - "+e),{adverts:o,error:"uncategorizedError"}}}function NR(e){const t=function(e){return qR(e).addingQuery("groupBy[search]",od).includingMacOSCompatibleIOSAppsWhenSupported()}(e);if(!t)return null;const n=jS(t,UR()),r=VR(),o=HR();return Promise.all([n,r,o]).then(([n,r,o])=>{$R(n);return{catalogResponse:n,categoriesFilterData:r,transparencyData:bb(o),sponsoredSearchRequestData:null,sponsoredSearchAdvertData:null,requestMetadata:{requestDescriptor:e,searchRequestUrl:OI(t).toString()}}})}function MR(e){return jS(function(e){return new Ry(e).includingAdditionalPlatforms(Ey()).includingRelationships(BR).includingScopedAttributes(rh,[ea]).includingAttributes(GR()).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported()}(e))}function UR(e){const t={};return e&&e.validAdRequest()&&(t["X-Apple-App-Store-Client-Request-Id"]=e.appStoreClientRequestId,t["X-Apple-iAd-Request-Data"]=e.sponsoredSearchRequestData,t["X-Apple-iAd-Env-Name"]=e.routingInfo),{headers:t}}const BR=[Ah,"top-apps"];function qR(e){var t;const n=null===(t=e.term)||void 0===t?void 0:t.trim();if(Fh(n))return null;const r=e.origin,o=e.searchEntity,i=e.facets,s=e.selectedFacetOptions,a=e.spellCheckEnabled,c=e.excludedTerms,l=host.clientIdentifier,u=(new Ry).withSearchTerm(n).includingAdditionalPlatforms(Ey()).includingRelationships(BR).includingAttributes(GR()).includingScopedAttributes(rh,[ea]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported();if(qh($m)&&u.withFilter(tp,"tinker"),Kh(vd)&&host.platform===Yf&&(u.enablingFeature(vd),Mh(e.guidedSearchTokens)&&u.addingQuery("selectedFacets",e.guidedSearchTokens.join(",")),Mh(e.guidedSearchOptimizationTerm)&&u.addingQuery("finalTerm",e.guidedSearchOptimizationTerm)),o===cu?u.searchingOverTypes([rh]):o===Lf?u.searchingOverTypes([Qd]):o===Eh||o===Th?u.searchingOverTypes([Ah]).withFilter(tp,o):"tv"===Dm?u.searchingOverTypes([Ah,Qd,Af,rh]):u.searchingOverTypes([Ah,Qd,Af,rh,gh,Tf]),by&&!Py&&u.addingQuery("restrict","!requiresRosetta"),i)for(const e of Object.keys(i))u.addingQuery(e,i[e]);if(s)for(const e of Object.keys(s)){const t=G_.requestValuesForSelectedFacetOptions(s[e]);if(Mh(t)){u.addingQuery(e,t.value);for(const e of Object.keys(t.additionalKeyValuePairs))u.addingQuery(e,t.additionalKeyValuePairs[e])}}switch(r===Zu?u.addingQuery("src","hint"):r===Dd?u.addingQuery("src",Dd):r===ta?u.addingQuery("src","searchInstead"):r===na?u.addingQuery("src",Mn):r===Ys&&u.addingQuery("src","facet"),l){case Em:u.addingContext(Eh);break;case Cm:u.addingContext(Zf);break;case _m:u.addingContext(Th)}return u.addingQuery("limit[ads-result]",Xh.mediaAdvertRequestLimit.toString()),a&&u.enablingFeature("spellCheck"),c&&u.addingQuery("excludeTerms",c.join(",")),u}function GR(){const e=[Gp,Ss,wp,xf,Jl,As,Xf];return by&&e.push(Jf),e}function VR(){let e=null;if(function(e){switch(e){case Ph:case Ch:return!0;default:return!1}}(Dm)){const t=FL(null,null,Ey());t&&(e=jS(t).catch(()=>null))}return e}function HR(){let e=null;const t=Xh.searchTransparencyAdamId;if(Mh(t)){e=jS((new Ry).forType(rh).withIds([t]).includingAdditionalPlatforms(Ey())).catch(()=>null)}return e}function $R(e){const t=Cb(e);Nh(t)&&(e.meta.metrics["data.search.dataSetId"]=Gh(t,"dataSetId"),delete e.meta.metrics.dataSetId)}function WR(e,t){const n=e.query[hf];switch(n){case Gf:const t=new Bg(Nf);t.presentationContext=np,t.animationBehavior=Iu;const r=e.query[Ua];return r?t.pageUrl=r:e.query[kr]?t.pageUrl=uI.fromComponents(null,n,null,{continuation:e.query[kr]}).toString():t.pageUrl=n,Promise.resolve(t);case"signup":const o=new Bg(Nf);return o.presentationContext=np,o.animationBehavior=Iu,o.pageUrl=function(){let e=Xh.createAccountUrl;(Lh(e)||typeof e!==Ih)&&(e="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard");return new uI(e)}().build(),Promise.resolve(o);case Yo:let i,s=[];if(Dm===Ch)i=Gf;else{i=Tl;const e=new Bg(Gf);e.presentationContext=np,e.animationBehavior=Wp;const t=new Bg(y);t.animationBehavior=Wp,s=[e,t]}const a=new qg(i);return a.actions=s,Promise.resolve(a);case cl:const c=e.query[Ua];if(c.length>0){const e={url:c,signingStyle:od};return net.fetch(e),Promise.resolve(new ly)}return Promise.reject(new Error("Original url is missing when creating action for checkForPreorders."));case Ii:const l=new Bg(Nf);l.presentationContext=np,l.animationBehavior=Iu;const u=new uI(n);return e.query[Zd]&&e.query[Zd].length>0&&u.param(Uw,e.query[Zd]),Object.keys(e.query).filter(e=>e!==Zd&&e!==hf).forEach(t=>u.param(t,e.query[t])),l.pageUrl=u.build(),Promise.resolve(l);case ic:const d=new Bg(Nf);return d.presentationContext=np,d.animationBehavior=Iu,d.pageUrl=n,Promise.resolve(d);case"donate":const p=new Bg(Nf);return p.presentationContext=np,p.animationBehavior=Iu,p.pageUrl="charity",Promise.resolve(p);case Vf:let f=e.query[du];if(f||(f=e.query.q),f&&f.length>0){if(f=f.replace(/\+/g," ").trim(),Fh(f))return Promise.reject(new Error("Empty search term."));const e=OI(qR({term:f,origin:Er})).toString(),t=new Nb(f,f,e,Er),n=new Bg(Vf);return n.pageData=t,Promise.resolve(n)}{const e=new qg(Vf);return Promise.resolve(e)}}return Promise.reject(new Error("FlowAction was not able to be created for this action URL: "+e))}let zR;zR=ask.gameCenter;const jR=e=>zR.fetchFriendsThatPlayGame(e);var YR={product:[{protocol:Gy.internal,path:`/${aT}/${Wy}`,query:[QT]}],reviews:[{protocol:Gy.internal,path:`/${pT}/${Vy}/{adamId}/{sort}`}],topCharts:[{protocol:Gy.internal,path:`/${iT}/{genre}/{pop}`}],grouping:[{protocol:Gy.internal,path:`/${Yy}/${Vy}/{shelfToken}`}]};class KR{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class QR extends Zh{constructor(e,t){super(),this.apps=e,this.appsToAlwaysShow=t}}function JR(e){return Oh.context("msoProviderDataFromData",()=>{const t=bb(e),n=yI(t,bh),r=yI(t,Sh),o=function(e){return Oh.context("msoProviderArtworkFromData",()=>{const t=mI(e,"editorialArtwork.storeFlowcase");if(t)return vx(t,{useCase:3});return vx(mI(e,uh),{useCase:3})})}(t);o&&(o.crop="sr");const i=function(e){const t=mI(e,ja);if(t)return vx(t,{useCase:20});return null}(t);return new KR(n,r,o,i)})}function XR(e){return(new Ry).forType(xa).withIds([e]).includingRelationships([Ah,Oi]).addingQuery("limit[channel-apps]","100")}function ZR(e,t){return Oh.context("msoRoomPageWithResponse",()=>{const n=bb(e),r=aP(Gd,n.id,e),o=RI(n,Ah),i=RI(n,Oi);for(const e of i){const t=_I(e,sf);Mh(t)&&o.push(t)}const s=new kP;s.ids=o.map(e=>e.id),s.shouldFilter=!1,s.metricsPageInformation=r;const a=function(e,t,n,r=[]){return Oh.context("msoRoomPageWithContext",()=>{const o=[],i=[];for(const n of e)-1!==t.indexOf(n.id)?o.push(n):i.push(n);const s={rootPosition:0,locationStack:[]},a={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:s},artworkUseCase:2}},c=[],l={pageInformation:n.metricsPageInformation,locationTracker:s,targetType:ah,idType:oh,id:"0"};if(o.length>0){const e=sg("MSO_INCLUDED_IN_SUBSCRIPTION"),t=new kP;t.remainingContent=[],t.metricsPageInformation=n.metricsPageInformation,t.metricsLocationTracker=s,t.preferredShelfContentType=Of,l.id="0",JI(l,e),a.contentUnavailable=function(e,n){return t.remainingContent.push(o[n]),!1};const r=new bS(Of);r.title=e,r.shouldFilterApps=n.shouldFilter,r.items=Ax(o,a),r.url=eO(t),ZI(s),r.items.length>0&&(tA(s),c.push(r))}if(o.length>0&&i.length>0){const e=sg("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),t=new kP;t.remainingContent=[],t.metricsPageInformation=n.metricsPageInformation,t.metricsLocationTracker=s,t.preferredShelfContentType=Of,l.id="1",JI(l,e),a.contentUnavailable=function(e,n){return t.remainingContent.push(i[n]),!1};const r=new bS(Of);r.title=e,r.shouldFilterApps=n.shouldFilter,r.items=Ax(i,a),r.url=eO(t),ZI(s),r.items.length>0&&(tA(s),c.push(r))}if(0===c.length){const t=new kP;t.remainingContent=[],t.metricsPageInformation=n.metricsPageInformation,t.metricsLocationTracker=s,t.preferredShelfContentType=ch,l.id="0",JI(l,null),a.contentUnavailable=function(n,r){return t.remainingContent.push(e[r]),!1};const r=new bS(Of);r.shouldFilterApps=n.shouldFilter,r.items=Ax(e,a),r.url=eO(t),ZI(s),tA(s),c.push(r)}for(const e of c)e.isHorizontal=c.length>1;const u=r.concat(c);return new wP(u)})}(o,t,s);return a.title=yI(n,bh),a.isIncomplete=!1,lP(a,r),a})}function eO(e){return e.remainingContent.length?`${Gy.internal}:/${wT}/${Vy}/`+encodeURIComponent(JSON.stringify(e)):null}class tO{constructor(e,t){this.period=e,this.type=t}isEqualTo(e){return e.period===this.period&&e.type===this.type}}const nO={D:"DAYS",W:"WEEKS",M:"MONTHS",Y:"YEARS"},rO={FreeTrial:"FREE_TRIAL",PayUpFront:"PAID_UPFRONT",PayAsYouGo:"PAID_TRIAL"};function oO(e){if(!e)return null;const t=e.match(/P(\d+)([A-Z]+)/);if(!t||3!==t.length)return null;let n=Vh(t[1]),r=t[2];return n&&r?("D"===r&&n>0&&n%7==0&&(r="W",n/=7),new tO(n,r)):null}function iO(e){const t=Bh(e,vi)[0];if(!t)return null;const n=Gh(t,Ie),r=Gh(e,Ie);if(!n||!r)return null;const o=Gh(t,"modeType"),i=oO(n),s=oO(r),a=function(e,t,n){if(Lh(e)||Lh(t))return null;const r=nO[e.type],o=nO[t.type],i=rO[n];if(!r||!o||!i)return null;return`IN_APP_OFFER_PAGE_DESCRIPTION_${i}_${r}_POST_TRIAL_${o}`}(i,s,o);if(!a)return null;const c=Gh(t,Nl),l=Gh(e,Nl),u=Vh(t,"numOfPeriods"),d=i.period*u;switch(o){case"FreeTrial":const e=cg(a,[d,s.period]);if(e)return e.replace(Di,l);break;case Ae:const t=cg(a,[d,s.period]);if(t)return t.replace(Se,c).replace(Di,l);break;case be:const n=cg(a,[i.period,d,s.period]);if(n)return n.replace(Se,c).replace(Di,l);break;default:return null}return null}class sO extends Error{}class aO extends Zh{constructor(e,t,n,r,o,i){super(),this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class cO extends Zh{constructor(e,t){super(),this.bodyText=e,this.action=t}}class lO extends Zh{constructor(e,t,n){super(),this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class uO extends em{constructor(e,t,n,r,o,i,s,a){super(),this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class dO extends Zh{constructor(e,t,n){super(),this.identifier=e,this.title=t,this.categories=n}}class pO extends Zh{constructor(e,t,n,r,o=[]){super(),this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}function fO(e,t,n,r,o){if(n)return null;const i=dx(e);if(Fh(i))return null;const s=new xA(i),a=r?"":sg("INFO_LIST_CATEGORY_TITLE");return new DA(a,[s])}function hO(e,t,n,r,o){const i=mI(e,js);let s=[],a=function(e){let t=null;if(Cx(e)){const n=Wx(e,by),r=$x(e),o=Qx(e,by,Py),i=function(e,t,n,r=!0){if(!jx(t,n).some(t=>Yx(e,t)))return!1;if(Dm===Ch&&e.includes(Ch))return r;return!0}(r,Dm,n,o),s=function(e){if(host.deviceLocalizedModel)return host.deviceLocalizedModel;switch(e){case kh:const e=sg(_r);return e===_r?"iPhone":e;case Ph:const t=sg(Rr);return t===Rr?"iPad":t;case"tv":const n=sg(Or);return n===Or?"Apple\xa0TV":n;case Eh:const r=sg(vr);return r===vr?"Apple\xa0Watch":r;case Ch:const o=sg(Dr);return o===Dr?"Mac":o;case dh:default:return null}}(Dm);if(i&&s){const e=sg("INFO_LIST_REQUIREMENTS_SUMMARY");t=e.replace("{deviceName}",s)}}return t}(e);const c=uA(e,vt,fA());if(fL(e))return null;if(Mh(i)){const e=function(){const e=[Rf,Mf,Bu,Ch,lp,Eh],t=function(e,t){let n=null;switch(e){case kh:n=Rf;break;case Ph:n=Mf;break;case Ch:n=Ch;break;case"tv":n=lp;break;case Eh:n=Eh}return Nh(t)&&t===Bu&&(n=Bu),n}(Dm,host.deviceModel);if(Nh(t)){const n=e.indexOf(t);n>0&&(e.splice(n,1),e.unshift(t))}return e}();for(const t of e){const e=Hh(i,t);if(Mh(e)){const n=mO(e,by&&t===Ch&&c&&!Py);Nh(n)&&s.push(n)}}!Nh(a)&&s.length>0&&(a=s[0].text)}else{const t=function(e){const t=cA(e,"requirementsString");if(Lh(t))return null;return new xA(t)}(e);Nh(t)&&(s=[t])}if(Fh(s))return null;const l=r?"":sg("REQUIREMENTS");return new DA(l,s,a)}function mO(e,t){const n=Gh(e,"deviceFamily");let r=Gh(e,"requirementString");const o=Bh(e,"devices");if(t){const t=Gh(e,"rosettaUnavailableRequirementString");Mh(t)&&(r=t)}if(Fh(r))return null;const i=[];for(const e of o)i.push("\u2022\t\u2068"+e+"\u2069");const s=i.length>0?i.join("\n"):null;return new xA(r,n,null,s)}function gO(e,t,n,r,o){const i=mI(e,"contentRatingsBySystem.appsApple");if(i){const t=Gh(i,bh);if(t){const n=Bh(i,"advisories");let o=null;const s=PI(e,pA(e),"ageBand"),a=Vh(s,"minAge"),c=Vh(s,"maxAge");o=Nh(a)&&Nh(c)?sg("INFO_LIST_AGE_RATING_SUMMARY").replace("{ageRating}",t).replace("{minAgeRating}",ug(a)).replace("{maxAgeRating}",ug(c)):t;const l=[];if(Xh.requireAgeVerification&&function(e,t){let n;switch(t){case"twelvePlus":n=3;break;case En:n=4;break;case"adultOnly":n=5;break;default:n=1}return e>=n}(Vh(i,"rank"),En)&&function(e){const t=RI(e,"genres");for(const e of t)if(Gh(e,"id")===6014..toString())return!0;return!1}(e)){let t=null;const n=e.type===gh;if(n){const n=CI(e,Ah);if(Nh(n))for(const e of n.data){if(Nh(yI(e,Cn))){t="AppStore.AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles";break}}}else Nh(yI(e,Cn))&&(t="AppStore.AgeVerification.ProductPage.Rating.UnsuitableForJuveniles");let r;null!=t&&l.push(new xA(sg(t))),r=n?"AppStore.AgeVerification.ProductPage.Rating.BundleRequiredAge":"AppStore.AgeVerification.ProductPage.Rating.RequiredAge",l.push(new xA(sg(r)+"\n"))}if(o&&l.push(new xA(o)),n.length>0)for(const e of n)l.push(new xA(e));let u=null;l.length>1&&(u=o);const d=r?"":sg("INFO_LIST_AGE_RATING_TITLE");let p;return Mh(Xh.ageRatingLearnMoreEditorialItemId)&&(p=new Bg(jf),p.title=sg("INFO_LIST_AGE_RATING_LEARN_MORE"),p.pageUrl="https://apps.apple.com/story/id"+Xh.ageRatingLearnMoreEditorialItemId),new DA(d,l,u,p)}}return null}function yO(e,t,n,r,o){const i=cA(e,"copyright");if(!Lh(i)){const e=new xA(i),t=r?"":sg("INFO_LIST_COPYRIGHT");return new DA(t,[e])}return null}function TO(e,t,n,r,o){const i=aA(e,"languageList");if(Fh(i))return null;const s=i.length;if(s<1)return null;let a=null,c=null;switch(s){case 0:break;case 1:c=i[0];break;case 2:c=sg("INFO_LIST_TWO_LANGUAGES_SUMMARY").replace("{first}",i[0]).replace("{second}",i[1]);break;default:const e=s-1;a=sg("INFO_LIST_MORE_LANGUAGES_SUMMARY").replace("{language}",i[0]).replace(Qc,pg(e)),c=function(e,t){if(null===e||null===t)return null;if(0===e.length)return"";let n=e.length,r="";return e.forEach((e,o)=>{null===e?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(i,sg("CONJUNCTION_SEPARATOR"))}if(!Nh(c))return null;const l=new xA(c),u=r?"":sg("SUPPORTED_LANGUAGES");return new DA(u,[l],a)}function wO(e,t,n,r,o){const i=cA(e,"seller"),s=cA(e,"sellerLabel")||sg("SELLER");if(!Nh(i))return null;const a=new xA(i),c=new DA(r?"":s,[a]);return c&&!n?c:null}function IO(e,t,n,r,o){const i=eL(e);if(!t&&Nh(i)&&!n){const e=dg(i),t=new xA(e),n=r?"":sg("FILE_SIZE");return new DA(n,[t])}return null}function AO(e,t,n,r,o){const i=RI(e,nl);if(i.length>0){const e=[];for(const t of i){const n=yI(t,bh),r=Gh(Uk(t),Nl);e.push(new xA(n,null,r))}const t=r?"":sg("INFO_LIST_IN_APP_PURCHASES");return new DA(t,e,sg("YES"))}return null}const SO=[wO,IO,fO,hO,function(e,t,n,r,o){if(wI(e,"usesLocationBackgroundMode")){const e=r?"":sg("INFO_LIST_LOCATION_TITLE"),t=sg("INFO_LIST_LOCATION_DESCRIPTION"),n=new xA(t);return new DA(e,[n])}return null},TO,gO,AO,function(e,t,n,r,o){const i=Lk(e),s=Fk("product-page-info-section");if(!i||!s)return null;const a=r?"":sg("AppStore.Annotations.ExternalPurchases.Title"),c=sg("YES"),l=sg("AppStore.Annotations.ExternalPurchases.Expanded"),u=new xA(l),d=Nk(sg("AppStore.Annotations.ExternalPurchases.Expanded.LearnMore"),o.metricsPageInformation,o.locationTracker);return new DA(a,[u],c,d)},yO],bO=[wO,fO,function(e,t,n,r,o){const i=aA(e,Od);if(0===i.length)return null;const s=i[0];let a=null;const c=Gh(s,Ap);c&&(a=hg("d MMM YYYY",new Date(c)));const l=Gh(s,Pn);if(0===i.length)return null;let u;if(l&&a)u=sg("VERSION_STRING_WITH_RELEASE_DATE").replace("{version}",l).replace("{date}",a);else{if(!l)return null;u=l}const d=new xA(u),p=r?"":sg("VERSION_STRING"),f=new DA(p,[d]);return f&&!n?f:null},IO,yO],PO=[hO,TO,gO],kO=[AO];function EO(e,t,n,r,o,i,s){const a=[];for(const c of e){const e=c(t,n,r,o,i);e&&(a.push(e),s&&s(c,a.length-1))}return a}function CO(e,t,n,r,o,i){return Oh.context("tvInformationShelf",()=>{let s;const a=EO(bO,e,t,!1,!1,n,i),c=function(e,t){return Oh.context("productCapabilitiesAsAnnotations",()=>{const n=[],r=Zx(e,t);for(const e of r){let t,r;switch(e.type){case nf:t=sg("CAPABILITY_GAME_CENTER_TITLE"),r=sg("CAPABILITY_GAME_CENTER_EXPLANATION");break;case vc:t=sg("CAPABILITY_SIRI_TITLE"),r=sg("CAPABILITY_SIRI_EXPLANATION");break;case"wallet":t=sg("CAPABILITY_WALLET_TITLE"),r=sg("CAPABILITY_WALLET_EXPLANATION");break;case Ut:case Mt:t=sg(_n),r=sg("CAPABILITY_FAMILY_SHARING_EXPLANATION");break;case Nt:case Ft:t=sg(_n),r=sg("CAPABILITY_FAMILY_SHARING_WITH_IAP_EXPLANATION");break;case Lt:t=sg("CAPABILITY_MFI_CONTROLLERS_TITLE"),r=sg("CAPABILITY_MFI_CONTROLLERS_EXPLANATION");break;default:t=null,r=null}if(Mh(t)&&Mh(r)){const e=new xA(r),o=new DA(t,[e]);n.push(o)}}return n})}(e,o).concat(EO(PO,e,t,!1,!1,n,i)),l=EO(kO,e,t,!1,!0,n,i),u=[];if(a.length>0){const e=new vA(sg(Hs),a,r);u.push(e)}if(c.length>0){const e=new vA(sg($s),c,r);u.push(e)}if(l.length>0){const e=new vA(sg("PRODUCT_SECTION_TOP_IN_APP_PURCHASES"),l,!0);u.push(e)}return u.length>0&&(s=new bS("informationContainer"),s.items=[new LA(u)],Lh(n)||n.addImpressionsToShelf(s,zf)),s})}function _O(e,t,n,r,o,i,s){return Oh.context(mp,()=>{let a;switch(Dm){case Eh:a=function(e,t,n){return Oh.context(kn,()=>{let r;const o=EO(SO,e,t,!1,!1,n,null);return o.length>0&&(r=new bS(Ad),r.items=o,Lh(n)||n.addImpressionsToShelf(r,zf)),r})}(e,t,n);break;case"tv":a=CO(e,t,n,i,s,r);break;default:a=function(e,t,n,r,o){return Oh.context(kn,()=>{let i;const s=EO(SO,e,t,r,!1,n,o);return s.length>0&&(i=new bS(Ad),i.title=sg(Hs),i.items=s,Lh(n)||n.addImpressionsToShelf(i,zf)),i})}(e,t,n,o,r)}return a})}function RO(e,t,n){return Oh.context(mp,()=>Fh(e)?null:"tv"===Dm?function(e,t,n){return Oh.context("tvLinksShelf",()=>{const r=new bS(ae),o=[],i=_O(e,!1,t,null,!1,!0,n),s=new wP([i]);s.title=yI(e,bh),"tv"===Dm&&s.presentationOptions.push("prefersIndirectTouch");const a=new Bg(hh);a.presentationContext="presentModalBlur",a.pageData=s;const c=new lS(sg("MORE_INFORMATION"),a);o.push(c);if(lA(e,Yt)){const t=OO(e);if(t){const e=sg(hc),n=new Bg(dh);n.pageUrl=t;const r=new lS(e,n);o.push(r)}}if(TI(e,"hasEula")){const t=function(e){const t=e.id,n=e.type;if(!(Nh(e)&&Nh(t)&&Nh(n)))return null;return`${Gy.internal}:/${kT}?resourceType=${n}&resourceId=${t}`}(e);if(t){const e=sg(Qa),n=new Bg(dh);n.pageUrl=t;const r=new lS(e,n);o.push(r)}}const l=new cS(o);return l.compactLineBreaks=l.buttons.map((e,t)=>t),r.items=[l],t.addImpressionsToShelf(r,If),r})}(e,t,n):function(e,t){return Oh.context("standardLinksShelf",()=>{const n=new bS("productPageLink"),r=[];if(Dm!==Ch){const t=cA(e,Xc);if(t){const e=new Vg(t,!1),n=sg("DEVELOPER_WEBSITE");r.push(new sS(n,e,Lf))}}const o=cA(e,Zl);if(o){const e=new Vg(o,!1),t=sg(hc);r.push(new sS(t,e,Wu))}if(TI(e,"hasEula")){const t=function(e){const t=e.id,n=e.type;if(!(Nh(e)&&Nh(t)&&Nh(n)))return null;return`${Gy.internal}:/${PT}?resourceType=${n}&resourceId=${t}`}(e);if(t){const e=new Bg(hh);e.pageUrl=t;const n=sg(Qa);r.push(new sS(n,e,md))}}return r&&r.length>0&&(n.items=r),t.addImpressionsToShelf(n,If),n})}(e,t))}function OO(e){const t=e.id;return Nh(e)&&Nh(t)?`${Gy.internal}:/${ET}?resourceId=${t}`:null}function vO(e,t,n,r,o,i){const s=Bh(e,Xp),a=[];for(const e of s){const s=jh(e);if(Mh(s)){const e=DO(s,t,n,r,o,i);Nh(e)&&a.push(e)}}if(0===a.length){const e=function(e,t,n,r){const o=sg("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),i=sg("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),s=ak("systemimage://exclamationmark.triangle"),a=xO(e,"DATA_NOT_PROVIDED",t,n,r);return new uO("DATA_NOT_PROVIDED",o,i,s,t,[],[],a)}(t,n,o,i);a.push(e)}for(const e of a){mA(e,{id:e.identifier,kind:null,softwareType:null,title:e.title,pageInformation:o,locationTracker:i,targetType:vs}),tA(i)}return a}function DO(e,t,n,r,o,i){const s=Gh(e,Ds),a=Gh(e,Bc),c=Gh(e,Sf);if(Fh(s)||Fh(a)||Fh(c))return null;const l=MO(e,function(e){switch(e){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash";case"DATA_USED_TO_TRACK_YOU":return"resource://person.square.brackets";case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle";case"DATA_LINKED_TO_YOU":return Xt;default:return null}}(s)),u=r?LO(e,n):[],d=function(e,t){const n=Bh(e,"purposes"),r=[];for(const e of n){const n=jh(e);if(Mh(n)){const e=NO(n,t);Nh(e)&&r.push(e)}}return r}(e,n),p=xO(t,s,n,o,i);return new uO(s,a,c,l,n,d,u,p)}function xO(e,t,n,r,o){let i;if(n===$f||n===tu){i=HO(e,Dm===Eh&&n===$f?tu:kp,r,o,t)}return i}function LO(e,t){const n=Bh(e,"dataCategories"),r=[];for(const e of n){const n=jh(e);if(Mh(n)){const e=FO(n,t===$f?$f:kp);Nh(e)&&r.push(e)}}return r}function FO(e,t){const n=Gh(e,Ds),r=Gh(e,"dataCategory");if(Fh(n)||Fh(r))return null;const o=MO(e,function(e){switch(e){case"FINANCIAL_INFO":return"systemimage://creditcard.fill";case"CONTACT_INFO":return"systemimage://info.circle.fill";case"OTHER":return"systemimage://ellipsis.circle.fill";case"SENSITIVE_INFO":return"systemimage://eye.fill";case Jt:return"systemimage://chart.bar.fill";case"CONTACTS":return Xt;case"PURCHASES":return"systemimage://bag.fill";case"LOCATION":return"systemimage://location.fill";case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill";case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill";case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill";case"BROWSING_HISTORY":return"systemimage://clock.fill";case"DIAGNOSTICS":return"systemimage://gearshape.fill";case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill";default:return null}}(n));if(Lh(o))return null;let i=[];t===kp&&(i=Bh(e,"dataTypes"));const s=new pO(n,r,o,t,i);return n===Jt&&(s.prefersSmallArtwork=!0),s}function NO(e,t){const n=Gh(e,Ds),r=Gh(e,"purpose"),o=LO(e,t);return Fh(n)||Fh(r)||0===o.length?null:new dO(n,r,o)}function MO(e,t){let n;if(Mh(t)&&(n=ak(t)),Lh(n)){const t=Hh(e,uh);Nh(t)&&(n=vx(t,{useCase:0,allowingTransparency:!0}))}return n}function UO(e,t,n,r,o){return Oh.context("createPrivacyHeaderFromData",()=>{const i=function(e,t,n,r,o){let i,s=ip;const a=_I(e,Lf),c=Mh(a)&&Ig.indexOf(a.id)>-1;i=sg(t&&!c?"PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE":"PRODUCT_PRIVACY_HEADER_TEMPLATE");const l=VO(e,n,kp,r,o),u=1===l.length&&l[0].identifier===Cs||0===l.length;u&&(i=sg("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"));const d=yI(e,Qp);Nh(d)?i=i.replace("{developerName}","<b>"+d+"</b>"):(i=sg(u?"PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE":t?"PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE":"PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),s=mf);const p=sg("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK");i=i.replace("{privacyPolicyLink}",p);const f=BO(e,r,o),h={};Nh(f)&&(h[p]=f);if(t)if(Dm===kh||Dm===Ph||Dm===Ch){const t=function(e,t,n){const r=Gh(mI(e,Uc),"managePrivacyChoicesUrl");if(Fh(r))return null;const o=new Vg(r,!1);return BS(o,{targetType:Wf,id:"managePrivacyChoices",pageInformation:t,locationTracker:n}),o}(e,r,o);if(Nh(t)){const e=sg("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK");i+="<br><br>",i+=sg("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",e),t.title=e,h[e]=t}}else i+="<br><br>",i+=sg("PRODUCT_PRIVACY_MANAGE_CHOICES_NO_LINK");const m=new hm(i,s);return new iS(m,h)}(e,t,n,r,o);let s,a;const c=function(e,t,n,r){if(!t)return null;const o=sg(Qt),i=sg("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",o),s=GO(n,r);if(Lh(s))return null;s.title=o;const a={};a[o]=s;const c=new hm(i,mf);return new iS(c,a)}(0,t,r,o);let l,u,d;if("tv"===Dm||Dm===Eh){if(!t){s=HO(e,Dm===Eh?tu:kp,r,o,null)}a=BO(e,r,o)}t&&(Dm!==Eh&&"tv"!==Dm||(l=GO(r,o)),u=function(e,t,n,r){if(!t||"tv"===Dm)return null;const o=sg(_s),i=qO(n,r);let s;const a={};Lh(i)||Dm===Eh?s=sg(Rs):(s=sg(jt).replace(Os,o),i.title=o,a[o]=i);const c=new hm(s,mf);return new iS(c,a)}(0,t,r,o),Mh(u)&&(d=qO(r,o)));const p=[];if(Nh(c)){const e=new cO(c,l);p.push(e)}if(Nh(u)){const e=new cO(u,d);p.push(e)}let f=[];Dm!==Eh&&"tv"!==Dm||t||(f=VO(e,n,$f,r,o));const h=[];return"tv"===Dm&&(Nh(s)&&h.push(s),Nh(a)&&h.push(a)),Dm===Eh&&Nh(a)&&h.push(a),new aO(i,t,f,h,p,s)})}function BO(e,t,n){let r;if("tv"===Dm){if(!lA(e,Yt))return null;const t=OO(e);if(Lh(t))return null;const n=new Bg(dh);n.pageUrl=t,r=n}else{const t=cA(e,Zl);if(Fh(t))return null;r=new Vg(t,!1)}return r.title=sg("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),BS(r,{targetType:Wf,id:Kt,pageInformation:t,locationTracker:n}),r}function qO(e,t){const n=Xh.appPrivacyLearnMoreEditorialItemId;if(Fh(n))return null;const r=new Bg(jf);return r.title=sg(_s),r.pageUrl="https://apps.apple.com/story/id"+n,BS(r,{targetType:wh,id:"privacyLearnMore",pageInformation:e,locationTracker:t}),r}function GO(e,t){const n=Xh.appPrivacyDefinitionsEditorialItemId;if(Fh(n))return null;const r=new Bg(jf);return r.title=sg(Qt),r.pageUrl="https://apps.apple.com/story/id"+n,BS(r,{targetType:wh,id:Xl,pageInformation:e,locationTracker:t}),r}function VO(e,t,n,r,o){let i=[];const s=mI(e,t?Uc:Wu);if(Mh(s)){i=vO(s,e,n,Dm!==Eh||n===tu,r,o),1===i.length&&0===i[0].categories.length&&(i[0].style=$f)}return i}function HO(e,t,n,r,o){if(Lh(e.id))return null;const i=new Bg(Es);i.title=sg("ACTION_SEE_DETAILS"),i.pageData=function(e,t,n,r){const o=[];if(Dm!==Eh||t!==kp){const t=new bS(df),i=UO(e,!0,!1,n,r);t.items=[i],o.push(t)}if(Dm===Eh&&t===tu){const i=VO(e,!1,t,n,r),s=new bS(Bc);i.length>0&&(s.items=i,o.push(s))}const i=new wP(o);return Dm===Eh&&t!==kp||(i.isIncomplete=!0),i.title=sg(eu),Dm===Ch&&(i.presentationOptions=[Vd]),i}(e,t,n,r);const s=e.type===gh?lT:aT;let a;Mh(o)&&(a={privacyTypeId:o});const c=uI.fromComponents(Gy.internal,null,`/${DT}/${s}/${e.id}`,a);i.pageUrl=c.build();const l={targetType:wh,id:"seeDetails",pageInformation:n,locationTracker:r};return Nh(o)&&(l.targetType=vs,l.id=o),BS(i,l),i}function $O(e,t,n){return Oh.context(mp,()=>{if(Fh(e))return null;if(Dm===Eh)return null;const r=VO(e,!1,kp,t,n);if((1===r.length&&r[0].identifier===Cs||0===r.length)&&"tv"!==Dm)return null;const o=new bS(Ep),i=function(e,t,n){return Oh.context("privacyFooterFromData",()=>{const r=function(e,t,n){let r;const o=sg(_s),i={},s=qO(t,n);"tv"===Dm||Lh(s)?r=sg(Rs):(r=sg(jt),r=r.replace(Os,o),Lh(s)?r=sg(Rs):i[o]=s);const a=new hm(r,mf);return new iS(a,i)}(0,t,n),o=function(e,t,n){if("tv"!==Dm)return[];const r=[],o=qO(t,n);Nh(o)&&r.push(o);const i=GO(t,n);Nh(i)&&r.push(i);return r}(0,t,n);let i=[];return"tv"===Dm&&(i=VO(e,!1,$f,t,n)),new lO(r,o,i.length)})}(e,t,n);return o.items=[i],o})}function WO(e){if(!Mh(e))return null;const t=vx(e,{useCase:12});return Fh(t)?null:(t.crop="sr",t)}class zO{}function jO(e,t,n){let r=0;for(const o of e){const e=t[o.key];if(e){const t=new sy(e.section,!0);t.index=e.index,o.compactAction=t,o.regularAction=t}let i;switch(o.key){case Yc:case Kc:case Hp:case Us:case bc:case su:i="select";break;default:i=_f}o.compactAction&&BS(o.compactAction,{targetType:"badge",id:o.key,idType:oh,actionType:i,actionDetails:{position:r},pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),r+=1}}function YO(e,t,n){const r=dx(e);if(Fh(r))return null;const o=sg("BADGE_CATEGORY_HEADING"),i="tv"===Dm?ns:uh,s=new tP(i,$l,{},"tv"===Dm?Ad:ph,o,r,null,r,o,qf);if(new Bg(hh).title=yI(e,Qp),t&&"tv"!==Dm){const t=sA(e,sn);if(i===uh&&Lh(t))return null;s.artwork=WO(t)}return s}function KO(e,t,n){const r=sA(e,"chartPositions");if(r){const e=function(e){switch(e){case km:case Om:return"appStore";case Em:return Eh;case Cm:return Zf;case Rm:return Is;default:return null}}(host.clientIdentifier);if(e){const t=Hh(r,e);if(t){const e=Vh(t,qs),n=Gh(t,"genreName"),r=Gh(t,th),o=Gh(t,Ll),i=sg("BADGE_CHART_POSITION_HEADING"),s=sg("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",e.toString()),a=new tP(Bs,Bs,{position:ug(e)},ph,i,n,null,s,n,$p),c=function(e,t){return OI((new Ry).forType(Kl).addingQuery("types",Ah).addingQuery(Ll,t).addingQuery(th,e).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}(r,o);if(c){const e=new Bg(ac);e.pageUrl=c,a.compactAction=e,a.regularAction=e}return a}}}return null}function QO(e,t,n){const r=yI(e,Gt);if(r){const n={contentRating:r},o=function(e){if(!e)return null;switch(e){case 6:return"AgeRatingL";case 7:return"AgeRating10";case 8:return"AgeRating12";case 9:return"AgeRating14";case 10:return"AgeRating16";case 11:return"AgeRating18";default:return null}}(II(e,"contentRatingsBySystem.appsBrazil.rank"));let i;o&&(n.contentRatingResource=o),i=sg(t?"BADGE_AGE_RATING_YEARS":"BADGE_AGE_RATING");const s=sg("BADGE_AGE_RATING_HEADING"),a=sg("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE");return new tP(Yc,Yc,n,"tv"===Dm?Ad:ph,s,i,null,r,a,$p)}return null}function JO(e,t,n){let r=null;if(Kh(De)){let t=null,n=null;switch(cA(e,Fu)){case Ni:t=sg("BADGE_SIRI_REMOTE_REQUIRED_OR_CONTROLLER_OPTIONAL_HEADING"),n=sg(Ju),r=new tP(an,an,{},ph,t,n,null,null,n,$p);break;case Mi:t=sg("BADGE_SIRI_REMOTE_REQUIRED_HEADING"),n=sg(Ju),r=new tP(cn,cn,{},ph,t,n,null,null,n,$p);break;case Li:t=sg(ln),n=sg(Ju),r=new tP(un,un,{},ph,t,n,null,null,n,$p);break;case Fi:t=sg(dn),n=sg(Ju),r=new tP(pn,pn,{},ph,t,n,null,null,n,$p)}}else if(Kh("tvRequiresControllerString")&&uA(e,yc)){const e=sg(ln),t=sg(Ju);r=new tP(su,su,{},ph,e,t,null,null,t,$p)}else if(uA(e,xt)){const e=sg(dn),t=sg(Ju);r=new tP(su,su,{},ph,e,t,null,null,t,$p)}if(r){const e=new rP(_h,ju);return r.compactAction=new sy(e),r.regularAction=r.compactAction,r}return null}function XO(e,t,n){const r=_I(e,Lf),o=sg("BADGE_DEVELOPER_HEADING"),i=yI(e,Qp),s="tv"===Dm?ns:uh,a=new tP(s,Lf,{},"tv"===Dm?Ad:ph,o,i,null,i,o,qf);if(t&&"tv"!==Dm){const e=mI(r,sn);s===uh&&Lh(e)?a.artwork=ak("resource://DeveloperBadge",26,26):a.artwork=WO(e)}const c=oL(r);if(Nh(c)){const t=new Bg(hh);t.title=yI(e,Qp),t.pageUrl=c,BS(t,{targetType:_p,id:r.id,actionType:_f,pageInformation:n.pageInformation,locationTracker:n.locationTracker}),a.compactAction=t,a.regularAction=t}return a}function ZO(e,t,n){const r=sA(e,Jl);if(r){const n=Gh(r,Lc);if(n&&n===Fc){let n;let r;n="Games"===gI(e,ks)[0]?sg("EDITORIAL_BADGE_GAMES"):sg("EDITORIAL_BADGE_APPS"),r=sg(t?"EDITORS_CHOICE_RIBBON_HEADING":"EDITORS_CHOICE_SINGLE_LINE");const o=sg("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),i=new tP(Kc,Kc,{},ph,r,n,null,o,n),s=new rP(_h,mh);return i.compactAction=new sy(s),i.regularAction=i.compactAction,i}}return null}function ev(e,t,n){const r=aA(e,"supportedLocales"),o=r.length;if(o<=0)return null;const i={tag:Gh(xh(r,"0.tag")).split("-")[0].toUpperCase(),name:Gh(xh(r,"0.name"))},s={paragraphText:i.tag};let a;a=o>1?sg("BADGE_LANGUAGE_CAPTION").replace("{number_other_languages}",pg(o-1)):i.name;const c=sg("BADGE_LANGUAGE_HEADING");return new tP(tf,Us,s,ph,c,a,null,null,a,$p)}function tv(e,t,n){if(!Kh("multiplayerBadge"))return null;const r=dA(e,cs),o=dA(e,ls);if(!Nh(r)||!Nh(o))return null;if(r<=0||o<=0||r>o)return null;const i=sg(fn),s=rv(r,o,!1),a=rv(r,o,!0),c=sg(fn),l={paragraphText:nv(r,o)};return new tP(tf,gt,l,"tv"===Dm?Ad:ph,i,s,null,a,c,$p)}function nv(e,t){return e===t?e<=32?pg(e):sg("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(Gs,pg(32)):t<=32?sg("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(Gs,pg(e)).replace(hn,pg(t)):sg("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(Gs,pg(e)).replace(hn,pg(32))}function rv(e,t,n){return sg(1===e&&1===t?"BADGE_PLAYERS_CAPTION_SINGLE":1===e||n?"BADGE_PLAYERS_CAPTION_MULTIPLAYER":"BADGE_PLAYERS_CAPTION_REQUIRED")}function ov(e,t,n){if(t&&!Kh("ribbonReviewBadge")&&"tv"!==Dm)return null;const r=mI(e,Vs);let o=null;const i=fC(e);if(!i&&r&&r.value&&r.ratingCount){const e=Vh(r,"value"),t=Math.round(10*e)/10,n=ug(t,1),i=Vh(r,je),s=ag("BADGE_RATING_CAPTION_SHORT_TEMPLATE",i).replace(Qc,pg(i)),a=ag("BADGE_RATING_CAPTION_LONG_TEMPLATE",i).replace(Qc,pg(i)).replace("{rating}",n),c=sg("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",n);o=new tP(Hp,Hp,{rating:t,ratingFormatted:n},ph,s,s,a,c,s)}else{if(t)return null;const e=sg(mn);if(i&&e!==mn)o=new tP(Hp,Hp,{},ph,null,e,null,e);else if(!i){const e=sg("BADGE_NOT_ENOUGH_RATINGS_CAPTION");o=new tP(Hp,Hp,{},ph,null,e,null,e)}}if(o){const e=new rP(_h,mh);return o.compactAction=new sy(e),o.regularAction=o.compactAction,o}return null}const iv=[QO,YO,tv,XO,JO,ev],sv=[ov,ZO,KO,QO],av=[ov,QO,function(e,t,n){if("tv"===Dm)return null;if(!uA(e,Gl))return null;const r=sg("BADGE_FRIENDS_HEADING","Friends"),o={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:e.id};return new tP("friendsPlaying","friendsPlaying",o,"standard",r,"",null,"",r,qf)},KO,YO,tv,XO,JO,ev,function(e,t,n){if(OS.isDeletableSystemAppFromData(e))return null;const r=eL(e);if(!Nh(r))return null;const o=dg(r).trim().split(/\s+/);if(2!==o.length)return null;const i={paragraphText:o[0]},s=o[1],a=sg("BADGE_SIZE_HEADING");return new tP(tf,bc,i,ph,a,s,null,null,s,$p)}],cv=[ov,ZO,JO,KO,QO,YO,tv,XO];function lv(e,t,n){return e?Oh.context("badgesFromLookupResponse",()=>{let r,o=!1;return wI(e,ih)?r=iv:"tv"===Dm?r=cv:t?(r=av,Kh("ribbonEditorsChoice")&&-1===r.indexOf(ZO)&&r.splice(1,0,ZO),o=!0):r=sv,function(e,t,n,r,o){const i=[];for(const r of e){const e=r(t,n,o);e&&i.push(e)}if(r&&i.some(e=>e.key===Bs)){const e=i.findIndex(e=>e.key===$l);e>=0&&i.splice(e,1)}return i}(r,e,t,o,n)}):null}let uv;uv=ask.clientOrdering;const dv=5,pv=5,fv=[new rP(Op),new rP(vp),new rP(_h,_p),new rP(_h,Yu),new rP(_h,Wc),new rP(_h,Ms),new rP(_h,Cd),new rP(_h,Ku),new rP(_h,Qu),new rP(_h,pf),new rP(_h,Rp),new rP(zp),new rP(_h,Sf),new rP(_h,_d),new rP(_h,mh),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ju),new rP(_h,Rd),new rP(_h,fp),new rP(_h,Cp)],hv=[new rP(Op),new rP(vp),new rP(_h,_p),new rP(_h,Yu),new rP(_h,Wc),new rP(_h,Ms),new rP(zp),new rP(_h,Sf),new rP(_h,_d),new rP(_h,Rp),new rP(_h,mh),new rP(_h,pf),new rP(_h,Cd),new rP(_h,Ku),new rP(_h,Qu),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ju),new rP(_h,Rd),new rP(_h,fp),new rP(_h,Cp)],mv=5,gv=5,yv=[new rP(Op),new rP(vp),new rP(_h,_p),new rP(_h,Yu),new rP(_h,Cd),new rP(_h,Wd),new rP(_h,pf),new rP(_h,Rp),new rP(zp),new rP(_h,Sf),new rP(_h,_d),new rP(_h,mh),new rP(_h,Rd),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ju),new rP(_h,Cp),new rP(_h,fp)],Tv=[new rP(Op),new rP(vp),new rP(_h,_p),new rP(_h,Yu),new rP(zp),new rP(_h,Sf),new rP(_h,_d),new rP(_h,Rp),new rP(_h,mh),new rP(_h,Wd),new rP(_h,pf),new rP(_h,Cd),new rP(_h,Rd),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ju),new rP(_h,Cp),new rP(_h,fp)],wv=5,Iv=5,Av=[new rP(Op),new rP(vp),new rP(_h,Rp),new rP(zp),new rP(_h,ru),new rP(_h,pf),new rP(_h,mh),new rP(_h,fp),new rP(_h,Cp),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ou)],Sv=[new rP(Op),new rP(vp),new rP(zp),new rP(_h,ru),new rP(_h,Rp),new rP(_h,mh),new rP(_h,pf),new rP(_h,fp),new rP(_h,Cp),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ou)],bv=5,Pv=5,kv=[new rP(Op),new rP(vp),new rP(_h,Rp),new rP(zp),new rP(_h,ru),new rP(_h,Wd),new rP(_h,pf),new rP(_h,mh),new rP(_h,Cp),new rP(_h,fp),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ou)],Ev=[new rP(Op),new rP(vp),new rP(zp),new rP(_h,ru),new rP(_h,Rp),new rP(_h,mh),new rP(_h,Wd),new rP(_h,pf),new rP(_h,Cp),new rP(_h,fp),new rP(_h,df),new rP(_h,Xp),new rP(_h,Ep),new rP(_h,zf),new rP(_h,If),new rP(_h,ou)],Cv=3,_v=3,Rv=[new rP(Op),new rP(vp),new rP(_h,Cd),new rP(zp),new rP(_h,Sf),new rP(_h,df),new rP(_h,Xp),new rP(_h,jc)],Ov=[new rP(Op),new rP(vp),new rP(zp),new rP(_h,Sf),new rP(_h,Cd),new rP(_h,df),new rP(_h,Xp),new rP(_h,jc)];function vv(e,t,n,r){const o=function(e,t){switch(e){case id:return t?l:c;case fs:return u;case Yf:case Ef:return t?a:s;default:return s}}(t,n),i=e?o.purchasedOrdering.slice():o.notPurchasedOrdering.slice(),d=e?o.purchasedSpotlightIndex:o.notPurchasedSpotlightIndex;if(r&&r.spotlightSection){const e=function(e,t){let n=0;for(const r of t){if(r.type===e.type){if(r.type!==_h)return n;if(r.shelfId===e.shelfId)return n}n+=1}return-1}(r.spotlightSection,i);-1!==e&&(i.splice(e,1),i.splice(d,0,r.spotlightSection))}return i}function Dv(e){return new rP(_h,e?Ku:Qu)}class xv extends yb{constructor(){super("ProductBuilder")}defaultPlatforms(){return Ey()}pageType(){return of}defaultTab(e){return xv.representsArcadeApp(e)?Th:super.defaultTab(e)}defaultAction(e,t,n){if(e instanceof Bg)return e;const r=super.defaultAction(e,t,n);if(!(e instanceof iP))return r;const o=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0];if(t[lw]!==Lv||o){if(t[lw]!==Fv||o)return r;{const t=e.shelfMapping[mh];let n=null;return t&&t.seeAllAction&&(n=t.seeAllAction,n.animationBehavior=Wp),r.animationBehavior=Wp,new Hg([r,n])}}{const t=xv.representsBundle(e),n=yC(e.adamId,t,e.icon);return r.animationBehavior=Wp,new Hg([r,n])}}static allPageRoutes(){return[{protocol:Gy.https,path:`/{countryCode}/${aT}/{appName}/{id}`,query:[lw+"?",iw+"?",Fw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${lT}/{appName}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${aT}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${lT}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/${aT}/{appName}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/${lT}/{appName}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/${aT}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,path:`/${aT}/{id}`,query:[cw+"?"]},{protocol:Gy.https,path:`/${lT}/{id}`,query:[lw+"?",iw+"?"]},{protocol:Gy.https,query:[rw]},{protocol:Gy.https,query:[lw,QT,bw+"?"]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:Gy.https,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[]},{protocol:Gy.https,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:Gy.https,hostName:""+qT,path:`/${cT}/{id}`,query:[]},{protocol:Gy.https,path:`/${Hy}/${Qy}`,query:[KT,cw+"?"]}]}static generateProductPageOptions(e,t){const n={clientIdentifierOverride:t.query[Ow]},r=e[iw];if(r){const t=e[Zw]===Fp;n.spotlightSection=Dv(t),n.spotlightInAppProductIdentifier=r}const o=t.query["X-AppStore-iAdClickToken"];o&&(n.iAdClickFields=JSON.parse(o));const i=t.query["X-AppStore-iAdLineItem"];i&&(n.iAdLineItem=i);const s=t.query.externalDeepLinkUrl;return Nh(s)&&(n.externalDeepLinkUrl=s),n}get pageRoute(){return xv.allPageRoutes()}generatePageRequest(e,t){const n=t[rw],r=t[QT];let o=null;if(o=n?function(e){const t=ZS;return Kh(zc)&&Xh.enablePrivacyNutritionLabels&&!JS.shouldSuppressPrivacyInformationForBundleId(e)&&t.push(Wu),by&&t.push(Jf),(new Ry).forType(Ah).withFilter(bf,e).includingAdditionalPlatforms(Ey()).includingRelationships([Lf,nu,au,mh,gh,Zc,nl,iu,Gc]).includingAttributes(t).addingRelationshipLimit(mh,Cy()).includingMacOSCompatibleIOSAppsWhenSupported(!0)}(n):"lookup"===t[lw]&&r?function(e,t){const n=ZS;Kh(zc)&&Xh.enablePrivacyNutritionLabels&&!JS.shouldSuppressPrivacyInformationForAdamId(e)&&n.push(Wu),by&&n.push(Jf);const r=(new Ry).forType(Ah).addingQuery("ids",e).includingAdditionalPlatforms(Ey()).includingAttributes(n).includingRelationships([Lf,nu,au,mh,gh,Zc,nl,iu,Gc]).addingRelationshipLimit(mh,Cy()).includingMacOSCompatibleIOSAppsWhenSupported(!0);return t&&r.addingQuery("availability",g),r}(r,Wh(t,bw)):ib(e),Lh(o))throw new Error(`Unable to map ${e.build()} to a media api url`);return o}renderPage(e,t,n){return Oh.context(Kp,()=>{const n=aP(kd,"",e),r=xv.generateProductPageOptions(t,new uI(n.pageUrl)),o=bb(e),i=xv.alternativeAppForPlatform(o,fA());return null===i||Dm===Ch&&!Kh("alternateAppRedirect")?sD(e,r):i})}get shelfRoute(){return[{protocol:Gy.internal,path:`/${aT}/${Vy}/{token}`}]}generateShelfRequest(e,t){const n=t[Kf],r=JSON.parse(n);let o;if(r.isBundleShelf)o=gh;else switch(r.contentType){case yp:case Bd:o=rh;break;case Lu:o=Tf;break;default:o=Ah}const i=[lh,sh,Xf];return by&&i.push(Jf),(new Ry).forType(o).withIds(r.ids).includingAdditionalPlatforms(Ey()).includingAttributes(o===Tf?[]:i)}renderShelf(e,t){const n=t[Kf],r=JSON.parse(n),o=xv.shelfFromDataContainer(e,r);if(o.mergeWhenFetched=!0,r.shouldInferSeeAllFromFetchesItems){const e=new Bg(hh);e.title=sg(Tp);const t=new bS(o.contentType);t.items=function(e,t){if(!e)return null;const n=[];for(const r of e){const e=wA(r);t&&e.offerDisplayProperties&&(e.offerDisplayProperties=e.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,t)),n.push(e)}return n}(o.items,qf);const n=new wP([t]);lP(n,r.destinationPageInformation),n.title=r.title,e.pageData=n,qS(e,null,{pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker}),o.seeAllAction=e}return o}shelfRequiresAdditionalModification(e,t){return!0}performAdditionalShelfModifications(e,t){return new Promise(n=>{const r=t[Kf],o=JSON.parse(r),i=e.items;if(o.contentType===Lu&&i){const t=[],r=[];for(const e of i){const n=e.productIdentifier;Dv(e.isSubscription).shelfId===o.inAppShelfId&&(t.push(n),e.isVisibleByDefault&&r.push(n))}(s=o.appBundleId,a=t,c=r,l=o.spotlightInAppProductIdentifier,new Promise((e,t)=>{const n=a.filter(e=>null!=e),r=c.filter(e=>null!=e);uv.orderedVisibleIAPs(s,n,r,l,(n,r)=>{r?t(r):e(n)})})).then(t=>{e.items=xv.filteredInAppLockupsUsingOrdering(i,t),n(e)})}else{new Set([yp,Bd]).has(e.contentType)&&0===e.items.length&&(e.isHidden=!0),n(e)}var s,a,c,l})}static alternativeAppForPlatform(e,t){if(!bI(e,t)){const n=RI(e,Gc);if(Mh(n))for(const e of n){const n=cA(e,Sh);if(bI(e,t)&&Mh(n))return new Bg(dh,n)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Jd in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[Jd]===rn}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Jd in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[Vc]===ap}static filteredInAppLockupsUsingOrdering(e,t){const n={};for(const t of e)n[t.productIdentifier]=t;const r=[];for(const e of t){const t=n[e];if(t){const e=wA(t);r.push(e)}}return r}static shelfFromDataContainer(e,t){return Oh.context("shelfFromLookupResponse",()=>{const n=new bS(t.contentType),r={pageInformation:t.sourcePageInformation,locationTracker:t.sourceLocationTracker,excludeAttribution:!0};let o;switch(t.contentType){case Bd:const n=SE(e.data,r.pageInformation,r.locationTracker,Hv);Nh(n)&&(o=[n]);break;case yp:const i={metricsLocationTracker:r.locationTracker,metricsPageInformation:r.pageInformation,filterOutMediaCardKinds:xv.filteredMediaCardKindsForSmallStoryCardOnPlatform(host.platform)},s={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};s.videoPlaybackControls=RS,s.videoAutoplayPlaybackControls=RS,o=TE(e.data,t.contentType,i,null,s);break;default:const a={metricsOptions:r,offerStyle:t.offerStyle,artworkUseCase:Ox(t.contentType),canDisplayArcadeOfferButton:DL(t.contentType)};t.contentType===Lu&&(a.skipDefaultClickAction=!0);const c={lockupOptions:a};t.isBundleShelf&&(c.filter=0);const l=Ix(e,c),u={[Em]:"round",[Cm]:"pill"}[host.clientIdentifier];u&&l.sort((e,t)=>{const n=e.icon.style===u,r=t.icon.style===u;return n&&r?0:n&&!r?-1:1});const d=t.spotlightInAppProductIdentifier;d&&Gv(d,l),o=l}return n.items=o,n})}static filteredMediaCardKindsForSmallStoryCardOnPlatform(e){const t=new Set([zu]);return e===Ef&&(t.add(Zp),t.add("list"),t.add(Kd),t.add("river")),t}}const Lv="write-review",Fv=mh,Nv=Ny(xy("F0F0F8"),xy(Hc));class Mv{constructor(e,t,n,r,o,i){this.isBundleShelf=!1,this.ids=e,this.title=t,this.shouldInferSeeAllFromFetchesItems=n,this.contentType=r,this.offerStyle=o,this.spotlightInAppProductIdentifier=i}}function Uv(e,t,n){const r=e.ids;return r&&r.length?`${Gy.internal}:/${aT}/${Vy}/`+Bv(e,t,n):null}function Bv(e,t,n){return e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function qv(e,t,n,r,o,i){if(!e.data||0===e.data.length)return null;const s=[],a=Ix(e,{lockupOptions:{...{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker},artworkUseCase:n,canDisplayArcadeOfferButton:DL(r)},...Lh(o)?{}:{offerStyle:o}},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(s.push(e),!1),filter:i});if(Dm===Eh){const e=a.slice(0,3);return{items:e,unavailableIds:e.length<3?s.slice(0,3-e.length):[]}}return{items:a,unavailableIds:s}}function Gv(e,t){if(!t)return;let n=-1,r=null;t.forEach((t,o)=>{const i=t,s=i,a=i&&i.adamId===e,c=s&&s.productIdentifier===e;(a||c)&&(n=o,r=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Np,"ad",Yl)))}),-1!==n&&(t.splice(n,1),t.splice(0,0,r))}const Vv=[Zp,Ed,uh,lf];function Hv(e){if(-1===Vv.indexOf(e.media.kind))return!1;const t=e.clickAction;if(!t)return!0;const n=t.pageUrl;if(!n)return!0;const r=new uI(n),o=xv.allPageRoutes();for(const e of o){if(new NP(e).matches(r))return!1}return!0}class $v{constructor(e,t){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t}addImpressionsToShelf(e,t){mA(e,{id:""+this.sequenceId,kind:null,softwareType:null,targetType:t,title:e.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n){if(!e)return;mA(e,{id:$v.similarItemsShelfId,kind:null,softwareType:null,targetType:t,title:e.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:n}),this.sequenceId++}}function Wv(e,t,n){return Oh.context(mp,()=>function(e,t,n,r,o){return Oh.context("standardMostRecentVersionShelf",()=>{if(!t&&!n&&!r){const t=aA(e,Od);if(t.length>1){if(jv(t).length>0){const n=new bS(bn);n.title=sg(Sn);const r=Yv(t[0],"overview");if(n.items=[r],o.addImpressionsToShelf(n,Od),n)return Dm!==Eh&&(n.seeAllAction=function(e,t,n){return Oh.context("versionHistorySeeAllAction",()=>{const r=zv(e,t);return qS(r,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),r})}(t,e.id,o)),n}}}return null})}(e,n.isFirstPartyHideableApp,n.isBundle,n.isPreorder,t))}function zv(e,t){return Oh.context("versionHistoryPageAction",()=>{const n=jv(e);let r;if(n.length>0){const e=new bS(bn);e.items=n;const o=new wP([e]);o.title=sg("VERSION_HISTORY_PAGE_TITLE","Version History"),Dm!==Eh&&(o.presentationOptions=[Vd]);lP(o,cP("VersionHistory",t,""));const i=new Bg(Od);i.title=sg("ACTION_VERSION_HISTORY_SEE_ALL"),i.pageData=o,r=i}return r})}function jv(e){return e?e.map(e=>Yv(e,"detail")):[]}function Yv(e,t){return Oh.context("titledParagraphFromVersionHistoryEntry",()=>{const n=Gh(e,"releaseNotes"),r=new eS(n,t),o=Gh(e,Pn),i=sg("VERSION_STRING_TEMPLATE");switch(t){case"detail":r.primarySubtitle=o;break;default:r.primarySubtitle=i.replace("{version}",o)}const s=Gh(e,Ap);if(s){const e=new Date(s);r.secondarySubtitle=function(e){let t=tg.relativeDate(e);return t||(t="* null *"),t}(e)}return r})}function Kv(e,t,n){return Oh.context("createActionLinks",()=>Fh(e)?null:Dm===Eh?function(e,t,n,r,o,i,s,a,c){return Oh.context("actionLinkShelf",()=>{const l=new bS(hf),u=[];if(r){const n=CI(e,mh),r=mI(e,Vs);r.ratingAverage=Vh(r,"value"),r.adamId=e.id,r.isBundle=i,r.supportUrl=cA(e,Jc);const o=Pb(n),s=Lx(e,{useCase:2}),a=PC(Fm,r,o,n.next,t,s);a.title=sg(Hi),u.push(a)}const d=aA(e,Od);if(d.length>0&&!o&&!i&&!s){const t=zv(d,e.id);BS(t,Qv(e.id,n)),u.push(t)}const p=_O(e,o,null,null,a,!1,c),f=new wP([p]),h=new Bg(hh);h.title=sg(Hs),f.title=h.title,n.addImpressionsToShelf(l,zf);lP(f,uP(e.id,"info")),BS(h,Qv(e.id,n)),h.pageData=f,u.push(h);const m=Zx(e,c);if(m.length>0){const t=new bS(Tn);t.items=m;const r=new wP([t]),o=new Bg(hh);o.title=sg($s),r.title=o.title,n.addImpressionsToShelf(l,Ws);lP(r,uP(e.id,Ws)),BS(o,Qv(e.id,n)),o.pageData=r,u.push(o)}const g=cA(e,Zl);if(g){const t=new Vg(g,!1);BS(t,Qv(e.id,n)),t.title=sg(hc),u.push(t)}return l.items=u,n.addImpressionsToShelf(l,jc),u.length>0?l:null})}(e,n.productTitle,t,n.shouldShowRatingsAndReviews,n.isFirstPartyHideableApp,n.isBundle,n.isPreorder,n.useInlineUberStyle,n.isFreeProduct):null)}function Qv(e,t){return{targetType:wh,actionType:_f,id:e,pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker}}function Jv(e,t,n){return Oh.context("descriptionShelf",()=>{if(Fh(e))return null;const r=new bS("productDescription"),o=function(e){if(!e)return null;return Oh.context("productDescriptionLinksFromData",()=>{const t=[],n=cA(e,Xc);if(n){const e=new Vg(n,!1),r=sg("PRODUCT_DEVELOPER_WEBSITE");t.push(new sS(r,e,Lf))}const r=cA(e,Jc);if(r){const e=new Vg(r,!1),n=sg("DEVELOPER_SUPPORT");t.push(new sS(n,e,"support"))}return t})}(e),i=Xv(e);if(null===i)return null;const s=new HA(i,o,n.developerAction);return r.items=[s],Dm===Eh&&(r.title=sg("PRODUCT_DESCRIPTION")),t.addImpressionsToShelf(r,Sf),r})}function Xv(e){return Oh.context("descriptionFromData",()=>{let t=cA(e,wn);t||(t="");let n=cA(e,Hl);n||(n="");let r="";t.length>0&&n.length>0&&(r="\n\n");const o=t+r+n;if(o.length>0){const e=new mm(o);return e.isCollapsed=!0,e}return null})}function Zv(e,t,n){const r=Dm===kh||Dm===Ph?8:20,o=new bS(An);o.isHorizontal=!0;let i=null;i=t?e.slice(0,r):e;const s=[];for(let e=0;e<i.length;e++){const t=i[e];if(t.action=new hy(t.playerId),Mh(n)){mA(t,{pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:"friendPlayer",title:"",id:"",idType:oh,softwareType:null,anonymizationOptions:{anonymizationString:"FRIEND"+(e+1)}})}s.push(t),Mh(n)&&tA(n.sourceLocationTracker)}if(o.items=s,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=nf,e.length>r){const t=new bS("smallGameCenterPlayer");t.title=ag("PRODUCT_FRIENDS_PLAYING_SEE_ALL_TITLE",e.length),t.items=e.map(e=>(e.action=new hy(e.playerId),e)),t.rowsPerColumn=1;const n=new Bg(hh);n.title=sg(Tp),n.pageData=new wP([t]),o.seeAllAction=n}if(Mh(n)){mA(o,{id:"",kind:null,softwareType:null,targetType:ah,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:oh,badges:{gameCenter:{}}})}return o}function eD(e,t,n){return Oh.context("inAppPurchasesShelf",()=>{if(host.platform===Ef)return null;if(Fh(e))return null;const r=CI(e,Zc);if(!r||!r.data.length)return null;if(!r.data.filter((function(e){return wI(e,Nc)===n.isForSubscriptions})).length)return null;const o={pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},i=TI(e,ih);let s=qf;i&&(s=Su);const a=new bS("inAppPurchaseLockup");let c=null;n.options&&(c=n.options.spotlightInAppProductIdentifier),function(e,t){for(const n of t.data){let t=CI(n,"app");t||(t={data:[e]}),Lh(n.relationships)&&(n.relationships={}),n.relationships.app=t}}(e,r);const l=[];if(a.items=function(e,t,n,r,o){const i=Ix(e,{lockupOptions:{metricsOptions:n,offerStyle:t,skipDefaultClickAction:!0,artworkUseCase:1},contentUnavailable:o});r&&Gv(r,i);return i}(r,s,o,c,(function(e){return l.push(e),!1})).filter((function(e){return e.productIdentifier===c&&(n.options.spotlightSection=new rP(_h,n.isForSubscriptions?Ku:Qu)),e.isSubscription===n.isForSubscriptions})),l.length){const r=new Mv(l,a.title,!1,"inAppPurchaseLockup",s,null);r.appBundleId=cA(e,bf),n.isForSubscriptions?r.inAppShelfId=Ku:r.inAppShelfId=Qu,a.url=Uv(r,t)}let u;return n.isForSubscriptions?(a.title=sg("PRODUCT_SECTION_SUBSCRIPTIONS","Subscriptions"),u="subscription"):(a.title=sg("PRODUCT_SECTION_IN_APP_PURCHASES"),u="iAP"),JI(o,a.title),ZI(t.locationTracker),tA(t.locationTracker),a.isHorizontal=!0,t.addImpressionsToShelf(a,u),a})}function tD(e,t,n){return Oh.context(mp,()=>Dm===Eh||Fh(e)?null:function(e,t,n,r,o,i,s){return Oh.context("standardReviewsShelf",()=>{let n=null;const r=$x(e);let a;var c;if(uL(e)||(c=e,a=Oh.context("editorsChoiceItem",()=>{const e=Gh(sA(c,Dc),ph);if(e){const t=new lC(e),n=sA(c,Jl);if(n){const e=Gh(n,Lc);t.showsBadge=e&&e===Fc}return t.showsBadge||(t.title=sg(tl)),t}return null})),a&&!i){const t=new uC;return t.adamId=e.id,t.editorsChoice=a,n=new bS(Ke),n.items=[t],n}if(i){const n=CI(e,mh),i=mI(e,Vs);i.ratingAverage=Vh(i,"value"),i.adamId=e.id,i.isBundle=o,i.supportUrl=cA(e,Jc);const c=Lx(e,{useCase:2}),l=1===r.length&&"tv"===r[0];return function(e,t,n,r,o,i,s,a){return Oh.context("reviewsContainerShelf",()=>{const c={pageInformation:a.metricsPageInformation,locationTracker:a.locationTracker},l=kC();JI({pageInformation:a.metricsPageInformation,locationTracker:a.locationTracker,targetType:ah,id:""+a.getSequenceId(),idType:oh},l);const u=Pb(t),d=wC(Fm,e,u,n,r,o,t.next,i,!1,null,s);return d.title=l,a.addImpressionsToShelf(d,el),d.seeAllAction&&qS(d.seeAllAction,null,c),ZI(a.locationTracker),tA(a.locationTracker),d})}(i,n,t,c,a,!l,l,s)}return null})}(e,n.productTitle,n.isPreorder,n.isFirstPartyHideableApp,n.isBundle,n.shouldShowRatingsAndReviews,t))}function nD(e,t){return Oh.context(mp,()=>{if("tv"!==Dm)return null;if(Fh(e))return null;const n=new bS(tf);n.isHorizontal=!1;const r=function(e){if(!e)return null;return Oh.context("externalProductLinksAsParagraphsFromData",()=>{const t=[],n=cA(e,Xc);if(n){const e=sg("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",n),r=new mm(e);r.alignment=yf,t.push(r)}return t})}(e);return r&&r.length>0&&(n.items=r),t.addImpressionsToShelf(n,If),n})}$v.similarItemsShelfId=nu;const rD=[function(e){const t=yI(e,bh),n=ax(e),r=Xv(e).text;return oD(up,t,n,r,t)},function(e){const t=Gh(sA(e,Dc),ph);if(t){let n=null,r=null,o=up;const i=sA(e,Jl);if(i){const e=Gh(i,Lc);e&&e===Fc&&(o=Kc);const t=Gh(i,"nameForDisplay");r=t||sg(tl)}else n=sg(tl),r=sg(tl);return oD(o,n,"",t,r)}return null},function(e){const t=e.type===gh,n=wI(e,gd),r=TI(e,ih),o=function(e,t,n,r){if(!t&&!n&&!r){const t=aA(e,Od);if(t.length>1){if(jv(t).length>0)return Yv(t[0],"overview")}}return null}(e,n,t,r);if(o){const e=o.primarySubtitle,t=o.text,n=sg(Sn);return oD(up,n,e,t,n)}return null}];function oD(e,t,n,r,o){const i=new nP(e,t,n,r);if(Kh("textCardBodyParagraph")){i.body="";const e=new mm(r);e.isCollapsed=!0,i.bodyParagraph=e}const s=new mm(r);return s.wantsCollapsedNewlines=!1,i.regularAction=new ry(o,s),i}function iD(e,t,n){return Oh.context("createProductPageSidePackFromResponse",()=>{if(!Hm)return null;const r=function(e,t){const n=yI(e,Sh),r=yI(e,bh),o=yI(e,Qp);let i=null;t&&(i=t.iAdClickFields);const s=cP(kd,e.id,`${o}_${r}`,i);s.pageUrl=n;const a={rootPosition:0,locationStack:[]};return new $v(s,a)}(e,t),o=aD(e,r,t,n);var i,s;return i=o,Lh(s=r.metricsPageInformation)||i.pageMetrics.addData(gP(s,null),["backButton"]),o})}function sD(e,t){return Oh.context("createProductPageFromResponse",()=>{const n=bb(e);if(Fh(n))return null;const r=n.type===gh;if(Dm===Eh&&r)throw new sO("Bundles are not supported on watchOS");const o=function(e,t){const n=bb(e),r=n.type===gh;Nh(t)&&(t.iAdClickFields&&(e["X-AppStore-iAdClickToken"]=JSON.stringify(t.iAdClickFields)),t.iAdLineItem&&(e["X-AppStore-iAdLineItem"]=t.iAdLineItem));const o=aP(r?rn:kd,n.id,e),i={rootPosition:0,locationStack:[]};return new $v(o,i)}(e,t),i=aD(n,o,t),s=zI(n,i.icon);o.metricsPageInformation.baseFields[$c]=s;const a=$x(n);lP(i,o.metricsPageInformation,e=>{const t=Wx(n,by),r=Qx(n,by,Py),o=a&&(Kx(a,Dm,t,r)||Jx(a,Dm,t)),i=function(e,t,n){if(!Cx(e))return!1;if(vS(e,33414))return!1;const r=Wx(e,n),o=jx(t,r),i=$x(e);return o.some(e=>Yx(i,e))}(n,Dm,by);e[Ns]=o&&i?"runnable":o?"purchasable":kf});const c=Uk(n),l={pageInformation:o.metricsPageInformation,locationTracker:o.locationTracker,id:n.id,isAdvert:!!o.metricsPageInformation.iAdInfo&&o.metricsPageInformation.iAdInfo.iAdIsPresent},u=TI(n,ih),d=qk(c,n,u,s,l);let p,f;if(Mh(d)){let r;Nh(t)&&(r=t.clientIdentifierOverride),d.lineItem=Gh(e,"X-AppStore-iAdLineItem"),p=Wk(d,n,u,l,$f,!1,r)}if(Nh(t)&&Mh(t.externalDeepLinkUrl)&&Mh(p)){const e={pageInformation:o.metricsPageInformation,locationTracker:o.locationTracker};p=xk(p,d.adamId,t.externalDeepLinkUrl,e)}if(i.buttonAction=p,r){f=function(e,t){return e?Oh.context("bundleChildrenShelf",()=>{let n;n=new bS("smallLockup"),n.isHorizontal=!0;const r=e.data.length;if(!r)return null;n.title=ag("APPS_IN_BUNDLE",r);const o=qv(e,t,1,"smallLockup",null,54782);if(o.unavailableIds.length){const e=new Mv(o.unavailableIds,n.title,!1,ch,qf,null);e.isBundleShelf=!0,n.url=Uv(e,t)}return JI({pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},n.title),n.items=o.items,ZI(t.locationTracker),tA(t.locationTracker),n.rowsPerColumn=r<2||"tv"===Dm?1:2,t.addImpressionsToShelf(n,Wc),n}):null}(CI(n,Ah),o)}f&&(i.shelfMapping[Wc]=f);const h=function(e,t){return e?Oh.context("bundleParentsShelf",()=>{let n;const r=e.data.length;if(!r)return null;n=new bS("smallLockup"),n.isHorizontal=!0,n.title=sg("INCLUDED_IN_BUNDLES").replace(Qc,r.toString());const o=qv(e,t,1,"smallLockup");if(0===o.unavailableIds.length&&0===o.items.length)return null;if(n.items=o.items,o.unavailableIds.length){const e=new Mv(o.unavailableIds,n.title,!1,"smallLockup",qf,null);e.isBundleShelf=!0,n.url=Uv(e,t)}return n.rowsPerColumn=r<2||"tv"===Dm?1:2,t.addImpressionsToShelf(n,"bundleParent"),n}):null}(CI(n,gh),o);h&&(i.shelfMapping[Ms]=h);const m=!(1===a.length&&a[0]===Ch)||Dm===Ch,g=fC(n),y=m&&!u&&!g,T=wI(n,gd),w={productTitle:i.title,shouldShowRatingsAndReviews:y,isFirstPartyHideableApp:T,isBundle:r,isPreorder:u},I=tD(n,o,w);I&&(i.shelfMapping[mh]=I);const A=Wv(n,o,{isFirstPartyHideableApp:T,isBundle:r,isPreorder:u});A&&(i.shelfMapping[Cd]=A),i.shelfMapping[ru]=function(e,t){return Oh.context("textCardShelfFromResponse",()=>{if(Fh(e))return null;let n;if("tv"!==Dm)return null;n=rD;const r=new bS("textCard");return r.title=sg("PRODUCT_SECTION_TEXT_CARDS"),r.items=function(e,t){const n=[];for(const r of e){const e=r(t);e&&n.push(e)}return n}(n,e),r.isHorizontal=!0,t.addImpressionsToShelf(r,If),r})}(n,o);const S=cA(n,bf);if(Kh(zc)&&Xh.enablePrivacyNutritionLabels&&!JS.shouldSuppressPrivacyInformationForAdamId(n.id)&&!JS.shouldSuppressPrivacyInformationForBundleId(S)){const e=(b=n,P=o.metricsPageInformation,k=o.locationTracker,Oh.context("privacyShelf",()=>{if(Fh(b))return null;const e=new bS(df);e.title=Dm===Eh?lg(sg(eu)):sg(eu);const t=UO(b,!1,!1,P,k);return e.items=[t],Dm!==Eh&&"tv"!==Dm&&(e.seeAllAction=HO(b,kp,P,k,null)),e})),t=function(e,t){return Oh.context(mp,()=>{if(Fh(e)||Dm===Eh)return null;const n=mI(e,Wu);if(Fh(n))return null;const r=new bS(Bc),o=sg(eu);JI({pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:vs,id:""+t.getSequenceId(),idType:oh},o);const i=vO(n,e,$f,!0,t.metricsPageInformation,t.locationTracker);return 0===i.length?null:(r.items=i,i.length<=2&&(r.presentationHints={isLowDensity:!0}),r.title=o,t.addImpressionsToShelf(r,"appPrivacy"),ZI(t.locationTracker),tA(t.locationTracker),r.title=null,r)})}(n,o);if(Nh(e)&&(Nh(t)||Dm===Eh)){i.shelfMapping[df]=e,Nh(t)&&(i.shelfMapping[Xp]=t);const r=$O(n,o.metricsPageInformation,o.locationTracker);Nh(r)&&(i.shelfMapping[Ep]=r)}}var b,P,k;const E=new zO,C=new zO,_=new zO,R=uL(n),O=lD(R),v=i.offerDisplayProperties,D=!Nh(v)||v.isFree,x=_O(n,T,o,(e,t)=>{if(e===gO&&(E.index=t,E.section=new rP(_h,zf)),e===hO&&Nh(i.banner)){Nh(i.banner.fullProductAction)&&(i.banner.action=i.banner.fullProductAction);const e=i.banner.action;Nh(e)&&e instanceof sy&&Mh(e.section.shelfId)&&e.section.shelfId===zf&&e.indexId===qc&&(e.index=t)}e===TO&&(C.index=t,C.section=new rP(_h,zf)),e===IO&&(_.index=t,_.section=new rP(_h,zf))},O,!1,D);if(x&&(i.shelfMapping[zf]=x),R){const e=function(e,t){if(Fh(e))return null;const n=Gh(sA(e,Dc),ph);if(n){const e=sg("APP_STORE_EDITORS_ATTRIBUTION"),r=new hS(n,e),o=new bS(_d);return o.items=[r],t.addImpressionsToShelf(o,_d),Dm!==kh&&Dm!==Ph||(o.background={type:gp,color:Fy("componentBackgroundStandout")}),o}return null}(n,o);e&&(i.shelfMapping[_d]=e)}i.shelfMapping[If]=RO(n,o,D),i.shelfMapping[ou]=nD(n,o);const L=function(e,t,n){return Oh.context("capabilitiesShelf",()=>{if(Fh(e))return null;let r;const o=Zx(e,n);return o.length>0&&(r=new bS(Tn),r.title=sg($s),r.items=o,t.addImpressionsToShelf(r,Ws)),r})}(n,o,D);L&&(i.shelfMapping[ju]=L);const F=CI(n,iu),N=Dm===Ch||Kh(Eu)?function(e,t){return Oh.context("smallStoryShelf",()=>{if(!e||!e.data.length)return null;const n={pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},r=sg(In);JI(n,r);const o=[],i={metricsLocationTracker:n.locationTracker,metricsPageInformation:n.pageInformation,filterOutMediaCardKinds:new Set([zu])},s=wE(e.data,yp,r,null,i,(function(e){return o.push(e.id),!1}));if(s.isHorizontal=!0,o.length){const e=new Mv(o,s.title,!1,yp);s.url=Uv(e,t)}return ZI(t.locationTracker),t.addImpressionsToShelf(s,Rd),tA(t.locationTracker),s})}(F,o):function(e,t){function n(e,t,n){return SE(e.data,t.pageInformation,t.locationTracker,Hv,n)}return Oh.context("featuredInShelf",()=>{if(Fh(bb(e)))return null;const r={pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},o=new bS(Bd),i=sg(In);o.title=i,o.isHorizontal=!1;const s=[];if(o.items=[n(e,r,(function(e){return s.push(e.id),!1}))],s.length){const e=new Mv(s,o.title,!1,Bd);o.url=Uv(e,t)}return JI(r,i),t.addImpressionsToShelf(o,Rd),ZI(t.locationTracker),tA(t.locationTracker),o})}(F,o);N&&(i.shelfMapping[Rd]=N);const M={isPreorder:u},U=new zO,B=function(e,t,n){return Oh.context("friendsPlayingShelf",()=>{if(Fh(e))return null;const r=e.id;if(Fh(r))return null;if(!uA(e,Gl))return null;if(n.isPreorder)return null;const o=sg("PRODUCT_SECTION_FRIENDS_PLAYING_TITLE","Playing This Game");JI({pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},o);const i=new bS(An);Kh(xl)?(i.eyebrow=lg(sg(Pc)),i.eyebrowArtwork=ak("tv"===Dm?Vi:kc,16,16)):i.subtitle=sg("PRODUCT_SECTION_FRIENDS_PLAYING_SUBTITLE","Join in with your Game Center friends"),i.title=o,i.isHorizontal=!0,i.items=[],i.mergeWhenFetched=!0;const s=new Mv([],i.title,!1,null,null,null);i.url=`${Gy.internal}:/${aT}/${Vy}/?${gw}=true&${KT}=${r}&${qw}=${Bv(s,t,t.metricsPageInformation)}`,i.batchGroup=nf,t.addImpressionsToShelf(i,pf),ZI(t.locationTracker),tA(t.locationTracker);return qS(new Bg(hh),null,{pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker}),i})}(n,o,M);B&&(i.shelfMapping[pf]=B,U.section=new rP(_h,pf));const q=function(e,t,n){return Oh.context("achievementsShelf",()=>{if(Fh(e))return null;if(n.isPreorder)return null;if(!uA(e,Gl))return null;const r=pA(e),o=kI(e,r,bf);if(Fh(o))return null;const i=sg("PRODUCT_SECTION_ACHIEVEMENTS",gn),s=new bS(yn);Kh(xl)&&(s.eyebrow=lg(sg(Pc)),s.eyebrowArtwork=ak("tv"===Dm?Vi:kc,16,16)),s.title=i,s.isHorizontal=!0,s.items=[],s.mergeWhenFetched=!0;const a=new Mv([],s.title,!1,null,null,null);return a.sourceLocationTracker=t.locationTracker,a.destinationPageInformation=t.metricsPageInformation,s.url=`${Gy.internal}:/${aT}/${Vy}/?${Tw}=true&${ow}=${o}&${qw}=${Bv(a,t,t.metricsPageInformation)}`,s.batchGroup=nf,tA(t.locationTracker),s})}(n,o,{isPreorder:u});q&&(i.shelfMapping[Wd]=q);const G=function(e,t){return Oh.context("moreByDeveloperShelf",()=>{if(Fh(e))return null;let n;const r=oL(_I(e,Lf)),o=yI(e,Qp),i=CI(e,au);if(!i||0===i.data.length)return null;const s=sg("MORE_BY_DEVELOPER_TEMPLATE").replace("{developer}",o);let a;switch(JI({pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:ah,id:""+t.getSequenceId(),idType:oh},s),Dm){case Ch:case"tv":a=Of;break;default:a=ch}n=new bS(a),n.title=s;const c=qv(i,t,Ox(a),a,Qf);if(!c)return null;if(n.items=c.items,c.unavailableIds&&c.unavailableIds.length){const e=new Mv(c.unavailableIds,n.title,!1,a,Qf,null);n.url=Uv(e,t)}if("tv"!==Dm){const e=new Bg(hh);e.pageUrl=r,e.title=sg(Tp),qS(e,e.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker}),n.seeAllAction=e}return n.isHorizontal=!0,i.data.length<2||"tv"===Dm?n.rowsPerColumn=1:n.rowsPerColumn=2,n.background={type:gp,color:Nv},t.addImpressionsToShelf(n,Lf),ZI(t.locationTracker),tA(t.locationTracker),n})}(n,o);G&&(i.shelfMapping[fp]=G);const V=function(e,t){return Oh.context("similarItemsShelf",()=>{if(Fh(e))return null;let n;const r=CI(e,nu);if(!r||!r.data.length)return null;const o=sg("SIMILAR_ITEMS_TITLE");let i,s;switch(JI({pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,targetType:"similarItems",id:$v.similarItemsShelfId,idType:"relationship"},o),Dm){case"tv":i=Of,s=!1;break;case Ch:i=Of,s=!0;break;default:i=ch,s=!0}n=new bS(i),n.title=o;const a=qv(r,t,Ox(i),i,Qf);if(n.items=a.items,a.unavailableIds.length){const r=new Mv(a.unavailableIds,n.title,s,i,Qf,null),o=cP("SimilarItems",e.id,"");n.url=Uv(r,t,o)}return n.isHorizontal=!0,r.data.length<2||"tv"===Dm?n.rowsPerColumn=1:n.rowsPerColumn=2,n.background={type:gp,color:Nv},t.addImpressionsFieldsToSimilarItemsShelf(n,"similarItems","relationship"),ZI(t.locationTracker),tA(t.locationTracker),n})}(n,o);if(V&&(i.shelfMapping[Cp]=V),u){const e=function(e,t){return Oh.context("preorderShelf",()=>{if(Fh(e))return null;const n=new bS(Yu),r=sg("BADGE_PREORDER_TERMS"),o=new aS(r);return n.items=[o],t.addImpressionsToShelf(n,Ip),n})}(n,o);e&&(i.shelfMapping[Yu]=e)}else{const e=eD(n,o,{isForSubscriptions:!0,options:t});e&&(i.shelfMapping[Ku]=e);const r=eD(n,o,{isForSubscriptions:!1,options:t});r&&(i.shelfMapping[Qu]=r)}const H={productTitle:i.title,shouldShowRatingsAndReviews:y,isFirstPartyHideableApp:T,isBundle:r,isPreorder:u,useInlineUberStyle:O,isFreeProduct:D},$=Kv(n,o,H);$&&(i.shelfMapping[jc]=$),i.pageTopBackgroundColor=null,i.pageBottomBackgroundColor=Nv,i.purchasedOrdering=vv(!0,host.platform,R,t),i.notPurchasedOrdering=vv(!1,host.platform,R,t),cD(t,i);const W={};if(W.contentRating=E,W.languages=C,W.size=_,W.friendsPlaying=U,i.badges&&jO(i.badges,W,o),null!=i.shelfMapping[_p]){const e=i.shelfMapping[_p].items;e.length>0&&jO(e[0].badges,W,o)}return i.isComplete=!0,i})}function aD(e,t,n,r){return Oh.context("createProductPageSidePack",()=>{const o=new iP,i=TI(e,ih);i&&Nh(t)&&Nh(t.metricsPageInformation)&&(t.metricsPageInformation.offerType=Ip,t.metricsPageInformation.offerReleaseDate=Vk(e));const s=e.id,a=yI(e,bh),c=wI(e,gd),l=fC(e);o.adamId=s,o.bundleId=Gh(e,bf);const u=uL(e);o.uberArtwork=tL(e,{supportsArcade:u}),Dm!==Ph&&Dm!==kh||(o.uberArtworkForCompactDisplay=tL(e,{supportsArcade:u,prefersCompactVariant:!0})),o.uberVideo=nL(e,20),o.logoArtwork=function(e,t){let n,r=null,o=null;switch(Dm){case"tv":r="editorialArtwork.contentLogoTrimmed",o="bb";break;default:return null}if(n=sA(e,r),Nh(n)&&Nh(o))return vx(n,{cropCode:o,useCase:0,withJoeColorPlaceholder:!0});return null}(e);const d=lD(u);let p;if(Nh(n)&&(p=n.clientIdentifierOverride),r||(o.icon=Lx(e,{useCase:10},p)),o.title=a,o.isComplete=!1,o.subtitle=ax(e),o.developerTagline=cA(e,Ru),o.regularPriceFormatted=yI(e,"regularPriceFormatted"),l||(o.rating=II(e,Ht)),"tv"===Dm){let t;t=Nh(o.uberVideo)&&Nh(o.uberVideo.preview)?o.uberVideo.preview.backgroundColor:Nh(o.uberArtwork)?o.uberArtwork.backgroundColor:Lx(e,{useCase:10,allowingTransparency:!1,withJoeColorPlaceholder:!0},p).backgroundColor,o.hasDarkUserInterfaceStyle=Ly(t,50)}const f=function(e){if(Kh(Gu))return null;if("tv"===Dm)return["tv"];return null}(),h=function(e){if("tv"===Dm||Dm===Eh)return[Dm];return null}(),m=Gx(e,11,f,p),g=Ux(e,_S,h);let y=null;if(g)for(const e of m)if(e.mediaPlatform.isEqualTo(g.mediaPlatform)){y=e;break}let T=null;if(y){const e=y.mediaPlatform.appPlatform;if(e===kh||e===Zf)for(const e of y.items){const t=e.screenshot;if(T=t.width/t.height,T<1)break}}const w={pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker,id:s,isAdvert:!!t.metricsPageInformation.iAdInfo&&t.metricsPageInformation.iAdInfo.iAdIsPresent};o.children=ox(e,{metricsOptions:w,artworkUseCase:1});const A=[],S=[];if(y&&g&&g.videos)for(const e of g.videos){const t=new qA;t.video=e;const n=e.preview.width/e.preview.height,r=null===T||Math.abs(n-T)<.01,o=y.mediaPlatform.isEqualTo(g.mediaPlatform);r&&o?A.push(t):S.push(e),OA(e,w)}y&&(y.items=A.concat(y.items));let b=null;if(S.length>0&&(b=function(e,t){return Oh.context("videoShelf",()=>{if(!e||0===e.length)return null;const n=new bS(Ba);return n.title=sg("PRODUCT_SECTION_VIDEOS"),n.items=e.map(e=>new dS(e,!0,mf,null,null,!0)),n.isHorizontal=!0,t.addImpressionsToShelf(n,Rp),n})}(S,t)),o.media=m,o.mediaSectionTitle="tv"===Dm?null:sg("PRODUCT_SECTION_SCREENSHOTS_PREVIEW"),u&&null===o.uberVideo&&null===o.uberArtwork&&o.media.length>0&&o.media[0].items.length>0){const e=o.media[0].items[0];o.uberVideo=e.video,o.uberArtwork=e.screenshot}null!==o.uberArtworkForCompactDisplay||Dm!==Ph&&Dm!==kh||(o.uberArtworkForCompactDisplay=o.uberArtwork),o.appPlatforms=$x(e);const P=Uk(e),k=zI(e,o.icon),E=qk(P,e,i,k,w);let C,_,R;if(Mh(E)&&(Nh(n)&&(E.lineItem=n.iAdLineItem),C=Wk(E,e,i,w,$f,!1,p),Nh(n)&&Mh(n.externalDeepLinkUrl)&&Mh(C)&&(C=xk(C,E.adamId,n.externalDeepLinkUrl,w))),o.buttonAction=C,i){let t;o.theme=Yl;let n=null;if(u)t="",n=lg(xL(e,sg(Bi)));else if(t=sg("PREORDER_EXPANDED_OFFER_TITLE"),Nh(E.expectedReleaseDate)){const e=hg("MMM d, yyyy",E.expectedReleaseDate);n=sg("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(at,e)}o.expandedOfferDetails=new oP(t,n)}d?(_=Qf,R=zd):(_=Np,R=$f);const O=u?xc:sf;let v;o.offerDisplayProperties=Kk(E,O,e,i,_,R,null,null,$f),o.titleOfferDisplayProperties=Kk(E,O,e,i,"colored","productPage",null,null,$f);const D=_I(e,Lf),x=oL(D);Nh(x)&&(v=new Bg(hh),v.title=yI(e,Qp),v.pageUrl=x,BS(v,{targetType:wh,id:D.id,actionType:_f,pageInformation:t.metricsPageInformation,locationTracker:t.locationTracker})),o.developerAction=v,o.shareAction=WE(e,t.metricsPageInformation,t.locationTracker),o.tertiaryTitle=cx(e),o.tertiaryTitleAction=lx(e);const L={appPlatforms:o.appPlatforms,clientIdentifierOverride:p,offerButtonShouldBeDisabled:!1,productTitle:o.title,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.locationTracker};o.banner=function(e,t){let n=null,r=null,o=null;if(vS(e,16384)){switch(Dm){case Ch:n=sg("AppStore.Filter.ArcadeComingSoon.macOS");break;case Ph:case kh:n=sg("AppStore.Filter.ArcadeComingSoon.iOS");break;case"tv":n=sg("AppStore.Filter.ArcadeComingSoon.tvOS");break;default:n=null}null!==n&&(t.offerButtonShouldBeDisabled=!0)}const i=uA(e,$),s=uA(e,W);if((i||s)&&(n=sg(Dm===Ch?"APP_UPDATE_REQUIRED_MACOS":"APP_UPDATE_REQUIRED_IOS"),t.offerButtonShouldBeDisabled=!0),null===n&&vS(e,2048)&&(n=sg("OFFER_WATCH_ONLY_BANNER"),t.offerButtonShouldBeDisabled=!0),null===n&&!Cx(e))if(n=sg(Zt),"tv"===Dm)n=sg(en);else if(Dm===Ph||Dm===kh||Dm===Ch){const e=new rP(_h,zf),r=new sy(e);r.title=sg(xs),r.indexId=qc,o=r,n=sg(Ls).replace(Fs,r.title),t.offerButtonShouldBeDisabled=!0}if(null===n&&vS(e,36)&&(n=sg(tn),t.offerButtonShouldBeDisabled=!0),vS(e,512)){const t=zx(e,by);switch(Dm){case Ch:n=sg("UNSUPPORTED_MACOS_VERSION").replace(jd,t);break;case kh:case Ph:n=sg(nn).replace(jd,t);break;case"tv":n=sg("UNSUPPORTED_TVOS_VERSION").replace(jd,t);break;case Eh:const r=cA(e,Ol);n=sg("UNSUPPORTED_WATCHOS_VERSION").replace(jd,r);break;default:n=sg(tn)}}if(Dm===Eh&&vS(e,4096)){const t=kI(e,pA(e),Xf);n=sg(nn).replace(jd,t)}if(vS(e,128))if(t.offerButtonShouldBeDisabled=!0,n=sg(Zt),"tv"===Dm)n=sg(en);else if(Dm===Ph||Dm===kh||Dm===Ch){const e=new rP(_h,zf),t=new sy(e);t.title=sg(xs),t.indexId=qc,o=t,n=sg(Ls).replace(Fs,t.title)}if(vS(e,32768)){t.offerButtonShouldBeDisabled=!0;const e=new rP(_h,zf),r=new sy(e);r.title=sg(xs),r.indexId=qc,o=r,n=sg(Ls).replace(Fs,r.title)}if(hL(e)){n=wI(e,ih)?Kh("unsupportedCompanionPreorder")?sg("UNSUPPORTED_COMPANION_CONFIGURATION_PREORDER"):sg("AppStore.ProductPage.WatchOS.PreOrderRequiresiPhone"):sg("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),t.offerButtonShouldBeDisabled=!0}const a=cA(e,Ol);null===n&&t.clientIdentifierOverride===Em&&vL(a)&&(n=sg("AppStore.ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace(jd,a));const c=Lk(e),l=Fk("product-page-banner");if((null===n||!t.offerButtonShouldBeDisabled)&&c&&l){const e=sg("AppStore.ProductPage.ExternalPurchasesBanner.LearnMore");if(r=Nk(e,t.metricsPageInformation,t.metricsLocationTracker),r){n=sg("AppStore.ProductPage.ExternalPurchasesBanner.WithLink").replace(Os,e)}else n=sg("AppStore.ProductPage.ExternalPurchasesBanner.NoLink");o=null}return Mh(n)?new MA(n,r,o):null}(e,L);const F=o.offerDisplayProperties;L.offerButtonShouldBeDisabled&&Mh(F)&&(o.offerDisplayProperties=F.newOfferDisplayPropertiesChangingAppearance(!1,Su));const N=!vS(e,512);if(!c&&!L.offerButtonShouldBeDisabled&&N){const t=function(e){return Oh.context("updateOfferDataFromData",()=>{const t=aA(e,Ml);if(0===t.length)return null;for(const e of t){if("update"===Gh(e,Bp))return e}return null})}(e);o.updateBuyParams=Gh(t,Ul),o.externalVersionIdentifier=dA(e,"externalVersionId")}if("tv"===Dm&&(o.developerTagline?o.descriptionHeader=sg("PRODUCT_DESCRIPTION_HEADER").replace(Md,o.title).replace(I,o.developerTagline):o.descriptionHeader=o.title),o.shelfMapping={},"tv"===Dm)o.description=Xv(e);else{const n={developerAction:v};o.shelfMapping[Sf]=Jv(e,t,n)}if(b&&(o.shelfMapping[Rp]=b),o.purchasedOrdering=vv(!0,host.platform,u,n),o.notPurchasedOrdering=vv(!1,host.platform,u,n),cD(n,o),u&&(o.editorialTagline=sg(Yi)),Dm===kh||Dm===Ph||Dm===Ch){const n={useInlineUberStyle:d};o.shelfMapping[_p]=function(e,t,n){const r=new bS(_p),o=lv(e,!0,{locationTracker:t.locationTracker,pageInformation:t.metricsPageInformation}),i=!n.useInlineUberStyle,s=n.useInlineUberStyle,a=new gS(o,i,!1,s,"justified");return r.items=[a],r.isHorizontal=!0,t.addImpressionsToShelf(r,_p),r}(e,t,n),o.badges=[]}else o.badges=lv(e,!1,{locationTracker:t.locationTracker,pageInformation:t.metricsPageInformation});return d?(o.uberStyle="inline",o.theme=Qf):o.uberStyle="above",o})}function cD(e,t){if(e&&e.spotlightSection){const n=e.spotlightInAppProductIdentifier;if(n&&e.spotlightSection.type===_h){const r=t.shelfMapping[e.spotlightSection.shelfId];if(!r)return;if(r.presentationHints={isInProductPageSpotlight:!0},Gv(n,r.items),r.url){const e=new uI(r.url);e&&(r.url=e.param(iw,n).build())}}}}function lD(e){return e&&(Dm===kh||Dm===Ph||Dm===Ch)}class uD extends Zh{constructor(e,t,n,r){super(),this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class dD extends Oy{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.shortName=this.name,this.longName=this.name,this.url=t}}class pD extends Zh{constructor(e,t,n,r,o,i){super(),this.genreId=e,this.ageBandId=t,this.title=n,this.segments=r,this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0}}function fD(e,t,n,r){return Oh.context("topChartsPageFromApiResponse",()=>{const o=function(e){return Bh(e,"results.apps").filter(e=>!Lh(e.data))}(e),i=o.map(n=>function(e,t,n){return Oh.context("segmentFromData",()=>{const r=Gh(t.query,th);let o=Gh(e,"shortName");const i=Gh(e,bh),s=Gh(e,Ll),a=aP("TopChartsPage",r,n,`${s} ${i}`),c={rootPosition:0,locationStack:[]},l=[];let u=0;const d=[];for(const t of e.data){const e=gD(u,t,a,c);if(e){if(vS(t))continue;l.push(e),tA(c),u++}else d.push(t)}const p=[],f=new bS(ch);f.items=l,p.push(f),Lh(o)&&(o=i);const h=new uD(o,i,s,p),m=Sb(d,null,e.next,a,c);return m.metricsPageInformation=a,m.metricsLocationTracker=c,m.highestOrdinal=u,h.nextPage=m,lP(h,a),h})}(n,t,e)).sort((e,t)=>e.chart.localeCompare(t.chart)),s=Gh(o,"0.href"),a=new uI(s),c=a.query[th],l=a.query[pd],u=sg("PAGE_TITLE_TOP_CHARTS"),d=[];if(null!=n)for(const e of n.categories)e.genreId&&d.push(hD(e));const p=function e(t,n,r){for(const o of r){if(n&&o.ageBandId===n||!n&&!o.ageBandId&&o.genreId===t)return o;const r=e(t,n,o.children);if(r)return r}return null}(c,l,d);let f;f=null!=p?new pD(c,p.ageBandId,u,i,p.name,d):new pD(c,null,u,i,null,d);const h=i.findIndex(e=>e.chart===r);return h>=0&&(f.initialSegmentIndex=h),f})}function hD(e){const t=function(e,t=null){let n=(new Ry).forType(Kl).addingQuery("types",Ah).addingQuery(th,e).includingMacOSCompatibleIOSAppsWhenSupported(!0);return t&&(n=n.addingQuery(pd,t)),by&&(n=n.includingAdditionalPlatforms([Rf,Mf])),n}(e.genreId,e.ageBandId),n=e.children.map(e=>hD(e));return new dD(e,OI(t).toString(),n)}function mD(e,t,n){return Oh.context("topChartSegmentFromLookupResponse",()=>{const r=[];let o=t.highestOrdinal;const i=Pb(e);for(const e of i)vS(e,30718)||(r.push(gD(o,e,t.metricsPageInformation,t.metricsLocationTracker)),tA(t.metricsLocationTracker),o++);const s=[];if(r.length>0){const e=new bS(ch);e.items=r,s.push(e),n.highestOrdinal=o}const a=new uD(null,null,null,s);return a.nextPage=n,a})}function gD(e,t,n,r){return Oh.context("lockupFromApiChartItem",()=>fx(t,{ordinal:ug(e+1),metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:1}))}let yD;yD=ask.resilientDeepLinks;const TD=()=>yD.hasResilientDeepLinks();var wD={search(e,t,n){Lh(Gh(t,_w))?n.reject(new Error("Unhandled search url: "+e)):net.fetch({url:e.build(),method:Fd}).then(t=>{Nh(t.url)?FD(t.url).then(n.resolve,n.reject):n.reject(new Error("Unhandled search url: "+e))})},topCharts(e,t,n){const r=t[Fw];e.removeParam(Fw);jS(new Ry(e.build()).includingMacOSCompatibleIOSAppsWhenSupported()).then(t=>{const n=fD(t,e);if(r&&Mh(n.segments)){const e=n.segments[0],t=e.nextPage,r=Tb(t);if(Mh(r)){let o=new Ry(r).includingMacOSCompatibleIOSAppsWhenSupported(!0);return by&&(o=o.includingAdditionalPlatforms([Rf,Mf])),jS(o).then(r=>{const o=wb(t);o.ids=[],o.remainingContent=[],o.maxPerPage=0;const i=mD(r,t,o),s=e.shelves.concat(i.shelves),a=new uD(e.shortName,e.longName,e.chart,s);return a.pageMetrics=e.pageMetrics,a.nextPage=null,n.segments[0]=a,n})}}return n}).then(t=>mb.createFlowAction(t,ac,e)).then(n.resolve,n.reject)},sortedReviews(e,t,n){const r=t[tI],o=t[nI];jS((new Ry).forType(ll).withIds([r]).includingAdditionalPlatforms(Ey()).addingQuery(uf,o),{}).then(e=>bC(Fm,r,[],e,!0,o)).then(t=>mb.createFlowAction(t,mh,e)).then(n.resolve,n.reject)},reviews(e,t,n){jS(ib(e)).then(t=>{const n=sD(t),r=mb.createFlowAction(n,of,e);let o=null;const i=n.shelfMapping[mh],s=1===n.appPlatforms.length&&"tv"===n.appPlatforms[0];return i&&i.seeAllAction&&!s&&(o=i.seeAllAction,o.animationBehavior=Wp),o?(r.animationBehavior=Wp,new Hg([r,o])):r}).then(n.resolve,n.reject)},productInAppPurchase(e,t,n){const r=t[Xw],o=ib(new uI(r)),i={},s=t[Zw]===Fp;i.spotlightSection=Dv(s),i.spotlightInAppProductIdentifier=t[iw],jS(o).then(t=>{const n=sD(t,i);return mb.createFlowAction(n,of,e)}).then(n.resolve,n.reject)},inAppPurchaseInstall(e,t,n){const r=t[KT],o=t[Jw];jS((new Ry).forType(Tf).withIds([o]),{}).then(e=>{const t=function(e,t){const n={pageId:t||"",pageType:"IAPInstallPage",parentId:VI(e)};return new xS(n)}(r,o),n=bb(e);let i;const s={metricsOptions:{pageInformation:t,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:1};o&&n&&(i=hx(n,s),i.theme=Hf);const a=_I(n,sf);let c;r&&a&&(c=fx(a,s));const l=new IP;l.isComplete=!0,l.lockup=i,l.parentLockup=c;const u=Uk(n);return l.preInstallOfferDescription=iO(u),function(e,t){lP(e,t)}(l,t),l}).then(t=>mb.createFlowAction(t,Da,e)).then(n.resolve,n.reject)},developer(e,t,n){jS(function(e){const t=rb(e);if(!Uh(t))throw new Error(`Unable to map ${e.build()} to a media api url`);return(new Ry).forType(Qd).withIds([t]).includingAdditionalPlatforms(Ey()).includingRelationships(lb()).includingAttributes(sb()).includingMacOSCompatibleIOSAppsWhenSupported().attributingTo(e.build())}(e)).then(e=>ER(e)).then(t=>mb.createFlowAction(t,hh,e)).then(n.resolve,n.reject)},developerHref(e,t,n){jS(function(e){return new Ry(e).includingAdditionalPlatforms(Ey()).includingAttributes(sb()).includingRelationships(lb()).includingMacOSCompatibleIOSAppsWhenSupported()}(t[kw])).then(e=>ER(e)).then(t=>mb.createFlowAction(t,hh,e)).then(n.resolve,n.reject)},article(e,t,n){const r=JSON.parse(Gh(e.query,Ew));jS(function(e){const t=e.pathComponents();if(t.indexOf(cu)<0&&t.indexOf(Pu)<0&&t.indexOf(ir)<0&&e.host!==jT)throw new Error(`Unable to map ${e.build()} to a media api url`);let n;if(n=e.host===jT?Jh("spamBlockingExtensionsEditorialItemID"):rb(e),!Uh(n))throw new Error(`Unable to map ${e.build()} to a media api url`);if(!Uh(n))throw new Error(`Unable to map ${e} to a media api url`);const r=[Zo],o=[Gp,wp,xf,Xf,lh,sh];return by&&o.push(Jf),(new Ry).forType(rh).withIds([n]).includingAdditionalPlatforms(Ey()).includingAttributes(o).includingRelationships(r).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).attributingTo(e.build())}(e)).then(e=>function(e){return $S(e,YE,KE)}(e)).then(e=>{const n=new zE;return n.todayShelfRecoMetricsData=r,n.showingFallbackMediaInline=Boolean(t[Cw]),n.additionalData=e.additionalData,n.isResilientDeepLink=Kh(p)&&TD(),jE(e.originalData,n)}).then(t=>mb.createFlowAction(t,jf,e)).then(n.resolve,n.reject)},resetAndRedirect(e,t,n){const r={url:e.toString(),signingStyle:od};net.fetch(r).then(e=>{n.resolve(null)},n.reject)},msoRoom(e,t,n){const r=function(e){const t=e[rI];return t?t.split(","):[]}(t);jS(function(e){return XR(rb(e))}(e.removeParam(rI))).then(e=>ZR(e,r)).then(t=>mb.createFlowAction(t,"mso",e)).then(n.resolve,n.reject)},actionHandler(e,t,n){WR(e).then(n.resolve,n.reject)},showUpdatesPageHandler(e,t,n){const r=new qg(Tl);n.resolve(r)},personalizationTransparency(e,t,n){Wh(t[Pw])?jS((new Ry).forType(Ko)).then(e=>zP(e),()=>zP()).then(t=>mb.createFlowAction(t,Gf,e)).then(n.resolve,n.reject):n.resolve(mb.createFlowAction(function(){const e=[],t=new BP,n=new mm(sg("PERSONALIZATION_DESCRIPTION_OPTED_OUT"));t.addContentItem(new HP(n)),e.push(t);const r=new BP;return r.addContentItem(new GP(sg(Qo),WP(Nf,Gf,!1),yl)),e.push(r),new UP(sg(T),e)}(),Gf,e))}},ID={reviews(e,t,n){const r=n.pageToken,o=t[tI],i=t[nI],s=Bh(r.remainingContent);jS(new Ry(r.nextHref).includingAdditionalPlatforms(Ey()).addingQuery(uf,i),{}).then(e=>bC(Fm,o,s,e,!1,i)).then(n.resolve,n.reject)}},AD={developer(e,t,n){const r=t[Kf],o=JSON.parse(r);jS(new Ry(o.remainingData).includingAdditionalPlatforms(Ey()).includingAttributes(sb())).then(e=>function(e,t){const n=vR(e.data,t.contentType,t.lockupListOptions);return n.mergeWhenFetched=!0,n}(e,o)).then(n.resolve,n.reject)},today(e,t,n){const r=t[Kf],o=JSON.parse(r);if(Lh(o.todayModule))return void n.reject(new Error("Not a today module"));jS(new Ry(o.todayModule.contents).includingAdditionalPlatforms(Ey()).includingAttributes(iE).includingRelationshipsForUpsell(!0)).then(e=>function(e,t){if(Lh(e.todayModule))return null;const n=e.todayModule;n.contents=Pb(t);const r=new sE;r.locationTracker=e.metricsLocationTracker,r.pageInformation=e.metricsPageInformation;const o=dE(n,{contentOffsetWithinModule:e.contentOffsetWithinModule,hideTitle:!0,setTitleToDateForTodaySection:!1},r);return o.mergeWhenFetched=!0,o}(o,e)).then(n.resolve,n.reject)},personalizedReviews(e,t,n){const r=t[Kf],o=JSON.parse(r);jS((new Ry).forType(mh).withIds([o.adamId])).then(e=>IC(Fm,o,e)).catch(()=>IC(Fm,o)).then(n.resolve,n.reject)},mso(e,t,n){const r=t[Kf],o=JSON.parse(r),i=[lh,sh,Xf];by&&i.push(Jf);jS(new Ry(o.remainingContent).includingAdditionalPlatforms(Ey()).includingAttributes(i)).then(e=>function(e,t){const n=Pb(e),r=t;r.remainingContent=[];const o={lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},artworkUseCase:Ox(t.preferredShelfContentType)},contentUnavailable:function(e,t){return r.remainingContent=Ab(r.remainingContent,t),r.remainingContent.push(n[t]),!1}},i=new bS(t.preferredShelfContentType);return i.shouldFilterApps=t.shouldFilter,i.items=Ax(n,o),i.mergeWhenFetched=!0,i.url=eO(r),i}(e,o)).then(n.resolve,n.reject)}},SD={reviews:[{protocol:Gy.https,path:`/{countryCode}/${aT}/{appName}/{id}`,hash:iI},{protocol:Gy.https,path:`/${Hy}/${fT}`,query:[KT]}],sortedReviews:[{protocol:Gy.internal,path:`/${pT}/{adamId}/{sort}`}],productInAppPurchase:[{protocol:Gy.internal,path:`/${aT}/${Wy}`,query:[Xw,iw,Zw]}],inAppPurchaseInstall:[{protocol:Gy.internal,path:`/${aT}/${jy}`,query:[""+KT,Jw+"?"]}],topCharts:[{protocol:Gy.https,path:`/${Hy}/${iT}`,query:[tw,ew]},{protocol:Gy.https,path:"/{apiVersion}/catalog/{countryCode}/"+sT,query:[nw+"?",Fw+"?"]}],developer:[{protocol:Gy.https,path:`/${uT}/{id}`},{protocol:Gy.https,path:`/${uT}/{developerName}/{id}`},{protocol:Gy.https,path:`/{countryCode}/${uT}/{developerName}/{id}`},{protocol:Gy.https,path:`/{countryCode}/${dT}/{developerName}/{id}`},{protocol:Gy.https,path:`/${Hy}/${Ky}`,query:[KT,cw+"?"]}],developerHref:[{protocol:Gy.internal,path:`/${uT}/${bT}`,query:[kw]}],search:[{hostName:UT,path:"WebObjects/MZContentLink.woa/wa/link",query:[_w]}],article:[{protocol:Gy.https,path:`/{countryCode}/${gT}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${gT}/{seoSlug}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${mT}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${mT}/{seoSlug}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/${mT}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/${mT}/{seoSlug}/{id}`,query:[Cw+"?"]},{protocol:Gy.https,path:`/${Hy}/${yT}`,query:[KT,Cw+"?"]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[KT,Cw+"?"]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[KT,Cw+"?"]},{protocol:Gy.https,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[KT,Cw+"?"]},{protocol:Gy.https,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[KT,Cw+"?"]},{protocol:Gy.https,hostName:""+jT}],msoRoom:[{protocol:Gy.https,path:`/{countryCode}/${wT}/{appName}/{id}`,query:[rI+"?"]},{protocol:Gy.https,path:`/${wT}/{providerName}/{id}`,query:[rI+"?"]},{protocol:Gy.https,path:`/{countryCode}/${wT}/{id}`,query:[rI+"?"]},{protocol:Gy.https,path:`/${wT}/{id}`,query:[rI+"?"]},{protocol:Gy.https,path:"/"+wT,query:[KT,rI+"?"]},{protocol:Gy.https,path:"{countryCode}/"+wT,query:[KT,rI+"?"]}],resetAndRedirect:[{protocol:Gy.https,path:`/${Hy}/${IT}`}],action:[{query:[lw]}],personalizationTransparency:[{protocol:Gy.internal,path:`/${AT}/${ST}`,query:[Pw]}]},bD={grouping:[{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`}],today:[{protocol:Gy.internal,path:`/${Jy}/${Vy}/{token}`}],topCharts:[{protocol:Gy.internal,path:`/${iT}/{genre}/${Vy}/{pop}`}],developer:[{protocol:Gy.internal,path:`/${uT}/${Vy}/{token}`}],personalizedReviews:[{protocol:Gy.internal,path:`/${hT}/${Vy}/{token}`}],mso:[{protocol:Gy.internal,path:`/${wT}/${Vy}/{token}`}]};class PD extends mb{constructor(e,t,n=[],r=null,o=[],i=null,s=[],a=null){super(e),this._pageType=t,this._pageRoute=n,this._pageHandler=r,this._shelfRoute=o,this._shelfHandler=i,this._paginationRoute=s,this._paginationHandler=a}pageType(){return this._pageType}handlePage(e,t,n,r,o){this._pageHandler||o(new Error(this.builderClass+" does not implement handlePage")),this._pageHandler(e,t,{resolve:r,reject:o})}handleShelf(e,t,n,r,o){this._shelfHandler||o(new Error(this.builderClass+" does not implement handleShelf")),this._shelfHandler(e,t,{resolve:r,reject:o})}handlePagination(e,t,n,r,o,i){this._paginationHandler||i(new Error(this.builderClass+" does not implement handlePagination")),this._paginationHandler(e,t,{resolve:o,reject:i,pageToken:r})}get pageRoute(){return this._pageRoute}get shelfRoute(){return this._shelfRoute}get paginationRoute(){return this._paginationRoute}}class kD extends Zh{}async function ED(){const e=await(t=$u,n=Xh.searchLandingAdFetchTimeout,LR.fetchOnDeviceAd(t,n));var t,n;Fh(e.clientRequestId)&&(e.clientRequestId=random.nextUUID(),Jb("clientRequestId was nil. Assigned "+e.clientRequestId));const r={clientRequestId:e.clientRequestId,iAdId:e.iAdId};if(e.failureReason)return r.failureReason=e.failureReason,r;r.onDeviceAd=e.ad;try{const t=function(e){const t=(new Ry).forType(Ah).withIds([e.adamId]);return E_(t),t}(e.ad),n=await jS(t);r.mediaResponse=function(e,t){const n=bb(e);if(Fh(n)||Lh(n.attributes))return Jb("decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null;const r=t.ad,o=`${r.adamId}|${r.metadata}`,i={clientRequestId:t.clientRequestId,impressionId:r.impressionId,metadata:r.metadata,privacy:r.privacy,lineItem:o};return n.attributes.iad=i,LC(n,r.instanceId),e}(n,e)}catch(e){Jb("fetchAds request failed - "+e),r.failureReason=jn}return r}function CD(e){if(Lh(e)||Nh(e.failureReason))return null;const t={tasks:{}};return function(e,t){Lh(e)||(e.tasks[t.position]=t)}(t,{data:bb(e.mediaResponse),position:pe}),t}const _D=new Set,RD=new MP,OD=new MP,vD=new MP;function DD(e){if(_D.has(e.builderClass))throw new Error("routing: Registering duplicate builderClass "+e.builderClass);_D.add(e.builderClass),RD.associate(e.pageRoute,e),OD.associate(e.shelfRoute,e),vD.associate(e.paginationRoute,e)}function xD(e){const t=RD.routedObjectForUrl(e);if(!t.object)return"unknown";const n=t.object;return"ProductAdapterBuilder"===n.builderClass&&t.parameters[lw]!==Fv&&t.parameters[lw]!==Lv?of:n.pageType()}function LD(e,t){return FD(e).then(n=>new Promise((r,o)=>{if(!n)throw new Error("Promise resolved to null action for: "+e);if(n.actionClass!==Oa){if(n.actionClass===br){const e=n;if(1===e.actions.length&&e.actions[0].actionClass===Oa){const n=e.actions[0].pageData;return IA(n,t)?void r(n):void o(new Error(`${n} is not expected type ${t.name}`))}}o(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const i=n.pageData;if(!IA(i,t)){const s=n.pageUrl,a=s===e;return s&&!a?void LD(s,t).then(e=>{r(e)}).catch(e=>{o(e)}):void o(new Error(`${i} is not expected type ${t.name}`))}r(i)}}))}function FD(e){return new Promise((t,n)=>{const r=RD.routedObjectForUrl(e);if(!r.object)return void function(e,t,n){net.fetch({url:e.toString(),method:Fd}).then(r=>{200===r.status&&r.redirected&&r.url?FD(r.url).then(t,n):n(new Error("redirectAndRefetchActionIfPossible: Unhandled page url: "+e))})}(r.normalizedUrl,t,n);r.object.handlePage(r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t,n)})}function ND(e){return new Promise((t,n)=>{const r=e.url;if(!r)return void n(new Error("Page token missing required `url` property"));const o=vD.routedObjectForUrl(r);if(!o.object)return void n(new Error("fetchMoreOfPage: Unhandled pagination url: "+r));o.object.handlePagination(o.normalizedUrl,o.parameters,o.matchedRuleIdentifier,e,t,n)})}DD(new class extends gb{constructor(){super("ProductBuilderNative")}pageType(){return of}get pageRoute(){return[]}get shelfRoute(){return[{protocol:Gy.internal,path:`/${aT}/${Vy}`,query:[gw,qw]},{protocol:Gy.internal,path:`/${aT}/${Vy}`,query:[yw]},{protocol:Gy.internal,path:`/${aT}/${Vy}`,query:[Tw,qw]}]}renderShelf(e,t){return new Promise(n=>{if(e.query[gw]){const r=e.query[KT],o=jR(r),i=t[qw],s=JSON.parse(i);o.then(e=>{const t=Zv(e,!0,s);n(t)}).catch(e=>{throw e})}else if(e.query[yw]){const t=e.query[KT];jR(t).then(e=>{const t=Zv(e,!1);n(t)}).catch(e=>{throw e})}else if(e.query[Tw]){(e=>zR.fetchAchievementSummaryForGame(e))(e.query[ow]).then(e=>{const r=e;let o=null;if(r.length>0){const e=new my(r[0].bundleId),t=sg("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed");let n;n=Kh("achievementsOutOfLoc")?ag(on,r[0].totalAchievements):sg(on,"out of {totalAchievements} completed").replace("{totalAchievements}",r[0].totalAchievements.toString());const i=r[0].achievements;let s=null;const a=i.filter(e=>e.status.type===nc);if(a.length>0&&(s=a[0]),null===s){const e=i.filter(e=>e.status.type===tc||e.status.type===ec);e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(s=e[0])}null!==s&&(o=new wm(r[0].bundleId,r[0].completedAchievements,r[0].totalAchievements,n,t,e,[s]))}const i=t[qw],s=function(e,t){const n=new bS(yn);if(n.isHorizontal=!0,e){const r={pageInformation:t.destinationPageInformation,locationTracker:t.sourceLocationTracker,kind:Wd,title:gn,id:"achievements_summary",idType:Il,softwareType:null,targetType:Wd,badges:{gameCenter:{}}};mA(n,r),BS(e.action,r),n.items=[e]}return n.mergeWhenFetched=!0,n.batchGroup=nf,n.isHidden=0===n.items.length,n}(o,JSON.parse(i));n(s)}).catch(e=>{throw e})}else n(super.renderShelf(e,t))})}}),DD(new class extends gb{constructor(){super("GroupingGameCenterBuilder")}pageType(){return dh}get pageRoute(){return[]}get shelfRoute(){return[{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`,query:[ww]},{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`,query:[Iw]},{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`,query:[Aw]},{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`,query:[Sw]}]}renderShelf(e,t){const n=t[Kf],r=JSON.parse(n);if(r.isFirstRender=!1,e.query[ww]){const e=Date.now();return this.requestForContinuePlaying(r.gamesFilter).then(t=>{const n=Date.now();console.log("grouping-gamecenter-builder - Continue Playing REQUEST took "+(n-e).toString(10)+uc);const o=Date.now(),i=RC(t,r),s=Date.now();console.log("grouping-gamecenter-builder - Continue Playing SHELF took "+(s-o).toString(10)+uc);const a=Date.now();return console.log("grouping-gamecenter-builder - Continue Playing TOTAL took "+(a-e).toString(10)+uc),i})}return e.query[Iw]?this.requestForGamesPopularWithFriends(r.gamesFilter).then(e=>qC(e,r)):e.query[Aw]?this.requestForSuggestedFriends().then(e=>$C(e,r)):e.query[Sw]?this.requestForGameCenterReengagementData(r):Promise.resolve(super.renderShelf(e,t))}requestForContinuePlaying(e){const t=Date.now(),n=this.maximumNumberOfRecentGamesToRequest();let r=null;var o,i,s;return Kh("recentlyPlayedGamesSupportsTimeLimit")?(o=this.gameCategoryFilter(e),i=n,s=Xh.recentlyPlayedGamesWindowInSeconds,r=zR.fetchRecentlyPlayedGamesWithinSeconds(o,i,s)):r=((e,t)=>zR.fetchRecentlyPlayedGames(e,t))(this.gameCategoryFilter(e),n),r.then(e=>{const n=Date.now();if(console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-t).toString(10)+uc),0===e.length)return Promise.resolve({data:[]});const r=(new Ry).forType(fh).withIds(e.slice(0,this.maximumNumberOfRecentGamesToShow()));return E_(r),jS(r,{})})}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}requestForGamesPopularWithFriends(e){return(t=this.gameCategoryFilter(e),n=30,zR.fetchGamesPopularWithFriends(t,n)).then(e=>{const t=e.map(e=>this.gameplayHistoryFromData(e));if(0===t.length)return Promise.resolve({data:[]});const n=t.filter(e=>this.isCompatibleGameCenterPlatform(e.platformId)).map(e=>e.adamId),r=(new Ry).forType(fh).withIds(n.slice(0,100));return E_(r),jS(r,{})});var t,n}requestForSuggestedFriends(){return new Promise((e,t)=>{var n;(n=10,zR.fetchSuggestedFriends(n)).then(t=>{e(t)})})}requestForGameCenterReengagementData(e){return zR.fetchRengagementDataForLocalPlayer().then(t=>{const n=Gh(t,Pf),r=jh(t.achievement),o=jh(t.achievementSummary),i=(new Ry).forType(fh).withIds([n]);return E_(i),jS(i,{}).then(t=>vC(t,r,o,e))})}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=Gh(e,"playerId"),n=Vh(e,"timestamp");return new bm(t,n)})}gameplayHistoryFromData(e){const t=Gh(e,Pf),n=Vh(e,"platformId"),r=qh(e,"isArcade"),o=this.gameplayHistoryRecordFromData(Bh(e,"records"));return new Sm(t,n,r,o)}isCompatibleGameCenterPlatform(e){switch(e){case 1:return Dm===kh||Dm===Ph;case 2:return Dm===Ch;case 3:return"tv"===Dm;case 4:return Dm===Eh;default:return!1}}gameCategoryFilter(e){return"nonArcade"===e?"nonarcade":e}}),DD(new class extends RP{constructor(){super("StoreFrontRoomBuilder")}get pageRoute(){return[{protocol:Gy.https,path:`${Hy}/${_T}`}]}action(){return new qg(bu)}}),DD(new class extends yb{constructor(){super("EulaBuilder")}defaultPlatforms(){return Ey()}generatePageRequest(e,t){const n=e.query[di],r=e.query[V];if(Lh(n)||Lh(r))throw new Error(`Unable to map ${e.build()} to a media api url`);const o=(new Ry).forType(md).withIds([n]);return o.targetResourceType=r,o}get pageRoute(){return[{protocol:Gy.internal,path:""+PT}]}pageType(){return hh}renderPage(e,t,n){return Oh.context(Kp,()=>{const t=Gh(e,H).split(/\n{1,2}/),n=[];for(const e of t){const t=new mm(e);t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,n.push(t)}const r=new bS(tf);r.isHorizontal=!1,r.items=n;const o=new wP([r]);return o.title=sg(Qa),o})}}),DD(new xv),DD(new class extends mb{constructor(){super("PrivacyPolicyBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=e.query[di];if(Lh(i))return void o(Error(`Unable to map ${e.build()} to a media api url`));jS((new Ry).forType(Ah).withIds([i]).addingQuery(fc,Te),{}).then(e=>Oh.context(we,()=>{const t=cA(bb(e),Te),n=new mm(t);return n.wantsCollapsedNewlines=!1,new ry(sg(hc),n)})).then(r,o)}get pageRoute(){return[{protocol:Gy.internal,path:""+ET}]}}),DD(new class extends mb{constructor(){super("TVEulaBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=e.query[di],s=e.query[V];if(Lh(i)||Lh(s))return void o(Error(`Unable to map ${e.build()} to a media api url`));const a=(new Ry).forType(md).withIds([i]);a.targetResourceType=s,jS(a,{}).then(e=>Oh.context(we,()=>{const t=Gh(e,H),n=new mm(t);return n.wantsCollapsedNewlines=!1,new ry(sg(Qa),n)})).then(r,o)}get pageRoute(){return[{protocol:Gy.internal,path:""+kT}]}}),DD(new CP),DD(new class extends EP{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t){const n=rb(e),r=t[Mw];if(!this.isValidId(n))throw new Error(`Unable to map ${e.build()} to a media api url. Missing id.`);if(!this.isValidId(r))throw new Error(`Unable to map ${e.build()} to a media api url. Missing grouping.`);return(new Ry).forType(Za).withIds([n]).addingQuery(vu,r).includingMacOSCompatibleIOSAppsWhenSupported(!0)}renderPage(e,t){return Oh.context(Kp,()=>{const n=bb(e),r=CI(n,fh),o=t[Mw],i=aP(Gd,`${n.id}-${o}`,e),s=new kP;s.remainingContent=r.data,s.url=this.paginationUrl,s.shouldFilter=!wI(n,yi),s.metricsPageInformation=i,s.metricsLocationTracker={rootPosition:0,locationStack:[]},s.title=yI(n,bh);const a=this.pageWithContent(r,s);return a.title=s.title,lP(a,i),a})}get pageRoute(){return[{protocol:Gy.https,path:`/{countryCode}/${CT}/{title}/{id}`,query:[Mw]},{protocol:Gy.https,path:`/{countryCode}/${CT}/{id}`,query:[Mw]},{protocol:Gy.https,path:`/${CT}/{title}/{id}`,query:[Mw]},{protocol:Gy.https,path:`/${CT}/{id}`,query:[Mw]}]}isValidId(e){return!(Lh(e)||isNaN(e))}}),DD(new class extends _P{constructor(){super("DocTypeRoomBuilder")}generatePageRequest(e,t){const n=e.query.uti;return this.requestWithFilter("uti",n)}pageInformation(e,t){return dP("uti")}get pageRoute(){return[{protocol:Gy.https,path:`/${Hy}/${zy}`}]}}),DD(new class extends RP{constructor(){super("AppDownloadFileHandlerRoomBuilder")}get pageRoute(){return[{protocol:Gy.file,pathExtension:"appdownload"}]}action(){return new qg("account")}}),DD(new class extends _P{constructor(){super("GenericFileHandlerRoomBuilder")}generatePageRequest(e,t){const n=e.pathExtension();return null==n?null:this.requestWithFilter("extension",n)}pageInformation(e,t){return dP("extension")}get pageRoute(){return[{protocol:Gy.file}]}}),DD(new class extends _P{constructor(){super("SearchExtensionRoomBuilder")}generatePageRequest(e,t){const n=t[uw];return this.requestWithFilter("appex",n)}pageInformation(e,t){return dP("appex")}get pageRoute(){return[{hostName:""+MT,query:[uw]}]}}),DD(new class extends EP{constructor(){super("DeveloperRoomBuilder")}get pageRoute(){return[{protocol:Gy.internal,path:`/${uT}/${oT}/{token}`}]}get paginationRoute(){return[{protocol:Gy.internal,path:""+this.paginationPath,query:[""+kw]}]}generatePageRequest(e,t){const n=t[Kf],r=JSON.parse(n);if(Lh(r))throw new Error(`Unable to map ${e.build()} to a media api url`);return new Ry(r.href)}renderPage(e,t,n){return Oh.context(Kp,()=>{const n=t[Kf],r=JSON.parse(n),o=aP(Gd,`${r.developerId}_${r.relationshipId}`,e),i=new kP;i.title=r.title,i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]};const s=this.pageWithContent(e,i);return s.title=i.title,this.configurePaginationForPage(s,i,e.next),lP(s,o),s})}generatePaginationRequest(e,t,n){const r=t[kw];return new Ry(r)}renderPaginatedPage(e,t){const n=t,r=this.pageWithContent(e,n);return this.configurePaginationForPage(r,n,e.next),r}configurePaginationForPage(e,t,n){Mh(n)?(t.url=`${this.paginationUrl}?${kw}=${encodeURIComponent(n)}`,e.nextPage=t):e.nextPage=null}}),DD(new C_),DD(new class extends yb{constructor(){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,Kh("arcadeSeeAllGamesV2")?this.implementation=i:this.implementation=o}defaultPlatforms(){return Ey()}defaultAttributes(){const e=[lh,sh,Cf,xf,wp,Gp,Vp];return by&&e.push(Jf),e}defaultTab(e){return Th}pageType(){return Sp}get pageRoute(){return[{identifier:Sp,path:"/"+Zy,query:[Vw+"?",Nw+"?",Hw+"?",$w+"?",Ww+"?",zw+"?"]},{identifier:Sp,hostName:""+$T,query:[Vw+"?",Nw+"?",Hw+"?",$w+"?",Ww+"?",zw+"?"]}]}get paginationRoute(){var e,t;return null!=(t=null===(e=this.implementation)||void 0===e?void 0:e.paginationRoute)?t:[]}get shelfRoute(){var e,t;return null!=(t=null===(e=this.implementation)||void 0===e?void 0:e.shelfRoute)?t:[]}generatePageRequest(e,t){return this.implementation.generatePageRequest(e,t)}renderPage(e,t,n){return this.implementation.renderPage(e,t,n)}generatePaginationRequest(e,t,n){return this.implementation.generatePaginationRequest(e,t,n)}renderPaginatedPage(e,t){return this.implementation.renderPaginatedPage(e,t)}generateShelfRequest(e,t){return this.implementation.generateShelfRequest(e,t)}renderShelf(e,t){return this.implementation.renderShelf(e,t)}}),DD(new class extends _P{constructor(){super("SchemeTypeRoomBuilder")}generatePageRequest(e,t){return this.requestWithFilter("scheme",e.protocol)}pageInformation(e,t){return dP("scheme")}get pageRoute(){const e={exclusions:[]};for(const t of Object.keys(Gy)){const n=Gy[t];if(typeof n===Ih){const t={protocol:n};e.exclusions.push(t)}}return[e]}}),DD(new class extends yb{constructor(){super("GroupingPageBuilder")}defaultPlatforms(){return Ey()}defaultAttributes(){const e=[lh,Cf,xf,gi];return by&&e.push(Jf),e}prepareRequest(e,t,n){super.prepareRequest(e,t,n),Dm===Eh&&e.addingRelationshipLimit(fh,3)}pageType(){return hh}get pageRoute(){return[{protocol:Gy.https,path:`/${Hy}/${Yy}`,query:[KT,dw+"?"]},{hostName:BT,path:"/WebObjects/{storePreviewInstance}/wa/"+Yy,query:[KT,Rw+"?"]},{protocol:Gy.https,path:`/{countryCode}/${tT}/{genreName}/{id}`},{protocol:Gy.https,path:`/${Hy}/${nT}`,query:[KT]},{hostName:BT,path:"/WebObjects/{storePreviewInstance}/wa/"+nT,query:[KT,Rw+"?"]},{protocol:Gy.https,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Gy.https,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Gy.https,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:Gy.https,hostName:""+YT}]}get shelfRoute(){return[{protocol:Gy.internal,path:`/${Yy}/${Vy}/{token}`}]}generatePageRequest(e,t){let n,r,o=e.query.id;if(e.host===YT&&Mh(Xh.safariExtensionsGroupingURL)){const e=uI.from(Xh.safariExtensionsGroupingURL);Nh(e)&&(o=rb(e))}const i=e.pathComponents();if(-1!==i.indexOf(dc)?n=o:-1!==i.indexOf(th)?n=rb(e):r=o,!Uh(r)&&!Uh(n))throw new Error(`Unable to map ${e.build()} to a media api url`);const s=[lh,sh,Cf,xf,Vp,sc];by&&s.push(Jf);let a=(new Ry).forType(Af).includingAttributes(s).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported();const c=e.query[dw]||_y();Nh(c)&&a.addingQuery(tp,c),Uh(r)?a=a.withIds([r]):Uh(n)&&(a=a.addingQuery(th,n));const l=e.query[Rw];return e.host===BT&&Mh(l)&&(a.isStorePreviewRequest=!0,a=a.addingQuery(Ri,l)),a.attributingTo(e.build())}renderPage(e,t,n,r){return Oh.context("renderGroupingPage",()=>{const t=bb(e);if(!t)return null;if(!EI(t,qp))return null;const n={shelves:[],metricsPageInformation:aP(pc,t.id,e),metricsLocationTracker:{rootPosition:0,locationStack:[]},groupingData:CI(t,qp),pageGenreAdamId:yI(t,"id"),pageGenreId:II(t,th)||function(e){if(Lh(e))return null;return Vh(uI.from(e).query,th)}(yI(t,"chartUrl")),hasAuthenticatedUser:Nh(dI.dsid)};if(WC(bb(n.groupingData),n),Dm===Eh){n.shelves.length>0&&n.shelves[0].contentType===Du&&(n.shelves[0].title=void 0);const e=this.shelfForHeaderButtons();n.shelves.unshift(e)}if("tv"!==Dm){const e=XC(n.metricsPageInformation,n.metricsLocationTracker);e&&n.shelves.push(e)}if(Dm!==Eh&&"tv"!==Dm){const e=Xh.termsAndConditionsURL;if(!Lh(e)){const t=c_(e);n.shelves.push(t)}}const r=this.groupingPageTitleForData(t,n.pageGenreId),o=new wP(n.shelves);switch(Dm){case"tv":case Eh:o.title=r;break;default:o.title=r,39===n.pageGenreId||36===n.pageGenreId&&Dm===Ch?o.presentationOptions=["prefersRevealNavigationBarOnMouseOver"]:o.presentationOptions=[ge]}return lP(o,n.metricsPageInformation),o})}groupingPageTitleForData(e,t){let n=null;switch(t){case 36:n=host.clientIdentifier===km&&Dm!==Eh?Dm===Ch?this.macDiscoverPageTitleForData(e):sg("GROUPING_APPS"):sg("GROUPING_APP_STORE","App Store");break;case 39:n=sg(ye);break;default:n=Ex(e)}return n}macDiscoverPageTitleForData(e){const t=CI(e,qp);if(Nh(t)&&Nh(t.data))for(const e of t.data){const t=yI(e,bh),n=II(e,yd),r=yI(e,Kf);if(Mh(t)&&Nh(n)&&Mh(r)&&r===Ef&&414===n)return t}return sg(ye)}shelfForHeaderButtons(){const e=new bS(hf),t=[],n=new Bg(Vf);return n.title=sg("SEARCH",pp),n.artwork=ak("resource://TabSearch.png"),t.push(n),e.items=t,e}generateShelfRequest(e,t){const n=t[Kf],r=JSON.parse(n),o=Mh(r.remainingItems),i=Mh(r.recommendationsHref);if(o){let e=r.remainingItems;Mh(r.relationshipDataToFetch)&&(e=r.remainingItems.map(e=>_I(e,r.relationshipDataToFetch)));const t=new Ry(e);return E_(t),t}if(i){const e=new Ry(r.recommendationsHref);return E_(e),e}return null}renderShelf(e,t){const n=t[Kf],r=JSON.parse(n),o=Mh(r.remainingItems),i=Mh(r.recommendationsHref);if(o){let t=e;if(Mh(r.relationshipDataToFetch)){const n={};for(const t of e.data)n[t.id]=t;t={data:[]};for(const e of r.remainingItems){const o=_I(e,r.relationshipDataToFetch);Mh(o)&&(e.relationships[r.relationshipDataToFetch].data=[n[o.id]]),t.data.push(e)}}return i_(t,r)}return i?s_(e,r):null}handleShelfError(e,t,n,r){const o=r[Kf],i=JSON.parse(o);if(i&&!i.hasExistingContent){const e=new bS(i.shelfStyle);e.isHidden=!0,t(e)}else super.handleShelfError(e,t,n,r)}}),DD(new class extends mb{constructor(){super("TodayCardPreviewBuilder")}pageType(){return Lp}handlePage(e,t,n,r,o){Oh.context(this.builderClass+".pageHandler",()=>{const n=e.build();if(Wh(t[XT])){const i=this.generatePageRequest(e,t);if(!i)return void o(new Error("Could not construct media API request for: "+e));i.attributingTo(n),jS(i,{}).then(e=>this.renderPage(e,t)).then(t=>mb.createFlowAction(t,this.pageType(),e)).then(r,o)}else{const n=this.renderPage({data:[]},t),o=mb.createFlowAction(n,this.pageType(),e);r(o)}})}get pageRoute(){return[{protocol:Gy.https,path:"/"+TT,query:[QT,XT+"?",ZT+"?"]}]}generatePageRequest(e,t){const n=Gh(e.query[QT]);if(!Mh(n))return null;const r=n.split(",");return(new Ry).forType(rh).withIds(r).includingAdditionalPlatforms(Ey()).includingAttributes(iE).includingRelationshipsForUpsell(!0)}renderPage(e,t){const n=sg(Kn),r={title:n,label:ca,resourceTypes:[],meta:{},contents:Pb(e)},o=new sE;let i=!1;Nh(xh(t,ZT))&&(i=!qh(t,ZT));const s=dE(r,{hideTitle:!1,contentOffsetWithinModule:0,setTitleToDateForTodaySection:!0},o,i);return new Ok([s],null,n,n)}}),DD(new class extends mb{constructor(){super("SearchLandingPageBuilder")}get pageRoute(){return[{protocol:Gy.internal,path:""+OT}]}pageType(){return hh}handlePage(e,t,n,r,o){Oh.context(this.builderClass+".handlePage",()=>{this.fetchPage().then(t=>{r(yb.createFlowAction(t,this.pageType(),e))}).catch(o)})}fetchPage(){const e=Xh.isSearchLandingAdsEnabled?ED().catch(()=>null):null;return this.fetchSearchLandingPage(e).catch(t=>this.fetchTrendingSearchesFallbackPage(e))}fetchTrendingSearchesFallbackPage(e){const t={url:Xh.trendingSearchesURL},n=net.fetch(t).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${t.url}`);return JSON.parse(e.body)});return Promise.all([n,e]).then(([e,t])=>{const n=new AP(this.trendingSearchesShelvesForResponse(e)),r=cP("SearchLanding",Dd,"");return r.iAdInfo=this.iadInfoFromOnDeviceAdResponse(t),r.iAdInfo.setMissedOpportunity("SLPLOAD"),lP(n,r),n})}fetchSearchLandingPage(e){const t=(new Ry).forType(il).includingAdditionalPlatforms(Ey());t.targetResourceType=Af;const n=pb(dI.dsid);Mh(n)&&t.addingQuery("clusterId",n);const r=jS(t);return Promise.all([r,e]).then(([e,t])=>this.landingPageFromResponse(e,t))}landingPageFromResponse(e,t){const n=Bh(e,Yn)[0];if(Fh(n))return null;const r=CI(n,qp),o=yI(n,"id");if(Fh(r))return null;const i=aP(pc,n.id,e);i.iAdInfo=this.iadInfoFromOnDeviceAdResponse(t);const s={incidents:[],iAdInfo:i.iAdInfo};!function(e,t){var n,r,o,i,s,a,c;if(!Fh(t)&&!Fh(t.failureReason))switch(t.failureReason){case jn:const l=null===(n=t.onDeviceAd)||void 0===n?void 0:n.instanceId;if(Nh(l)){HC(e,new VC(l,zn))}null===(o=null===(r=e)||void 0===r?void 0:r.iAdInfo)||void 0===o||o.setMissedOpportunity("METADATA");break;case"noAdAvailable":null===(s=null===(i=e)||void 0===i?void 0:i.iAdInfo)||void 0===s||s.setMissedOpportunity("NOAD");break;case"timeout":null===(c=null===(a=e)||void 0===a?void 0:a.iAdInfo)||void 0===c||c.setMissedOpportunity("APSLA")}}(s,t);const a={shelves:[],metricsPageInformation:i,metricsLocationTracker:{rootPosition:0,locationStack:[]},groupingData:CI(n,qp),pageGenreAdamId:o,pageGenreId:II(n,th),hasAuthenticatedUser:Nh(dI.dsid),isSearchGrouping:!0,adStitcher:CD(t),adIncidentRecorder:s};WC(bb(r),a);const c=new AP(a.shelves),l=new kD;var u;return l.minimumPageOffScreenRefreshInterval=Xh.searchLandingPageOffscreenRefreshInterval,l.updateDelayInterval=Xh.searchLandingPageRefreshUpdateDelayInterval,c.pageRefreshPolicy=l,c.adIncidents=Lh(u=a.adIncidentRecorder)||Fh(u.incidents)?null:u.incidents,lP(c,a.metricsPageInformation),c}iadInfoFromOnDeviceAdResponse(e){return!eP()||Lh(e)?null:new DS($u,e.iAdId,e.clientRequestId)}trendingSearchesShelvesForResponse(e){return Oh.context("trendingSearchesShelfForResponse",()=>{const t={rootPosition:0,locationStack:[]},n=Bh(e,qn).map(e=>{const n=Gh(e,Df),r=new Nb(n,n,Gh(e,Sh),Dd);return VS(r,wh,t),tA(t),new uy(r)});let r=0;switch(Dm){case Ph:r=10;break;case kh:r=7}const o=new bS(hf);return o.title=n.length>0?Gh(e,Gn):null,o.isHorizontal=!1,o.items=n.slice(0,r),[o]})}}),DD(new class extends yb{constructor(){super("SearchTrendingContentPageBuilder")}pageType(){return hh}get pageRoute(){return[{protocol:Gy.internal,path:""+vT}]}defaultPlatforms(){return Ey()}defaultAttributes(){const e=[Cf,xf,Gp,wp,Xf];return by&&e.push(Jf),e}generatePageRequest(e,t){const n=this.fetchLimitForTrendingContentForATV();let r=(new Ry).forType(Bn).addingQuery("bubble[contents]",Ah).withLimit(n).includingMacOSCompatibleIOSAppsWhenSupported(!0);return host.clientIdentifier===_m&&(r=r.addingQuery(tp,Th)),r.attributingTo(e.build())}renderPage(e,t,n){return Oh.context(Kp,()=>this.trendingContentsPageFromCollectionResultsContainer(e))}trendingContentsPageFromCollectionResultsContainer(e){return Oh.context("trendingContentsPageFromCollectionResultsContainer",()=>{const t=aP(pp,null,e),n={pageInformation:t,locationTracker:{rootPosition:0,locationStack:[]},recoMetricsData:Cb(e)},r=Pb(e.results.contents),o=this.mixedMediaShelfFromLockupDataCollection(r,n),i=new wP([o]);return lP(i,t),i})}handlePageError(e,t,n,r,o){t(yb.createFlowAction(new wP([]),this.pageType(),r))}mixedMediaShelfFromLockupDataCollection(e,t){return Oh.context("lockupShelfFromLockupDataCollection",()=>{const n=new bS("mixedMediaLockup");n.title=sg("TRENDING_SHELF_TITLE");const r={showPlaybackControls:!1,canPlayFullScreen:!1,playbackControls:{}},o={metricsOptions:t,artworkUseCase:1,canDisplayArcadeOfferButton:DL("mixedMediaLockup")},i=[];for(const n of e){if(Lh(n.attributes))continue;const e=yx(n,o,r);e&&(i.push(e),tA(t.locationTracker))}const s=this.multipleOfItemsRequiredInMixedMediaShelfForATV();return n.items=BC(i,s),n})}fetchLimitForTrendingContentForATV(){return 9}multipleOfItemsRequiredInMixedMediaShelfForATV(){return 3}}),DD(new class extends _P{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t){return dP("accessory")}generatePageRequest(e,t){const n=[];for(const t of Object.keys(e.query))t.startsWith("id")&&n.push(e.query[t]);return this.requestWithFilter("deviceProtocol",n.join(","))}get pageRoute(){return[{query:[lw+"=accessoryLookup"]}]}}),DD(new class extends mb{constructor(){super("CollectionDeepLinkingController")}pageType(){return hh}get pageRoute(){return[{protocol:Gy.https,path:"{countryCode}/{tab}/recommendations",query:[""+Yw,Kw+"?",Qw+"?"]}]}handlePage(e,t,n,r,o){const i=t[RT],s=t[Yw],a=t[Kw],c=t[Qw];let l=(new Ry).forType(v).addingQuery(bh,i).addingQuery("filter[recoUseCase]",s).includingRelationships([fh]).includingAdditionalPlatforms(Ey());Mh(a)&&(l=l.addingQuery(D,a)),Mh(c)&&(l=l.addingQuery("seed",c)),jS(l).then(t=>{this.makeCollectionPage(s,t).then(t=>{let n;const o=this.createTabChangeActionForRequest(i),s=new Bg(hh,e.build());s.pageData=t,null!=o?(o.actions=[s],n=o):n=s,r(n)}).catch(e=>{o(new Error("CollectionDeeplinkingController: Failed to create GenericPage for useCase: "+s))})}).catch(e=>{o(new Error("CollectionDeeplinkingController: Failed to fetch Media API data for useCase: "+s))})}makeCollectionPage(e,t){const n=bb(t),r=CI(n,fh),o=new kP;return o.url=this.paginationUrl,o.title=yI(n,fd),o.metricsPageInformation=aP(Gd,e,t),o.metricsPageInformation.recoMetricsData=Cb(t),o.shouldFilter=!1,o.metricsLocationTracker={rootPosition:0,locationStack:[]},Promise.resolve(this.makePage(o,r))}makePage(e,t){return Oh.context("makePage",()=>{const n=e.preferredShelfContentType||"mediumLockup",r=new bS(n),o={id:null,kind:null,softwareType:null,targetType:ah,title:e.title,pageInformation:e.metricsPageInformation,locationTracker:e.metricsLocationTracker,idType:sp,recoMetricsData:Cb(t)};mA(r,o),JI(o,e.title),r.isHorizontal=!1,r.shouldFilterApps=e.shouldFilter;const i=Pb(t);e.remainingContent=[],r.items=Ax(i,{contentUnavailable:(t,n)=>(e.remainingContent=Ab(i,n),!0),lockupOptions:{metricsOptions:{pageInformation:e.metricsPageInformation,locationTracker:e.metricsLocationTracker},clientIdentifierOverride:e.clientIdentifierOverride,artworkUseCase:Ox(n)}});const s=new wP([r]);return s.title=e.title,e.remainingContent.length&&(s.nextPage=e),s})}createTabChangeActionForRequest(e){const t=e;return new Set([Lp,Ah,Ma,Vf,Tl,Th,bu,mp,"work","play",Jo,wl,Gf]).has(t)?new qg(t):null}handleShelf(e,t,n,r,o){o(new Error("OnDeviceRecommendationsPageController:handleShelf not implemented"))}get shelfRoute(){return[]}get paginationRoute(){return[{protocol:Gy.internal,path:""+this.paginationPath}]}handlePagination(e,t,n,r,o,i){Oh.context(this.builderClass+".handlePagination",()=>{const t=r,n=new Ry(t.remainingContent);if(!n)return void i(new Error("Could not construct media API request for: "+e));n.includingAdditionalPlatforms(Ey());const s=[lh,sh,Cf,xf];by&&s.push(Jf),n.includingAttributes(s),n.attributingTo(e.build()),jS(n).then(e=>{o(this.makePage(t,e))}).catch(e=>{i(e)})})}}),DD(new class extends PD{constructor(){super("PersonalizationTransparencyAdapterBuilder",Gf,SD.personalizationTransparency,wD.personalizationTransparency)}}),DD(new class extends mb{constructor(){super("DynamicUIBuilder")}pageType(){return va}handlePage(e,t,n,r,o){const i=new Bg(va);i.pageUrl=e.toString(),i.referrerUrl=e.build();const s=new Fg;s.metricsOverlay[hd]=e.build(),i.pageData=s,r(i)}get pageRoute(){const e=Xh.dynamicUIRegexStrings,t=[];for(const n of e)t.push(new RegExp(n,"i"));return[{regex:t}]}}),DD(new class extends mb{constructor(){super("WebUIPageBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=new Bg("webView");i.pageUrl=e.toString(),r(i)}get pageRoute(){const e=Xh.webViewRegexStrings,t=[];for(const n of e)t.push(new RegExp(n,"i"));return[{regex:t}]}}),DD(new class extends mb{constructor(){super("FinancePageBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=new Bg(Nf);i.pageUrl=e.toString(),Dm===Ch?WR(e).then(e=>r(e)).catch(e=>r(i)):r(i)}get pageRoute(){const e=Xh.financeUIRegexStrings,t=[];for(const n of e)t.push(new RegExp(n,"i"));return[{regex:t}]}}),DD(new class extends mb{constructor(){super("TabSelectionBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){var i;const s=e.pathComponents(),a=s.length-1;let c,l;c=a>=0?s[a]:e.query[hf],null!=c&&this.currentDeviceSupportsUrlAction(c)&&(l=new qg(c),l.popToRoot=null!=(i=e.query.popToRoot===Fp)&&i),void 0===l&&(l=new qg(Dm===kh||Dm===Ph?Lp:bu)),r(l)}get pageRoute(){const e=[Lp,Ma,Ah,bu,mp,"work","play",Jo,wl,Th],t=[];for(const n of e){const e=`${lw}=${n}`,r=""+n;t.push({query:[e]}),t.push({path:r}),t.push({path:"{countryCode}/"+r})}return t}currentDeviceSupportsUrlAction(e){const t=[Lp,Ah,Ma,Th,Vf],n=[bu,Ah,Ma,Th,Vf];return!(Dm!==Ch||![bu,Th,mp,"work","play",Jo,wl,Vf].includes(e))||(!(Dm!==kh&&Dm!==Ph||!t.includes(e))||!("tv"!==Dm||!n.includes(e)))}}),DD(new class extends mb{constructor(){super("PassbookBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){FD(this.assemblePassbookRoomURL(e).build()).then(r,o)}get pageRoute(){return[{query:[lw+"=passbook"]}]}assemblePassbookRoomURL(e){let t=Xh.passbookMainURL;return null!=t&&typeof t===Ih||(t="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new uI(t)}}),DD(new class extends mb{constructor(){super("LibraryLink")}pageType(){return dh}handlePage(e,t,n,r,o){FD(`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${e.query.g}&mt=8`).then(r,o)}get pageRoute(){return[{query:[lw+"=library-link"]}]}}),DD(new class extends mb{constructor(){super("LongUrlBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=e.query[Ua];if(Mh(i)){net.fetch({url:i,method:Fd,signingStyle:od}).then(e=>{let t;const n=e.headers["Content-Type"];if(e.ok&&e.redirected&&Nh(e.url))t=e.url;else{if(e.ok&&i!==e.url)return console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${i}. Redirected url: ${e.url}`),void r(new ly);if(e.ok&&Mh(n)&&-1!==n.toLowerCase().indexOf("text/xml")){const n=zh(plist.parse(e.body)),r=Gh(n,"action.kind"),o=Gh(n,"action.url");"Goto"===r&&o&&(t=o)}}Mh(t)?FD(t).then(r,o):o(new Error("Unable to map long url for: "+i))},e=>{o(new Error("Unable to fetch long url: "+i))})}else o(new Error("Original url is missing when creating action for checkForLongUrl."))}get pageRoute(){return[{query:[lw+"=checkForLongUrl"]}]}}),DD(new class extends mb{constructor(){super("WatchCategoryBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){if(Dm!==kh)return void o(new Error("Unsupported url for current platform: "+e));FD(Xh.watchAppsGroupingURL).then(e=>{const t=new qg(Ah);t.actions=[e],r(t)},o)}get pageRoute(){return[{query:[lw+"=watchCategory"]}]}}),DD(new class extends mb{constructor(){super("ExperimentLink")}pageType(){return dh}handlePage(e,t,n,r,o){const i={url:e.toString()},s=net.fetch(i);s.then(t=>{if(t.status>=200&&t.status<300){const t=new ny(nh);t.title="You have been enrolled in the AB test",t.message=`Test ${e.query.ab2} is now active on your device.`,t.buttonTitles=["OK"],t.buttonActions=[new qg(qf)],r(t)}else o(new Error(`unexpected response status: ${t.status} from ${t.url}`))}),s.catch(o)}get pageRoute(){return[{protocol:Gy.https,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}),DD(new class extends mb{constructor(){super("MultiplexingBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){jS((new Ry).forType(mc).withIds([t.id])).then(e=>this.actionFromMultiplexResponse(e)).then(r,o)}get pageRoute(){return[{protocol:Gy.https,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[KT]}]}actionFromMultiplexResponse(e){const t=Hh(e,"results.target"),n=Hh(e,"results.target-link");return t?this.targetDataToAction(t):n?this.targetLinkDataToAction(n):null}targetDataToAction(e){const t=Gh(e,gc);if(!t)return null;return FD(tb(t))}targetLinkDataToAction(e){const t=Gh(e,Sh),n=new uI(t),r=this.addProtocolToURLIfNeeded(n).toString();return Promise.resolve(new Vg(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol="https"),e}}),DD(new class extends mb{constructor(){super("ShowAccountPageBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){let i,s=[];if(Dm===Ch)i=Gf;else{i=Tl;const e=new Bg(Gf);e.presentationContext=np,e.animationBehavior=Wp,s=[e]}const a=new qg(i);a.actions=s,r(a)}get pageRoute(){return[{hostName:""+LT},{hostName:""+FT}]}}),DD(new class extends mb{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){r(new Bg(Nf,$P))}get pageRoute(){return[{hostName:""+NT}]}}),DD(new class extends mb{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=new qg("updates");if(Dm!==Ch){const e=new Bg(Gf);e.presentationContext=np,e.animationBehavior=Wp,i.actions=[e]}r(i)}get pageRoute(){return[{hostName:""+xT},{path:"updates"},{path:"{countryCode}/updates"},{query:[lw+"=updates"]}]}}),DD(new class extends mb{constructor(){super("FamilyCircleBuilder")}pageType(){return dh}defaultTab(e){return Th}handlePage(e,t,n,r,o){r(new cy(ap))}get pageRoute(){return[{hostName:""+zT},{path:""+zT}]}}),DD(new class extends mb{constructor(){super("AppClipSubscribeBuilder")}pageType(){return dh}handlePage(e,t,n,r,o){const i=Gh(t[Lw]);Nh(i)||o(new Error("No adamId supplied in appClipSubscribe url: "+e));jS((new Ry).withIds([i]).forType(Ah).includingAdditionalPlatforms(Ey())).then(e=>{const t=fx(bb(e),{metricsOptions:{pageInformation:new xS({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),n=(new uI).set("protocol",Gy.itmsApps).set("host","apps.apple.com").path(aT).path(i).build(),o=new Bg(of);o.pageUrl=n;const s=QP("arcadeGeneric",i,t.buttonAction),a=new qg(Th);a.actions=[o,s],r(a)})}get pageRoute(){return[{hostName:""+WT,query:[Lw,dw]}]}}),DD(new class extends mb{constructor(){super("MarketingItemUpsellBuilder")}pageType(){return hp}get pageRoute(){if(!Kh(Dl))return[];return[{hostName:""+GT,query:[Lw+"?",dw+"?",Bw+"?"],exclusions:[{query:[""+xw]}]},{path:"arcade/subscribe",query:[Lw+"?",dw+"?",Bw+"?"]},{path:"{countryCode}/arcade/subscribe",query:[Lw+"?",dw+"?",Bw+"?"]}]}handlePage(e,t,n,r,o){const i=function(e){var t;switch(e){case"askToBuy":return At;case"generic":return Mp;case Pr:return ql;case It:return _c;case $f:return zd;case"topShelfATV":return Xe;case"topShelfATVClickThrough":return tt;case Pu:return ii;case"editorialItemCanvas":return Al;case Tc:return Tc;case zl:return zl;case as:return as;default:return null!=(t=e)?t:Mp}}(Gh(t,dw)),s=Gh(t,Lw),a=new Lg(Th,i,s);a.metricsOverlay[hd]=e.build();const c=new Bg(hp);c.pageData=a,c.referrerUrl=e.build(),r(c)}}),DD(new class extends mb{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return jf}defaultTab(e){return Th}get pageRoute(){return[{path:"arcade/offers",query:[jw+"?"]},{path:"/{countryCode}/arcade/offers",query:[jw+"?"]}]}handlePage(e,t,n,r,o){var i;const s=null!=(i=t[jw])?i:"deeplink_hardware_firstchance",a=new Lg(Th,Mp,null,{offerHints:s});a.offerHints=s,a.metricsOverlay[hd]=e.build();const c=new Bg(hp);c.pageData=a,c.referrerUrl=e.build(),r(c)}}),DD(new TR),DD(new class extends mb{constructor(){super("ArcadeWelcomeBuilder")}pageType(){return"arcadeWelcome"}handlePage(e,t,n,r,o){const i=this.generatePage(t,n);r(mb.createFlowAction(i,this.pageType(),e))}get pageRoute(){return[{hostName:""+HT,query:[dw+"?"]}]}generatePage(e,t){return bR(e[dw])}}),DD(new class extends yb{constructor(){super("PrivacyDetailBuilder")}defaultPlatforms(){return Ey()}pageType(){return Es}get pageRoute(){return[{protocol:Gy.internal,path:`${DT}/${aT}/{id}`,query:[Gw+"?"]},{protocol:Gy.internal,path:`${DT}/${lT}/{id}`,query:[Gw+"?"]}]}generatePageRequest(e,t){const n=rb(e);if(!Mh(n))throw new Error(`Unable to map ${e.build()} to a media api url. Missing id.`);let r=Ah;const o=[Uc,Qp,Zl];-1!==e.pathname.indexOf(lT)&&(r=gh);return(new Ry).forType(r).withIds([n]).addingQuery(fc,o.join(","))}renderPage(e,t,n){return Oh.context(Kp,()=>{const n=t[Gw];return function(e,t){return Oh.context("privacyDetailPageFromResponse",()=>{const n=bb(e);if(Fh(n))return null;const r=aP("PrivacyDetails",n.id,e),o={rootPosition:0,locationStack:[]};let i=[];if(Dm!==Eh){const e=function(e,t,n){const r=new bS(df);r.isHorizontal=!1;const o=UO(e,!0,!0,t,n);return r.items=[o],r}(n,r,o);Nh(e)&&i.push(e)}const s=function(e,t,n,r){const o=mI(e,Uc);if(Fh(o))return[];const i=vO(o,e,kp,!0,t,n);if(0===i.length)return[];const s=[];for(const e of i)if(Lh(r)||e.identifier===r||Dm!==Eh){const t=new bS(Bc);if(e.wantsScrollFocus=Nh(e.identifier)&&e.identifier===r,t.items=[e],t.presentationHints={isSingleDensity:!0},s.push(t),Dm===Eh&&e.categories.length>0){const t=new bS(zt);t.items=e.categories,s.push(t)}for(const t of e.purposes){const e=new bS(zt);e.title="tv"===Dm||Dm===Eh?lg(t.title):t.title,e.items=t.categories,s.push(e)}}return s}(n,r,o,t);i=i.concat(s);const a=new wP(i);return a.title=sg(eu),Dm===Ch&&(a.presentationOptions=[Vd]),lP(a,r),a})}(e,n)})}}),DD(new class extends PD{constructor(){super("TopChartsAdapterBuilder",ac,SD.topCharts,wD.topCharts)}}),DD(new class extends PD{constructor(){super("ReviewsAdapterBuilder",of,SD.reviews,wD.reviews,[],null,YR.reviews,ID.reviews)}}),DD(new class extends PD{constructor(){super("SortedReviewsAdapterBuilder",mh,SD.sortedReviews,wD.sortedReviews)}}),DD(new class extends PD{constructor(){super("PersonalizedReviewsAdapterBuilder",dh,[],null,bD.personalizedReviews,AD.personalizedReviews)}}),DD(new class extends PD{constructor(){super("ProductInAppPurchaseAdapterBuilder",of,SD.productInAppPurchase,wD.productInAppPurchase)}}),DD(new class extends PD{constructor(){super("InAppPurchaseInstallAdapterBuilder",Da,SD.inAppPurchaseInstall,wD.inAppPurchaseInstall)}}),DD(new class extends PD{constructor(){super("DeveloperAdapterBuilder",hh,SD.developer,wD.developer,bD.developer,AD.developer)}}),DD(new class extends PD{constructor(){super("DeveloperHrefAdapterBuilder",hh,SD.developerHref,wD.developerHref)}}),DD(new class extends PD{constructor(){super("ArticleAdapterBuilder",jf,SD.article,wD.article)}}),DD(new class extends PD{constructor(){super("SearchAdapterBuilder",hh,SD.search,wD.search)}}),DD(new class extends PD{constructor(){super("MSOAdapterBuilder","mso",SD.msoRoom,wD.msoRoom,bD.mso,AD.mso)}}),DD(new class extends PD{constructor(){super("ResetAndRedirectAdapterBuilder",dh,SD.resetAndRedirect,wD.resetAndRedirect)}}),DD(new class extends PD{constructor(){super("ActionAdapterBuilder",dh,SD.action,wD.actionHandler)}}),DD(new class extends PD{constructor(){super("TodayAdapterBuilder",Lp,[],null,bD.today,AD.today)}});function MD(e,t=!0,n,r){const o=WD(e),i=$D(e),s=o.backgroundColor||i.backgroundColor,a=BD(e,n,r);return((e.type===gf?qh(GD(e),"displayMaterial"):wI(e,"displayBreakoutMaterial"))||"tv"===Dm&&a===yf)&&t?P:UD(s)}function UD(e){return e?Ly(e,50)?Hf:qd:Hf}function BD(e,t,n){if(Dm===kh||n)return yf;if("tv"===Dm)return t?yf:jp;const r=e.type===gf?Gh(GD(e),"textPosition"):yI(e,k);if(!Mh(r))return Dm===Ch?yf:jp;switch(r.toLowerCase()){case"left":return jp;case yf:return yf;case"right":return ci;default:return jp}}function qD(e,t,n=!1){const r="tv"===Dm;switch(e){case jp:case ci:return r?yf:jp;case yf:return n&&!r?yf:r?jp:t.type===gf?yf:function(e){var t;switch((null!==(t=yI(e,k))&&void 0!==t?t:"").toLowerCase()){case"left":return jp;case yf:return yf;case"right":return ci;default:return Dm===Ch?yf:jp}}(t);default:return jp}}function GD(e){return e.type!==gf?null:mI(e,"display.templateParameters")}function VD(e){return e.type===rh?mI(e,lh):mI(e,E)}function HD(e){switch(e.type){case gf:return Gh(Bk(e),_);default:return yI(e,"breakoutCallToActionLabel")}}function $D(e,t=!1){const n=VD(e),r=Dm===kh,o="tv"===Dm;let i=r?R:O;t&&(i="topShelf");const s=Hh(n,i);let a=null,c=null;return Mh(s)&&(a=vx(s,{withJoeColorPlaceholder:!0,useCase:6}),Mh(a)&&(a.crop=r?"oa":t?"ta":o?"od":"ob",c=a.backgroundColor)),{artwork:a,artworkData:s,backgroundColor:c}}function WD(e,t=!1){const n=function(e){return e.type===rh?mI(e,sh):mI(e,C)}(e),r=Dm===kh?"breakoutVideo9x16":"breakoutVideo16x9",o=Hh(n,Dm===kh?"sizzleVideo9x16":"sizzleVideo16x9")||Hh(n,r);let i=null,s=null,a=null;if(Mh(o)){a=Hh(o,dd);const e=vx(a,{withJoeColorPlaceholder:!0,useCase:6});Mh(e)&&(e.crop="sr",s=e.backgroundColor);const n=Gh(o,lf);Mh(e)&&Mh(n)&&(i=new BA(n,e,{canPlayFullScreen:!1,showPlaybackControls:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:t},autoPlayPlaybackControls:{}}))}return{video:i,artworkData:a,backgroundColor:s}}function zD(e){const t=Mh(mI(e,Wf)),n=wI(e,Ha);return!t&&!n}function jD(e){const t=mI(e,Wf),n=Mh(t),r=wI(e,Ha),o=_I(e,$a);if(!n&&!r&&!AI(o))return null;let i=null;if(i=n?Gh(t,Sh):yI(r?e:o,Sh),Lh(i))return null;let s=null;if(n&&Gh(t,Wa)===li){s=new Vg(i)}else{const e=xD(i),t=new Bg(e);t.pageUrl=i,e===of&&(t.pageData=iD(o)),s=t}return s.title=HD(e),s}function YD(e,t,n=Qf){if(Fh(e)||Fh(e.attributes))return null;const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:jI(e)},o=WD(e,!0),i=$D(e),s=o.backgroundColor||i.backgroundColor,a=BD(e,!0,!0),c="tv"===Dm,l=(u=MD(e,c,!0,!0),d=!0,u!==P&&d);var u,d;const p=XD(e,null,c,l,Cc);let f=null;"tv"!==Dm&&(f=p.description,p.description=null);const h=P_(o.artworkData||i.artworkData,!0),m=function(e){const t=GD(e),n=Gh(t,"ctaButtonBackgroundColor"),r=Gh(t,"ctaButtonTextColor");if(!Nh(n)||!Nh(r))return{type:Yl,fillColor:null,textColor:null};return{type:ns,fillColor:xy(n),textColor:xy(r)}}(e),g=new nm(Th,Xh.arcadeAppAdamId,n,null,Th,null,m,null,null,null,null,null,null,null,null,null,null,Xh.arcadeProductFamilyId),y=new HS(p,g,{backgroundColor:s,wantsMaterialDetailBackground:!1,wantsBlur:l,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:a},null,f,i.artwork,o.video),T=yA(e,y.details.title,{...r,targetType:Mu});T.displaysArcadeUpsell=!Xh.isArcadeComingSoonEnabled,mA(y,T),JI(T,y.details.title);const w=ZD(e,zl,r);return y.offerButtonAction=w,ZI(r.locationTracker),Mh(t)&&Fh(t.pageTitleEffect)&&0===t.shelves.length&&(t.pageTitleEffect=h),tA(t.metricsLocationTracker),y}function KD(e){return HD(e)}function QD(e){return yI(e,fd)}function JD(e){return yI(e,Ru)}function XD(e,t,n,r,o){let i=null;switch(o){case Cc:i={type:Cc};break;case up:const t=yI(e,"badge");i=Mh(t)?{type:up,title:t}:{type:kf};break;default:i={type:kf}}let s=MD(e,n,!0,!0);const a=BD(e,!0,!0);r&&(s=Hf);return new TS(QD(e),JD(e),i,null,s,qD(a,e,!0))}function ZD(e,t,n){let r=null;if(Xh.isArcadeComingSoonEnabled)r=new Vg("https://www.apple.com/apple-arcade/#notify-me"),r.title=KD(e);else{r=ex({marketingItemData:e},KD(e),n)}return r}function ex(e,t,n,r){const o=e.marketingItemData;if(!Nh(o))return null;const i=Bk(o),s=Gh(i,"kind")===Wf,a=Gh(i,Sh);if(s&&a){const e=function(e){const t=Xh.dynamicUIRegexStrings;for(const n of t){if(new RegExp(n).test(e)){const t=new Bg(va,e);return t.pageData=new Fg,t}}const n=Xh.financeUIRegexStrings;for(const t of n){if(new RegExp(t).test(e))return new Bg(Nf,e)}const r=Xh.webViewRegexStrings;for(const t of r){if(new RegExp(t).test(e))return new Bg("webView",e)}return new Vg(e,!1)}(a),r={id:Xh.arcadeAppAdamId,actionType:"buy",actionContext:ap,contextualAdamId:Xh.arcadeAppAdamId,offerType:es,targetType:wh,mercuryMetricsData:jI(o),...n};return e.title=t,BS(e,r),e}return function(e,t,n,r){const o=Bk(e),i=Gh(o,jl),s=Gh(o,Ul);if(!Nh(i)||!Nh(s))return null;const a=Bh(o,"serviceTypes"),c=a.length>1&&Xh.aristotleParentAppAdamId?Xh.aristotleParentAppAdamId:Xh.arcadeAppAdamId,l=new ay(i,c,{buyParams:s,productIdentifier:i},r),u={id:c,actionType:"buy",targetType:wh,subscriptionSKU:i,actionContext:ap,contextualAdamId:c,actionDetails:{buyParams:s},offerType:es,mercuryMetricsData:jI(e),...n};return l.title=t,BS(l,u),l}(o,t,n,r)}const tx={identifer:"wWq5csz",treatments:[0,1]};function nx(e,t){switch(e){case Tf:return t?Th:Kd;default:return t?xc:sf}}function rx(e,t,n){e&&Oh.context("copyDataIntoLockup",()=>{var r;const o=wI(e,ih);if(n.isContainedInPreorderExclusiveShelf&&!o)return null;t.adamId=e.id,t.bundleId=cA(e,bf),t.decorations=[];let i=null;n&&n.clientIdentifierOverride&&(i=n.clientIdentifierOverride),t.icon=Lx(e,{useCase:n.artworkUseCase},i),n&&n.titleObjectPath?t.title=cA(e,n.titleObjectPath):t.title=yI(e,bh);const s=uL(e);!s||"tv"===Dm&&host.clientIdentifier===bs||t.decorations.push(Th),n.shouldShowFriendsPlayingShowcase&&t.decorations.push("showcaseFriendsPlaying");const a=!s&&(null==(r=n.isMultilineTertiaryTitleAllowed)||r);if(n.isSubtitleHidden||function(e,t){return Oh.context("isBadgeMultilineFromData",()=>{if(!t)return!1;if(!Wx(e,Dm===Ch))return!1;if(ux(e))return!1;const n=$x(e);return Yx(n,Ph)||Yx(n,kh)})}(e,a)||(t.subtitle=ax(e)),t.tertiaryTitle=cx(e,a),t.tertiaryTitleAction=lx(e),t.developerTagline=cA(e,Ru),t.editorialTagline=dL(e,cd),t.editorialDescription=dL(e,ph),t.shortEditorialDescription=dL(e,af),t.ageRating=yI(e,Gt),t.productDescription=cA(e,Hl),!fC(e)){(II(e,Vt)>0||!n||!n.hideZeroRatings)&&(t.rating=II(e,Ht),t.ratingCount=pg(II(e,Vt)))}const c=NS(e,n.metricsOptions),l=Uk(e),u=zI(e,t.icon),d=qk(l,e,o,u,c),p=Bh(l,vi);let f=Wk(d,e,o,c,nh,n.ignoreIconInSidepack,i,n.shouldNavigateToProductPage);Nh(n)&&Mh(n.externalDeepLinkUrl)&&(f=xk(f,d.adamId,n.externalDeepLinkUrl,n.metricsOptions),Mh(n.crossLinkSubtitle)&&(t.crossLinkTitle=lg(yI(e,bh)),t.crossLinkSubtitle=n.crossLinkSubtitle)),t.buttonAction=f;const h=$E(e);if(h){const e=new ly,n=wA(c);n.actionType=Sl,n.targetType=Yp,BS(e,n);const r=new WA;r.shareAction=e,r.shareSheetData=h,t.contextMenuData=r}const m=_x(e);let g=!1;if(m){g=!(Hk(Uk(m))>0)}const y=nx(e.type,s);if(t.offerDisplayProperties=n?Kk(d,y,e,o,n.offerStyle,n.offerEnvironment,p[0],g,nh,n.shouldNavigateToProductPage):Kk(d,y,e,o,null,null,p[0],g,nh),!n||!n.skipDefaultClickAction){const r=Nh(n)?n.externalDeepLinkUrl:null;t.clickAction=kx(e,c,i,n.ignoreIconInSidepack,r)}n&&n.ordinal&&(t.ordinal=n.ordinal);const T=sA(e,Jl);if(T){const e=Gh(T,Lc);t.isEditorsChoice=e&&e===Fc}t.flowPreviewActionsConfiguration=CC(e,!1,i,t.clickAction,n.metricsOptions,c,n.externalDeepLinkUrl),t.children=ox(e,n);const w=gA(e,t,u,n.metricsOptions,n.canDisplayArcadeOfferButton);mA(t,w)})}function ox(e,t){const n=CI(e,Ah);if(n){return Ix(n,{lockupOptions:t,filter:0})}return null}function ix(e,t,n){e&&Oh.context("copyDataIntoInAppPurchaseLockup",()=>{rx(e,t,n);const r=_x(e);if(!r)return;t.productIdentifier=yI(e,jl),t.parent=fx(r,n),t.description=yI(e,Hl),t.isVisibleByDefault=wI(e,"isMerchandisedVisibleByDefault"),t.isSubscription=wI(e,Nc);const o=Uk(e),i=Bh(o,vi);t.offerDisplayProperties.hasDiscount=i.length>0,t.offerDisplayProperties.subscriptionFamilyId=yI(e,"subscriptionFamilyId");const s=new Bg(Da);s.presentationContext=np;const a=px(t.adamId,r.id);s.pageUrl=a;const c=new IP;c.parentLockup=wA(t.parent),c.lockup=wA(t),c.preInstallOfferDescription=iO(o),s.pageData=c;const l=yI(e,jl),u=cA(r,bf),d=yI(r,"firstVersionSupportingInAppPurchaseApi");if(d){const e=new jg(l,r.id,u,s,d);t.parent&&(e.appTitle=t.parent.title),e.productTitle=t.title;BS(e,{...n.metricsOptions,id:t.adamId,idType:Il,actionDetails:{parentAdamId:r.id}}),t.buttonAction=e}else{const e=new ny(nh);e.title=sg("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),e.message="",e.isCancelable=!0,t.buttonAction=e}const p=gA(e,t,"iap",n.metricsOptions,n.canDisplayArcadeOfferButton);if(!n||!n.skipDefaultClickAction){const n=bx(e,p);t.clickAction=n,t.productAction=n}!function(e,t){e&&(e.impressionMetrics||mA(e,t),e.parent&&e.parent.adamId&&(e.impressionMetrics.fields.parentAdamId=VI(e.parent.adamId)))}(t,p)},xi)}function sx(e,t,n,r){e&&(r.isNetworkConstrained||Oh.context("copyMediaIntoMixedMediaLockup",()=>{t.screenshots=qx(e,4,null,r.clientIdentifierOverride);const o=t.screenshots[0];t.trailers=[];const i=Nx(e,n,r.metricsOptions,t.adamId);Nh(i)&&(Fh(o)||i.mediaPlatform.isEqualTo(o.mediaPlatform))&&t.trailers.push(i)}))}function ax(e){return Oh.context("subtitleFromData",()=>{let t=!1;const n=uL(e),r=pI(tx);if(Nh(r)&&n)switch(r){case 0:break;case 1:t=!0;break;default:MI()}const o=cA(e,Ru);return o&&!t?o:dx(e)})}function cx(e,t=!1){return Oh.context("badgeFromData",()=>{if(Wx(e,Dm===Ch)){let n="";const r=$x(e);if(Yx(r,Ph)?n="DESIGNED_FOR_PAD":Yx(r,kh)&&(n="DESIGNED_FOR_PHONE"),Mh(n)){return ux(e)||(n+="_NOT_VERIFIED",t&&(n+="_EXPANDED")),sg(n)}}if(host.platform===Ef){if(uA(e,"hasSafariExtension",Jp))return sg("PRODUCT_LOCKUP_SAFARI_EXTENSION")}return null})}function lx(e){return Oh.context("badgeActionFromData",()=>{if(!Wx(e,Dm===Ch))return null;if(ux(e))return null;const t=$x(e);if(!Yx(t,Ph)&&!Yx(t,kh))return null;const n=new Bg(jf);return n.pageUrl="https://apps.apple.com/story/id"+Xh.appleSiliconMacUnverifiedBadgeEditorialItemId,n})}function ux(e){if(!by)return!0;const t=lA(e,$t,Ff);return!!Nh(t)&&t}function dx(e){return Oh.context("categoryFromData",()=>{const t=cA(e,"genreDisplayName");if(Mh(t))return t;const n=RI(e,"genres");if(n.length>0){let e=n[0];const t=6014..toString();if(e.id===t)for(const r of n){const n=yI(r,Ps);if(r.id!==t&&n===t){e=r;break}}return yI(e,bh)}{const t=gI(e,ks);return t.length>0?t[0]:null}})}function px(e,t){const n=(new EC).param(KT,t).param(Jw,e).build();return`${Gy.internal}:/${aT}/${jy}/?${n}`}function fx(e,t){return Oh.context("lockupFromData",()=>{if(!e)return Oh.unexpectedNull(Uf,$d),null;const n=FC(e);if(n){const n=mI(e,Pp);n&&t.metricsOptions.pageInformation.iAdInfo.apply(e.id,n)}if(!AI(e))return null;switch(e.type){case Tf:return hx(e,t);default:const r=new zA;return rx(e,r,t),n&&NC(e,r,t.metricsOptions),r}})}function hx(e,t){return Oh.context("inAppPurchaseLockupFromData",()=>{const n=new JA;return ix(e,n,t),n})}function mx(e,t){return Oh.context("bundleLockupFromData",()=>{const n=new ZA;return function(e,t,n){e&&Oh.context("copyDataIntoBundleLockup",()=>{rx(e,t,n);const r=CI(e,Ah);if(r){const e={lockupOptions:n};t.children=Ix(r,e)}})}(e,n,t),n})}function gx(e,t){return Oh.context("screenshotsLockupFromData",()=>{const n=new jA;return function(e,t,n){e&&Oh.context("copyDataIntoScreenshotsLockup",()=>{rx(e,t,n),t.screenshots=qx(e,4,null,n.clientIdentifierOverride)})}(e,n,t),n})}function yx(e,t,n){return Oh.context("mixedMediaLockupFromData",()=>{const r=new YA;return rx(e,r,t),sx(e,r,n,t),r})}function Tx(e,t,n){return Oh.context("mixedMediaAdLockupFromData",()=>{const r=new YA;return wI(e,"iad.format.images")?(sx(e,r,n,t),MC(e,r,t.metricsOptions),rx(e,r,t)):(rx(e,r,t),r.screenshots=[]),NC(e,r,t.metricsOptions),r})}function wx(e,t,n,r,o){return Oh.context("arcadeLockupFromData",()=>{const n=e.marketingItemData,i=new XA;i.title=sg("ARCADE_LOCKUP_TITLE","Apple Arcade");const s=e.marketingItemData;t={...t,mercuryMetricsData:jI(s)};let a,c=JD(n);if(Mh(c)){c=host.platform===Yf?c.replace(/\n/g," "):c,i.subtitle=c,i.nonsubscribedSubtitle=c,i.subscribedSubtitle=c}const l=KD(n);Kh(b)?(a=ZD(e.marketingItemData,0,t),a.title=l):Mh(l)?(a=QP(Al,null,null,{...t,id:n.id}),a.title=l):(a=JP(t.pageInformation,t.locationTracker),a.title=sg(ld,ud)),i.unsubscribedButtonAction=a;const u=JP(t.pageInformation,t.locationTracker);u.title=sg(ld,ud),i.subscribedButtonAction=u;const d=yA(e.marketingItemData,i.title,t);d.displaysArcadeUpsell=!0,mA(i,d);const p=new nm(Th,Xh.arcadeAppAdamId,r,null,o,null,null,null,null,null,null,null,null,null,null,null,null,Xh.arcadeProductFamilyId);return p.titles[ai]=sg(ld,ud),i.offerDisplayProperties=p,i})}function Ix(e,t){return Lh(e)?[]:Ax(e.data,t)}function Ax(e,t){return Oh.context("lockupsFromData",()=>{if(!e)return[];const n=[];let r=!1;for(let o=0;o<e.length&&!r;o++){const i=e[o];if(Lh(i.attributes)){t.contentUnavailable&&(r=t.contentUnavailable(i.id,o));continue}const s=t.lockupOptions;let a=63486;if(t.includeOrdinals){const n=t.ordinalDirection===S?e.length-o:o+1;s.ordinal=ug(n).toString()}if(null!==t.filter&&(a=t.filter),vS(i,a))continue;if(t.excludeIconInSidepacksIfNotTvOnly){LI(i,lp)||(s.ignoreIconInSidepack=!0)}const c=fx(i,s);c.isValid()&&(n.push(c),tA(t.lockupOptions.metricsOptions.locationTracker))}return n})}function Sx(e,t,n,r=!1,o=null){return Oh.context("actionFromData: "+e.type,()=>{switch(e.type){case Ah:case gh:return kx(e,t,n,r,o);case Tf:return bx(e,t);case rh:return Px(e,t,n);case xa:return function(e,t){if(!e)return null;return Oh.context("msoActionFromPlatformData",()=>{const n=yI(e,Sh);if(!n)return Oh.unexpectedNull(Uf,Ih,Sh),null;const r=new Bg("mso");return r.pageUrl=n,r.title=yI(e,bh),BS(r,t),r})}(e,t);case Af:return function(e,t){if(!e)return null;return Oh.context("groupingActionFromData",()=>{if(!e.href)return Oh.unexpectedNull(Uf,Ih,gc),null;const n=new Bg(hh);return n.pageUrl=OI(function(e){const t=[lh,sh,Cf,xf,Xf,Vp];by&&t.push(Jf);const n=new Ry(e).includingAttributes(t).includingMacOSCompatibleIOSAppsWhenSupported(),r=_y();return Nh(r)&&n.addingQuery(tp,r),n}(e.href)).toString(),n.title=Ex(e),BS(n,t),n})}(e,t);case Qd:default:return function(e,t){if(!e)return null;return Oh.context("genericActionFromData",()=>{const n=Gh(e,Bp),r=yI(e,Sh);if(!r)return Oh.unexpectedNull(Uf,Ih,Sh),null;const o=new Bg(hh);return o.pageUrl=r,o.title=n===Af?Ex(e):yI(e,bh),BS(o,t),o})}(e,t)}})}function bx(e,t){return Oh.context("iAPActionFromData",()=>{const n=_x(e);if(!n)return null;const r=new Bg(of),o=yI(n,Sh),i=yI(e,jl),s=wI(e,Nc);return r.pageUrl=function(e,t,n){const r=(new EC).param(Xw,e).param(iw,t).param(Zw,n.toString()).build();return`${Gy.internal}:/${aT}/${Wy}/?${r}`}(o,i,s),r.title=yI(e,bh),BS(r,t),r})}function Px(e,t,n,r){return e?Oh.context("editorialItemActionFromData",()=>{const o=yI(e,op),i=mI(e,Wf),s=o===Va||o===Mc,a=wI(e,Ha)||s,c=RI(e,rp),l=Mh(c)&&1===c.length;if(function(e){const t=Gh(e,Wa);return t&&t===li}(i))return function(e,t){return Oh.context("editorialItemExternalLinkActionFromData",()=>{const n=Gh(mI(e,Wf),Sh),r=new Vg(n),o=dL(e,af);if(o)r.title=o;else{const e=new uI(n);r.title=e.host}return BS(r,t),r})}(e,t);let u,d;if(a){u=jf;const t=uI.from(yI(e,Sh));Nh(r)&&t.param(Ew,JSON.stringify(r)),d=t.build()}else{if(l){return Sx(c[0],t,n)}u=dh,d=Gh(i,Sh)}const p=new Bg(u);p.pageUrl=d;let f=dL(e,bh);return Lh(f)&&(f=Gh(e,Df)),p.title=f,BS(p,t),p}):null}function kx(e,t,n,r=!1,o=null){return e?Oh.context("productActionFromData",()=>{let i=yI(e,Sh);if(!i)return Oh.unexpectedNull(Uf,Ih,Sh),null;let s={};const a=new uI(i);if(t.isAdvert){const n=Gh(e,Pe);null!==n&&n.length>0&&a.param("X-AppStore-iAdLineItem",n);const r=t.pageInformation.iAdInfo.clickFields;a.param("X-AppStore-iAdClickToken",JSON.stringify(r)),s={iAdClickFields:jh(r),iAdLineItem:n}}s.externalDeepLinkUrl=o,Nh(o)&&a.param("externalDeepLinkUrl",o),s.clientIdentifierOverride=n,Mh(n)&&a.param(Wt,n),i=a.toString();const c=new Bg(of);c.pageUrl=i,c.pageData=iD(e,s,r),c.title=yI(e,bh),t&&t.pageInformation&&(c.referrerUrl=t.pageInformation.pageUrl);return BS(c,wI(e,ih)?{...t,offerType:Ip,offerReleaseDate:Vk(e)}:t),c}):null}function Ex(e){const t=gI(e,ks);return Mh(t)?t[0]:yI(e,bh)}function Cx(e){if(!e)return!1;if(Dm===Eh)return!0;const t=function(e,t){return Wx(e,t)?cA(e,Jf):cA(e,xf)}(e,by);if(Fh(t))return!0;return Ym(t.split(" "))}function _x(e){return e?_I(e,sf):null}class Rx{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}function Ox(e){switch(e){case Lu:case si:case ch:return 1;case Of:return 2;case Pl:return 3;default:return 0}}function vx(e,t){return Oh.context("artworkFromApiArtwork",()=>{const n=!!Nh(t.allowingTransparency)&&t.allowingTransparency,r=!!Nh(t.withJoeColorPlaceholder)&&t.withJoeColorPlaceholder,o=Gh(e,Sh);if(Lh(o))return null;const i=qh(e,"hasP3"),s=[ik(n,i,t.useCase)];let a;if(qh(e,"supportsLayeredImage")&&"tv"===Dm&&s.push(sk("lcr",i,t.useCase)),n)a=Fy("clear");else if(r){const t=xy(Gh(e,_i));Lh(t)||(a=t)}Lh(a)&&(a=Fy(_t));const c=new im(o,t.overrideWidth||Vh(e,Rc),t.overrideHeight||Vh(e,Oc),s);return c.backgroundColor=a,c.checksum=Gh(e,ds),Nh(t.style)&&(c.style=t.style),Nh(t.cropCode)&&(c.crop=t.cropCode),c})}function Dx(e,t,n){return Oh.context(Rt,()=>{const r=Lx(e,n);if(!Nh(r))return null;const o=new FA(r),i=yI(e,bh);return mA(o,yA(e,i,t)),o})}function xx(e,t,n){return Oh.context(Rt,()=>{const r=[];Fh(t.targetType)&&(t.targetType=uh);for(const o of e){const e=Dx(o,t,n);e&&(r.push(e),tA(t.locationTracker))}return r})}function Lx(e,t,n){return Oh.context("iconFromData",()=>{if(!e)return Oh.unexpectedNull(Uf,$d),null;const r=e.type;let o;switch(n){case Em:case Cm:o=Ff;break;case Rm:o=bp;break;default:o=pA(e)}const i=n||host.clientIdentifier,s=PI(e,o,"circularArtwork");if((i===Em||Dm===Eh||uA(e,cp))&&Nh(s))return vx(s,{...t,style:"round"});const a=aL(e),c=iL(e)&&(i===Cm||a),l=PI(e,o,"ovalArtwork");if(c&&Nh(l))return vx(l,{...t,style:"pill"});let u;return r===Tf?(u=mI(e,uh),vx(u,{...t,style:"iap"})):r===gh?(u=mI(e,uh),vx(u,{...t,style:ps,allowingTransparency:!0})):(u=PI(e,o,uh),vx(u,o===bp||n===Rm?{...t,style:"tvRect"}:o===Jp?{...t,style:"unadorned",allowingTransparency:!0}:{...t,style:ps}))})}function Fx(e,t,n){if(!e)return null;const r=function(e){switch(e){case bd:return 18/bL.width;case Pd:return 18/AL.width;case hs:return 41.5/mL.width;case ms:return 39/gL.width;case Dt:return 34/PL.width;default:return null}}(t);return new am(e,t,n,r)}function Nx(e,t,n,r){const o=Ux(e,t);if(!o)return null;const i=o.videos,s=[];if(i&&i.length>0)for(const e of i)OA(e,{...n,id:r}),s.push(e);let a=null;return s.length>0&&(a=new QA,a.videos=s,a.mediaPlatform=o.mediaPlatform),a}class Mx{constructor(e,t){this.videos=e,this.mediaPlatform=t}}function Ux(e,t,n=null){return Oh.context("platformVideoPreviewFromData",()=>{const r=function(e,t){return sA(e,wp,t)}(e),o={};if(!r)return null;let i=Hx(e,host.clientIdentifier,Dm);if(Nh(n)){const e=[];for(const t of i)n.includes(t)&&e.push(t);i=e}if(0===i.length)return null;for(const e of i){const n=Xx(e,xm);for(const e of Object.keys(r)){const n=Bh(r,e),i=[];for(const r of n){const n=Hh(r,dd);if(!n){Oh.unexpectedNull(Uf,qu,`videoPreviewsByType.${e}.previewFrame`);continue}const o=Gh(r,lf);if(!o){Oh.unexpectedNull(Uf,Ih,`videoPreviewsByType.${e}.video`);continue}const s=ak(Gh(n,Sh),Vh(n,Rc),Vh(n,Oc),null,Gh(n,ds));i.push(new BA(o,s,t))}o[e]=i}for(const t of n)if(o[t])return new Mx(o[t],Fx(e,t))}return null})}function Bx(e){return Oh.context("videoPreviewsFromApiPlatformData",()=>{const t=Ux(e,_S);return t?t.videos:[]})}function qx(e,t,n=null,r){return Oh.context("screenshotsFromData",()=>{const o=[];let i=n;if(!i||0===i.length){const t=r||host.clientIdentifier;let n=Dm;t===Em&&(n=Eh),i=Hx(e,t,n)}for(const n of i){const r=[];let i;if(Kh(Gu)?n===Zf?(i=cL(e,Ff),sL(e,Ff)&&r.push("faceTime")):i="tv"===n&&host.platform!==id?lL(e,bp):n===Ch&&host.platform!==Ef?lL(e,Jp):n!==kh&&n!==Ph&&n!==Eh||host.platform===Yf||host.platform===fs?lL(e):lL(e,Ff):n===Zf?(i=cL(e),sL(e)&&r.push("faceTime")):i="tv"===n&&host.platform===Yf?lL(e,bp):lL(e),!i)continue;const s=Vx(i,n,t,r);s&&o.push(s)}return o})}function Gx(e,t,n=null,r){return function(e){const t=[];if(e&&e.length>0)for(const n of e){const e=[];for(const t of n.artwork){const n=new qA;n.screenshot=t,e.push(n)}const r=n.mediaPlatform,o=new GA(e,r);t.push(o)}return t}(qx(e,t,n,r))}function Vx(e,t,n,r){const o=Xx(function(e){if(e===Zf)switch(Dm){case Ph:return Ph;default:return kh}return e}(t),xm);let i,s=null;for(let t=0;t<o.length&&!Mh(s);t++)s=Bh(e,o[t]),i=o[t];if(Mh(s)){const e=s.map((function(e){return vx(e,{useCase:n})})),o=Fx(t,i,r);return new sm(e,o)}return null}function Hx(e,t,n){return By(e,`sortedAppPlatformsFromData.${t}.${n}`,()=>{const r=$x(e),o=[];let i=[];if(!Kh(Gu)&&r.length>1)switch(n){case kh:case Ph:case Eh:o.push(Ch)}const s=function(e,t){-1===i.indexOf(e)&&-1===o.indexOf(e)&&-1!==r.indexOf(e)&&(i.push(e),t&&o.push(t))};switch(t){case Em:s(Eh);break;case Cm:s(Zf)}switch(n){case kh:s(kh);break;case Ph:s(Ph);break;case"tv":s("tv");break;case Eh:s(Eh);break;case Ch:Kh(Gu)?s(Ch):s(Ph)}return Kh(Gu)?(by?(s(Ph),s(kh)):(s(kh),s(Ph)),s(Ch),s("tv"),s(Eh),s(Zf)):(s(kh),s(Ph),s(Zf),s(Eh),s("tv"),s(Ch)),i=i.filter((function(e){return-1===o.indexOf(e)})),i})}function $x(e){return e?By(e,"supportedAppPlatformsFromData",()=>{let t;t=Kh(Gu)?iL(e,Ff):iL(e);const n=aL(e),r=function(e){return uA(e,Cf)}(e),o=gI(e,Ot),i=[];for(const e of o)switch(e){case Rf:n||i.push(kh);break;case Mf:n||i.push(Ph);break;case lp:i.push("tv");break;case Eh:i.push(Eh)}return t&&i.push(Zf),r&&i.push(Eh),xI(e,Ch)&&i.push(Ch),i}):null}function Wx(e,t){return t&&wI(e,Y)}function zx(e,t){if(Wx(e,t)){const t=cA(e,"minimumMacOSVersion");if(Mh(t))return t}return kI(e,pA(e),Xf)}function jx(e,t){switch(e){case kh:return[kh,Zf];case Ph:return[kh,Ph,Zf];case"tv":return["tv"];case Eh:return[Eh];case Ch:return t?[Ch,kh,Ph]:[Ch];default:return[]}}function Yx(e,t){return-1!==e.indexOf(t)}function Kx(e,t,n,r=!0){const o=function(e,t){switch(e){case kh:return[kh,Eh,Zf,"tv"];case Ph:return[kh,Ph,Zf,"tv"];case"tv":return["tv"];case Eh:return[Eh];case Ch:return t?[Ch,kh,Ph]:[Ch];default:return[]}}(t,n);return!!o.some(t=>Yx(e,t))&&(Dm!==Ch||!o.includes(Ch)||r)}function Qx(e,t,n){const r=function e(t){var n;const r=new Rx;if(Dm!==Ch)return r;if(t.type!==gh)return r.runsOnIntel=null==(n=lA(t,"runsOnIntel",fA()))||n,r.runsOnAppleSilicon=uA(t,"runsOnAppleSilicon",fA()),r.requiresRosetta=uA(t,vt,fA()),r;const o=RI(t,Ah);if(0===o.length)return r;for(const t of o){if(Lh(t.attributes))continue;const n=e(t);r.runsOnIntel=r.runsOnIntel&&n.runsOnIntel,r.runsOnAppleSilicon=r.runsOnAppleSilicon&&n.runsOnAppleSilicon,r.requiresRosetta=r.requiresRosetta||n.requiresRosetta}return r}(e);return t?r.runsOnAppleSilicon&&(!r.requiresRosetta||r.requiresRosetta&&n):r.runsOnIntel}function Jx(e,t,n){return function(e,t){switch(e){case kh:return[kh,Eh,Zf];case Ph:return[kh,Ph,Zf];case"tv":return["tv"];case Eh:return[Eh];case Ch:return t?[Ch,kh,Ph]:[Ch];default:return[]}}(t,n).some(t=>Yx(e,t))}function Xx(e,t){switch(e){case Ch:return[Ch];case Eh:return[Dt,"appleWatch"];case"tv":return["appleTV"];case Ph:{const e=[];return t.isEqualTo(bL)&&Lm>0?(e.push(bd),e.push(Pd),e.push(Vu),e.push(Hu),e.push(Mf)):t.isEqualTo(SL)?(e.push(Vu),e.push(bd),e.push(Pd),e.push(Hu),e.push(Mf)):t.isEqualTo(AL)?(e.push(Pd),e.push(bd),e.push(Vu),e.push(Hu),e.push(Mf)):t.isEqualTo(IL)?(e.push(Hu),e.push(Mf),e.push(Pd),e.push(Vu),e.push(bd)):t.isEqualTo(kL)?(e.push(Pd),e.push(Vu),e.push(bd),e.push(Hu),e.push(Mf)):(e.push(Mf),e.push(Hu),e.push(Pd),e.push(Vu),e.push(bd)),e}case kh:{let e;e=t.isEqualTo(mL)||t.isEqualTo(_L)?hs:t.isEqualTo(gL)||t.isEqualTo(EL)||t.isEqualTo(CL)?ms:t.isEqualTo(wL)?Rf:t.isEqualTo(TL)?"iphone5":t.isEqualTo(yL)?"iphone6":"iphone6+";const n=RL.indexOf(e),r=RL.slice(0,n);r.reverse();const o=RL.slice(n+1);return[e].concat(r,o)}default:return[]}}function Zx(e,t){return Oh.context("capabilitiesFromData",()=>{const n=[];uA(e,Gl)&&n.push(new VA(nf)),uA(e,"isSiriSupported")&&n.push(new VA(vc)),uA(e,"supportsPassbook")&&n.push(new VA("wallet")),uA(e,xt)&&n.push(new VA(Lt));const r=yI(e,"familyShareEnabledDate");if(r&&!wI(e,gd)){const o=new Date(r),i=new Date;if(o&&o<=i){const r=uA(e,Ui),o=r&&uA(e,"hasFamilyShareableInAppPurchases"),i=Dm===kh||Dm===Ph||Dm===Ch;let s;Mh(Xh.familySubscriptionsLearnMoreEditorialItemId)&&i&&o&&(s=new Bg(jf),s.title=sg("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),s.pageUrl="https://apps.apple.com/story/id"+Xh.familySubscriptionsLearnMoreEditorialItemId);let a=null;o?a=s?Ft:Nt:r||t||(a=s?Mt:Ut),a&&n.push(new VA(a,s))}}return n})}function eL(e){if(Lh(e))return null;if(Dm===Ch)return function(e){const t=Uk(e);if(Lh(t))return null;const n=Bh(t,"assets");if(!n.length)return null;for(const e of n){if(Gh(e,"flavor")===We)return Vh(e,bc)}return null}(e);{const t=mI(e,us);if(t){let e=[];Nm&&(e=Nm.split(" ")),e=e.concat([host.deviceModel,"universal"]);for(const n of e){const e=Vh(t[n]);if(e)return e}}}return null}function tL(e,t){let n,r=null,o=null,i=null,s=null,a=null,c=null;const l=pI(fI);if(Nh(l))switch(l){case 0:break;case 1:if(!t.supportsArcade&&!t.presentedInTopShelf)return null;break;default:MI()}switch(Dm){case Ch:t.supportsArcade?(r=gs,i="sr"):(r="editorialArtwork.centeredFullscreenBackground",i="ep");break;case"tv":t.presentedInTopShelf?(r=L,i="sr"):(r=gs,i="ta",o="editorialArtwork.fullscreenBackground",s="sr"),Kh("dontOverrideTvUberDimensions")||(a=1080,c=1920);break;default:t.supportsArcade?t.prefersCompactVariant||Dm===kh?(r="editorialArtwork.splashTall",i="oc"):(r=gs,i="oh"):(r=ja,i="sr")}return n=sA(e,r),null!==o&&Fh(n)&&(n=sA(e,o),null!==s&&(i=s)),Nh(n)&&Nh(i)?vx(n,{cropCode:i,useCase:20,withJoeColorPlaceholder:!0,overrideHeight:a,overrideWidth:c}):null}function nL(e,t,n,r){let o=[];if(Mh(n))o=n;else switch(Dm){case Ch:case"tv":o=[ys];break;case Ph:o=[Ts];break;default:o=[ws]}let i=null,s=null;for(const t of o)if(i=sA(e,[sh,t]),s=sA(e,[sh,t,dd]),Mh(i))break;const a=null!=r?r:vx(s,{useCase:t,withJoeColorPlaceholder:!0,cropCode:"sr"});if(Nh(i)){const e=Gh(i,lf);if(Lh(e))return null;let t,n;Kh("productVideoUberControls")?(t=ES,n={muteUnmute:!0}):(t={},n={});return new BA(e,a,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,showPlaybackControls:!1,playbackControls:t,autoPlayPlaybackControls:n})}return null}function rL(e,t){let n=null;switch(Dm){case Ch:case"tv":case kh:n=[ys,Ts,ws];break;default:n=[Ts,ys,ws]}return nL(e,20,n,t)}function oL(e){return Nh(e)?`${Gy.internal}:/${uT}/${bT}?${kw}=${e.href}`:null}function iL(e,t){return uA(e,"hasMessagesExtension",t)}function sL(e,t){return uA(e,As,t)}function aL(e){return uA(e,"isHiddenFromSpringboard")}function cL(e,t){return sA(e,Ss,t)}function lL(e,t){return sA(e,Gp,t)}function uL(e){return uA(e,Ja)}function dL(e,t){return pL(e,t)||cA(e,["itunesNotes",t])}function pL(e,t){return cA(e,[Dc,t])}function fL(e){return By(e,"isMacOSInstaller",()=>{if(!(Dm===Ch))return!1;const t=cA(e,bf);return!!Nh(t)&&t.startsWith("com.apple.InstallAssistant")})}function hL(e){return Kh("appConduitForSAD")?OS.isDeletableSystemAppFromData(e)?OS.isUnsupportedDeletableSystemAppFromData(e):!!$m&&(!uA(e,pi)&&!uA(e,cp)):!!function(e,t){if(t&&OS.isDeletableSystemAppFromData(e)){const t=yI(e,"watchBundleId");if(Mh(t))switch(t){case"com.apple.podcasts.watchkitapp":case"com.apple.Home.watchkitapp":case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0;default:return!1}}return!1}(e,$m)||($m?OS.isDeletableSystemAppFromData(e)?!uA(e,fi)&&!uA(e,cp):!uA(e,pi)&&!uA(e,cp):Dm===Eh&&OS.isDeletableSystemAppFromData(e)&&!uA(e,cp))}const mL=new cm(414,896),gL=new cm(375,812),yL=(new cm(414,736),new cm(375,667)),TL=new cm(320,568),wL=new cm(320,480),IL=(new cm(768,1024),new cm(834,1112)),AL=new cm(834,1194),SL=new cm(1024,1366),bL=new cm(1024,1366),PL=new cm(368,448),kL=new cm(820,1180);let EL=new cm(360,780),CL=new cm(390,844),_L=new cm(428,926);const RL=[hs,ms,"iphone6+","iphone6","iphone5",Rf];function OL(e){if(Lh(e)||0===e.length)return!0;const t=e.split("."),n=Vh(t[0])||0,r=Vh(t[1])||0,o=Vh(t[2])||0;return host.isOSAtLeast(n,r,o)}function vL(e){return!Lh(e)&&0!==e.length&&Jm(e)}function DL(e){if("tv"===Dm)switch(e){case Mu:return!0;default:return!1}else switch(e){case ch:case Of:case xu:case Rl:case Yd:case Mu:case kl:return!0;default:return!1}}function xL(e,t){const n=uA(e,Ja),r=Uk(e);if(Gh(r,Bp)===Ip&&n){const t=Gh(r,Bl),n=cA(e,Vp);if(Mh(n)&&t){const e=LS(t);let r=hg(sg("MMM y"),e),o=hg(sg("MMM d, y"),e);return"tv"===Dm&&(r=r.replace(/ /g,"\xa0"),o=o.replace(/ /g,"\xa0")),n.replace("@@expectedDateMY@@",r).replace("@@expectedDateMDY@@",o)}}return t}function LL(e){const t=_I(e,$a);return Mh(t)?t:uA(e,Ha)?_I(e,rp):null}function FL(e,t=host.clientIdentifier,n=[],o=r){e||(e=o.deviceType===Ch?39:36);const i=(new Ry).forType(wl).includingAdditionalPlatforms(n).includingMacOSCompatibleIOSAppsWhenSupported(!0).addingQuery(th,""+e);return t===Em?i.addingContext(Eh):t===Cm&&i.addingContext(Zf),i}function NL(e,t=!0){return Oh.context("categoryListFromApiResponse",()=>{const n=function e(t,n=!0){return Oh.context("categoryFromApiResponse",()=>{if(!t)return null;const r=Gh(t,bh),o=Gh(t,th),i=Gh(t,pd),s=vx(Hh(t,uh),{allowingTransparency:!0,useCase:19}),a=Bh(t,vf).map(t=>e(Hh(t),n)).filter(e=>Nh(e)),c=a.sort((e,t)=>{try{return e.name.localeCompare(t.name,og,{usage:uf})}catch(e){return 0}});const l=Gh(t,Df);return l&&n&&c.unshift(new Oy(l,o,s,i,[])),new Oy(r,o,s,i,c)})}(Hh(Bh(e,"results.categories"),"0"),t);return n?new vy(n.children):null})}class ML extends Zh{constructor(e,t){super(),this.lockups=e,this.missingIds=t}}class UL extends em{constructor(e,t,n,r){super(),this.value=e,this.isSelected=t,this.displayName=n,this.clickAction=r}}class BL extends Zh{constructor(e,t,n){super(),this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class qL extends Ug{constructor(e,t){super("GuidedSearchTokenToggleAction"),this.targetToken=e,this.searchOrigin=t}}class GL extends Ug{constructor(e,t){super("SearchEntityChangeAction"),this.entity=e,this.searchOrigin=t}}function VL(e,t,n){if(Fh(t))return null;const r=new qL(t.displayLabel,Ys);!function(e,t,n){const r={actionType:"guidedSearch",location:QI({pageInformation:null,locationTracker:n.locationTracker,targetType:"guidedLabel"},e.targetToken),searchTerm:t},o={targetId:e.targetToken},i=PA(e.targetToken,"guidedLabel",r,[vd]);e.actionMetrics.addMetricsData(i);const s=kA(t,"guidedLabel","guidedSearch",null,o,[vd]);e.actionMetrics.addMetricsData(s)}(r,e.term,n);const o=new UL(t.displayLabel,t.isSelected,t.displayLabel,r);return sP(o,Rn,n),o}function HL(e,t){const n=e.searchEntity;if(!n)return null;const r=new GL(null,Ys);let o;switch(function(e,t,n,r){const o={targetId:n},i=PA(n,"hintsEntity",{actionType:"guidedSearch",location:QI({pageInformation:null,locationTracker:r.locationTracker,targetType:"hintsEntity"},n),searchTerm:t});e.actionMetrics.addMetricsData(i);const s=kA(t,"hintsEntity","guidedSearch",null,o);e.actionMetrics.addMetricsData(s)}(r,e.term,n,t),n){case Th:o=sg("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE");break;case Lf:o=sg("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS");break;case cu:o=sg("GUIDED_SEARCH_TOKEN_ENTITY_STORIES");break;case Eh:o=sg("GUIDED_SEARCH_TOKEN_ENTITY_WATCH");break;default:MI()}const i=new UL(o,!0,o,r);return sP(i,lu,t),i}function $L(e,t){const n=wA(e),r=wA(e.attributes);return r.iads=t.adData,n.attributes=r,LC(n,t.instanceId),n}function WL(e,t){const n=e||{},r=[];Dm!==Ch&&r.push(new Rb(uu,[new Ob(sg(Ks),null,n[uu]),new Ob(sg(xn),Rf,n[uu])])),r.push(new Rb(Td,[new Ob(sg(Qs,Xd),null,n[Td]),new Ob(sg(Ln,Xd),"free",n[Td])]));const o=NL(t,!1);if(o){const e=o.categories;if(e.length){const t=e.filter(e=>Nh(e.genreId)).map(e=>new Ob(e.name,e.genreId,n[th]));t.unshift(new Ob(sg(Js,Xd),null,n[th])),r.push(new Rb(th,t))}}const i=Xh.searchSortOptions,s=[];s.push(new Ob(sg(Xs),null,n[uf]));for(const e of i)s.push(new Ob(sg(Fn+e),e,n[uf]));s.length>1&&r.push(new Rb(uf,s));const a=Xh.ageBands.map(e=>new Ob(Gh(e,bh),Gh(e,"ageBandId"),n[pd]));return a.length>0&&Dm!==Ch&&r.push(new Rb(pd,a)),r}function zL(e){let t=null,n=null,r=null;const o=new B_(uu,sg("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),Sd,null,[new U_(sg(Ks),null),new U_(sg(xn),Rf)],null,null,YL(uu)),i=new B_(Td,sg("SEARCH_FACET_TYPE_TITLE_PRICE"),Sd,sg("SEARCH_FACET_DEFAULT_ANY"),[new U_(sg(Qs,Xd),null),new U_(sg(Ln,Xd),"free")],null,null,YL(Td)),s=NL(e,!1);if(s){const e=s.categories;if(e.length){const n=e.filter(e=>Nh(e.genreId));t=new B_(th,sg("SEARCH_FACET_TYPE_TITLE_CATEGORY"),Sd,null,[new U_(sg(Js,Xd),null)],null,null,YL(th));for(const e of n)t.options.push(new U_(e.name,e.genreId))}}const a=Xh.searchSortOptions;n=new B_(uf,sg("SEARCH_FACET_TYPE_TITLE_SORT"),Sd,null,[new U_(sg(Xs),null)],null,null,YL(uf));for(const e of a)n.options.push(new U_(sg(Fn+e),e));const c=Xh.ageBands.map(e=>new U_(Gh(e,bh),Gh(e,"ageBandId")));c.length>0&&Dm!==Ch&&(r=new B_(pd,sg("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),Sd,sg("SEARCH_FACET_DEFAULT_ALL"),c,null,null,YL(pd)));const l=new G_([],!1,null);if(Dm===Ch)l.facetGroups.push(new q_([i])),Nh(t)&&l.facetGroups.push(new q_([t])),l.facetGroups.push(new q_([n]));else{const e=[o,i];Nh(t)&&e.push(t),e.push(n),Nh(r)&&e.push(r);for(const t of e)t.showsSelectedOptions=!0;l.facetGroups.push(new q_(e))}return l}function jL(){return{targetPlatform:[new U_(sg(Ks),null)],price:[new U_(sg(Qs,Xd),null)],sort:[new U_(sg(Xs),null)],genre:[new U_(sg(Js,Xd),null)]}}function YL(e){const t=new ly;return GS(t,e),t}function KL(e){if(!wI(e,ea))return null;const t=yI(e,$n);if(Mh(t))return t;const n=yI(e,Df);return Mh(n)?n.replace(/\n/g," "):null}function QL(e,t){if(host.platform!==Yf)return!1;if(1!=(qh(t,"experiments.showGridCard")?0:1))return!1;switch(e.type){case Af:return Mh(gI(e,aa));case Vl:case ol:return!0;case rh:switch(yI(e,op)){case Va:case Mc:case Nd:case"River":return!0;default:return!1}default:return!1}}function JL(e,t){const n=function(e){const t=KL(e);if(Mh(t))return t;return sg("EDITORIAL_SEARCH_RESULT_TYPE_COLLECTION")}(e),r=dL(e,bh),o=yA(e,r,{targetType:Fl,pageInformation:t.pageInformation,locationTracker:t.locationTracker});JI(o,r);const i=Sx(e,{actionType:_f,targetType:wh,pageInformation:t.pageInformation,locationTracker:t.locationTracker,id:"See All",idType:oh},host.clientIdentifier);i.title=sg(Tp);const s={lockupOptions:{metricsOptions:{pageInformation:t.pageInformation,locationTracker:t.locationTracker,targetType:Yp},artworkUseCase:8},filter:0},a=Ax(RI(e,rp),s);ZI(t.locationTracker);const c=new Db(n,r,a,i);return mA(c,o),Fh(a)?null:c}function XL(e,t,n,r,o){return Oh.context("searchResultFromData",()=>{let i;const s=e.type,a={metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:Fl},hideZeroRatings:!0,artworkUseCase:8,isNetworkConstrained:r,canDisplayArcadeOfferButton:DL(Yd),clientIdentifierOverride:ZL(o),isMultilineTertiaryTitleAllowed:!1};switch(s){case Vl:case ol:case Qd:case rh:case Af:const r=bE(e,{useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0},n);if(r&&r.media&&r.media.kind===Kd){const e=r.media.lockup;e.theme=Hf,i=new vb(Kd,e)}else{if(QL(e,t)){const t=JL(e,n);return t?new vb("lockupCollection",t):null}{const t=function(e,t){return Oh.context("editorialSearchResultFromData",()=>{let n=new Fb;n.title=yI(e,bh);const r={pageInformation:t.pageInformation,locationTracker:t.locationTracker};switch(e.type){case Af:const t=gI(e,aa);if(Mh(t))n.collectionAdamIds=t;else{const t=vx(mI(e,uh),{useCase:9,allowingTransparency:!0});n.iconArtwork=t}n.type=$l;break;case Vl:case ol:n.artwork=vx(mI(e,uh),{useCase:9,cropCode:"sr"}),n.collectionAdamIds=gI(e,aa),n.type=D;break;case rh:n=function(e,t){const n={useThreeLineOverlayForBranded:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0};n.prevailingCropCode="fo";const r=bE(e,n,t);if(!r)return null;const o=new Fb;o.type=cu,o.title=r.title,o.clickAction=r.clickAction;let i=null;if(r.media)switch(r.media.kind){case Zp:const t=r.media;o.artwork=t.art,Lh(o.artwork)&&(o.iconArtwork=t.icon);switch(yI(e,op)){case qa:case Ga:const t=_I(e,rp);t&&(o.title=yI(t,bh)||o.title)}break;case"list":const n=r.media;i=n.lockups;break;case"river":const s=r.media;i=s.lockups;break;case uh:const a=r.media;o.artwork=a.art;break;case Ed:const c=r.media;i=c.lockups;break;case pu:const l=r.media;i=l.lockups;break;case lf:const u=r.media;if(o.artwork=u.video.preview,o.video=u.video,r.overlay instanceof Ek){const e=r.overlay;o.title=e.title,o.subtitle=e.description}else o.subtitle=u.description}if(r.overlay)switch(r.overlay.kind){case Yp:const e=r.overlay;o.artwork||(i=[e.lockup]);break;case Wn:const t=r.overlay;i=t.lockups;break;case tf:const n=r.overlay;o.subtitle=n.paragraph.text}if(Nh(i)){o.collectionAdamIds=[],o.collectionAppIcons=[];for(const e of i)o.collectionAdamIds.push(e.adamId),o.collectionAppIcons.push(e.icon)}const s=KL(e);Mh(s)&&s!==o.title&&(o.tagline=s);const a=r.heroMedia;Mh(a)&&(Mh(a.art)?(o.artwork=a.art,o.artwork.crop="em"):Mh(a.video)&&(o.video=a.video));o.video&&(o.video.showPlaybackControls=!1,o.video.canPlayFullScreen=!1,o.video.playbackControls={});if(!o.collectionAdamIds&&!o.artwork&&!o.iconArtwork)return null;return o}(e,r);break;case Qd:if(n.artwork=vx(mI(e,ja),{useCase:9,cropCode:"sr"}),!n.artwork){let t=RI(e,"top-apps");t=t.filter(e=>!vS(e,55028));const r=[],o=[];t.forEach(e=>{r.push(e.id);const t=Lx(e,{useCase:9});Nh(t)&&o.push(t)}),n.collectionAdamIds=r,n.collectionAppIcons=o}n.type=Lf}if(n){if(null!=n.collectionAdamIds&&n.collectionAdamIds.length){const e=n.collectionAdamIds.length;n.artworkGridType=e<=8?Ud:e<=16?"mixed":Ou}const r=yA(e,n.title,t);n.clickAction=Sx(e,r,null),mA(n,r)}return n})}(e,a.metricsOptions);if(!t)return null;t.title&&(t.title=t.title.replace(/\n/g," ")),t.subtitle&&(t.subtitle=t.subtitle.replace(/\n/g," ")),i=new vb(oa,t)}}break;case Tf:const o=hx(e,a);o.theme=Hf,i=new vb(Kd,o);break;case Ah:case gh:default:if(delete e.attributes.iad,s===gh){const t=mx(e,a);i=new vb($i,t)}else{const t=yx(e,a,{showPlaybackControls:!1,canPlayFullScreen:!1,playbackControls:{}});i=new vb("content",t)}}return i})}function ZL(e){return e===Eh?Em:null}function eF(e,t,n,r,o=null){const i=[],s=[];let a;XI({pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:ra},""),eP()&&o&&(a=function(e,t,n,r){var o;const i=[],s=null!=(o=n.requestDescriptor.isNetworkConstrained)&&o;JI({id:rl,kind:On,softwareType:null,targetType:null,title:rl,pageInformation:r.pageInformation,locationTracker:r.locationTracker,idType:oh},rl);const a=t[0];let c,l="Adverts received from ad server: ";for(const t of e)l=l+"["+t.id+"], ";Jb(l);let u=!0;for(const t of e){if(vS(t)){Jb(`[${t.id}] filtered by media_shouldFilter() - app probably not supported on current os or device`);continue}const e=jb(t,a);if(t.attributes.iad=zb(t,e),Fh(t.attributes.iad)){Jb(`[${t.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`);continue}const n={metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:Fl,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:8,isNetworkConstrained:s,canDisplayArcadeOfferButton:DL(Yd)},o=qh(sA(t,Pp),"format.images"),l=Fh(c),d=Vb(Wb(Tx(t,n,Gb)),t.id,e,o,c);if(Lh(d)){Jb(`[${t.id}] will not be displayed because we could not create an ad style compatible with ${Qb(c)}`);continue}l?(Jb(`[${t.id}] first ad dictates ad display style of: ${Qb(d)}`),c=d):Jb(`[${t.id}] will be displayed because it is compatible with the display style of: ${Qb(d)}, which is the same height as display style: ${Qb(c)}`);const p=mI(t,Pp);p&&r.pageInformation.iAdInfo.apply(t.id,p);let f=Tx(t,n,Gb);if(f=Yb(f,d,a&&t.id===a.id,u),"TEXT"===d.style){const e=yI(t,"iad.format.text");e!==kf&&(f.searchAd.advertisingText=cA(t,e===Sf?Hl:e))}const h=new vb("advert",f);Mh(h)&&(i.push(h),tA(r.locationTracker),u=!1)}const d=e[0],p=mI(d,Pp);return p&&r.pageInformation.iAdInfo.apply(d.id,p),r.pageInformation.baseFields[vn]=c?c.style:null,ZI(r.locationTracker),tA(r.locationTracker),i}(o,r,e,n),i.push(...a));let c=!0;for(const o of r){if(!kb(o)){s.push(o);continue}if(vS(o,54782))continue;const r=XL(o,t,n,e.requestDescriptor.isNetworkConstrained,e.requestDescriptor.searchEntity);r&&tF(r)&&(c&&Mh(a)&&Zb(a[0],r),i.push(r),c=!1,tA(n.locationTracker))}return ZI(n.locationTracker),(l=i,Oh.context("applyClientFilteringToIAPs",()=>{const e={};for(const t of l)if(t.type===Kd){const n=t.resultModel;n.parent&&n.productIdentifier&&n.parent.bundleId?e[n.productIdentifier]=n.parent.bundleId:Oh.unexpectedNull(Uf,Ih,"required fields for "+n.adamId)}return 0===Object.keys(e).length?Promise.resolve(l):(t=e,new Promise((e,n)=>{uv.visibilityForIAPs(t,(t,n)=>{e(n?{}:t)})})).then(e=>l.filter(t=>{if(t.type!==Kd)return!0;const n=t.resultModel;return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}));var t})).then(e=>({builtSearchResults:e,deferredSearchResults:s}));var l}function tF(e){if(host.platform===id)switch(e.type){case"content":case oa:return!0;default:return!1}return!0}function nF(e,t){const n=Nh(e.correctedTerm),r=Nh(e.suggestedTerm);return XI({pageInformation:t.pageInformation,locationTracker:t.locationTracker,targetType:Wf},"spellCorrection"),n?function(e,t){const n=e.term,r=rF(n,e.resultsTerm,ta);VS(r,wh,t.locationTracker);const o=`<i>${e.correctedTerm}</i>`,i=sg("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(ia,o),s=new iS(new hm(i,ip),{}),a=sg("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(ia,n),c={};c[""+a]=r;const l=new iS(new hm(a),c);return new Bb(s,l)}(e,t):r?function(e,t){const n=e.suggestedTerm,r=rF(n,e.resultsTerm,na);VS(r,wh,t.locationTracker);const o=`<i>${n}<i>`,i=sg("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(ia,o),s={};s[""+n]=r,s[n+"?"]=r;const a=new iS(new hm(i,ip),s);return new Bb(a)}(e,t):(ZI(t.locationTracker),null)}function rF(e,t,n){const r=new Nb(e,e,null,n);return r.spellCheckEnabled=!1,r.excludedTerms=[t],r.originatingTerm=t,r}function oF(e,t,n,r){return Fh(e)?null:{results:e,maxPerPage:30,requestMetadata:t,metricsOptions:r,responseMetadata:null!=n?n:{}}}function iF(e){return e&&e.results?e.results.slice(0,e.maxPerPage):[]}function sF(e){let t=[];if(e&&e.results&&(t=e.results.slice(e.maxPerPage,e.results.length)),Fh(t))return null;const n={...e};return n.results=t,n}function aF(e,t){if(Fh(e))return null;const n={};if(Fh(yI(e,Sh)))return null;const r=yA(e,sg(Un),{targetType:Wf,pageInformation:t.pageInformation,locationTracker:t.locationTracker});n[""+sg(Un)]=Px(e,r,host.clientIdentifier);const o=new hm(sg("SEARCH_TRANSPARENCY_TEXT"),mf);return new iS(o,n)}function cF(e){const t=new _b;return Nh(e)&&(t.facets=WL(e),t.pageFacets=zL(),t.selectedFacetOptions=jL()),t.results=[],t}async function lF(e){return Oh.context("searchResultsFromResponse",async()=>{var t;const n=e.catalogResponse,r=e.requestMetadata,o=r.searchRequestUrl,i=e.sponsoredSearchRequestData,s=xh(n,"results.guidedSearch"),a=function(e,t){var n,r,o,i,s,a,c;return{term:e.term,suggestedTerm:null===(r=null===(n=t.results)||void 0===n?void 0:n.spellCheck)||void 0===r?void 0:r.suggestedTerm,correctedTerm:null===(i=null===(o=t.results)||void 0===o?void 0:o.spellCheck)||void 0===i?void 0:i.correctedTerm,resultsTerm:(c=null===(a=null===(s=t.results)||void 0===s?void 0:s.spellCheck)||void 0===a?void 0:a.correctedTerm,null!=c?c:e.term),originatingTerm:e.originatingTerm}}(r.requestDescriptor,n),c=(l=e.sponsoredSearchAdvertData)&&Fh(l.error);var l;const u={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:fP(r.requestDescriptor,n,a,o,i,c,s)},d=new _b;!function(e,t,n,r){if(!Kh(vd))return;const o=t.requestDescriptor;XI({pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:Hn},"");const i=[];if(Mh(n))for(const e of n){const t=VL(o,e,r);t&&(i.push(t),tA(r.locationTracker))}if(Fh(i)&&t.requestDescriptor.searchEntity){const e=HL(t.requestDescriptor,r);i.push(e),tA(r.locationTracker)}const s=function(e,t){var n;if(Fh(t))return null;const r=e.term,o=null!=(n=e.guidedSearchTokens)?n:[],i=[];for(const e of t){const t=e.displayLabel,n=Array.from(o);if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t);const s=new BL(r,n,e.finalTerm);i.push(s)}return i}(t.requestDescriptor,n);ZI(r.locationTracker),Mh(i)&&(e.guidedSearchTokens=i,e.guidedSearchQueries=s,function(e,t){const n=eA(t.locationTracker);e.guidedSearchTokensParentImpressionMetrics=new Sg({impressionIndex:n,impressionType:Hn,idType:zs,id:Ar,name:"Search Revisions"})}(e,r),tA(r.locationTracker))}(d,r,null===(t=s)||void 0===t?void 0:t.facets,u);const p=function(e){return Pb(e.catalogResponse.results.search)}(e),f=function(e){return function(e,t){if(!t)return e;const n=[],r=e.reduce((e,t)=>({...e,[t.id]:t}),{});for(const e of t.adverts){const t=r[e.adamId];if(Fh(t)){Jb(`[${e.adamId}] skipped - Data was not part of original response`);continue}if(Fh(t.attributes)){Jb(`[${t.id}] skipped - Data is missing attributes`);continue}const o=$L(t,e);n.push(o)}return n}(Pb(e.catalogResponse.results[Vn]),e.sponsoredSearchAdvertData)}(e),h=await eF(r,n.meta,u,p,f);d.results=h.builtSearchResults,function(e,t){const n=eA(t.locationTracker);e.resultsParentImpressionMetrics=new Sg({impressionIndex:n,impressionType:ra,idType:zs,id:"search-results",name:"Search Results"})}(d,u),h.deferredSearchResults.length>0&&(d.nextPage=oF(h.deferredSearchResults,r,n.meta,u)),d.message=nF(a,u);return!Fh(r.requestDescriptor.searchEntity)||(d.facets=WL(r.requestDescriptor.facets,e.categoriesFilterData),d.pageFacets=zL(e.categoriesFilterData),d.selectedFacetOptions=Mh(e.requestMetadata.requestDescriptor.selectedFacetOptions)?e.requestMetadata.requestDescriptor.selectedFacetOptions:jL()),d.isAutoPlayEnabled="tv"!==Dm,d.transparencyLink=aF(e.transparencyData,u),lP(d,u.pageInformation),d})}function uF(e,t){return net.fetch(e).then(n=>{if(!n.ok)throw Error(`Bad Status code ${n.status} for ${e.url}`);const r=Date.now(),o=t(n.body),i=Date.now();if(o){const e=function(e,t,n){if(Fh(e))return null;const r=e[0];return r.parseStartTime=t,r.parseEndTime=n,r}(n.metrics,r,i);Nh(e)&&(o[My.timingValues]=e)}return o[My.requestedUrl]=e.url.toString(),o})}function dF(e){const t=function(e){let t=uI.from(Xh.searchHintsURL).param("caller","com.apple.AppStore").param("v","4");Lh(e)||(t=t.param(du,e));const n=host.clientIdentifier;t=n===Em?t.param("media","watchSoftware").param(Zs,"Watch"):n===Cm?t.param(Zs,Xo):t.param(Zs,kd);by&&(t=t.param(Ec,Nn));return t.build()}(e);return(n={url:t,signingStyle:od},uF(n,e=>plist.parse(e))).then(n=>({contents:n,metadata:{hintTerm:e,hintsRequestUrl:t}}));var n}class pF extends Zh{constructor(){super()}}class fF extends Zh{constructor(e){super(),this.id=e,this.pageMetrics=new Cg,this.pageRenderMetrics={}}}class hF extends Ug{constructor(e,t){super("SearchSegmentChangeAction"),this.title=e,this.targetSegmentId=t}}function mF(e){switch(e){case"macOS":return sg("APPLE_SILICON_SEGMENT_MAC");case"iOS":return sg("APPLE_SILICON_SEGMENT_IOS");default:MI()}}function gF(e,t){var n,r,o;const i=null===(n=t.catalogResponse.results)||void 0===n?void 0:n.search;switch(e){case"macOS":return null!=(r=yF(i,Jp))?r:[];case"iOS":return null!=(o=yF(i,Ff))?o:[];default:MI()}}function yF(e,t){for(const n of e.groups)if(n.groupId===t)return n.data;return null}function TF(e){if(e.length<2)return[];const t={rootPosition:0,locationStack:[]},n=[];for(const r of e){const e=wF(r.id,t);n.push(e),tA(t)}return n}function wF(e,t){const n=mF(e),r=new hF(n,e);return function(e,t,n){const r=PA(t,"link",{actionType:_f,location:QI({pageInformation:null,locationTracker:n,targetType:"link"},e.title)});e.actionMetrics.addMetricsData(r)}(r,IF(e),t),r}function IF(e){switch(e){case"macOS":return Jp;case"iOS":return Ff;default:MI()}}function AF(e,t,n,r,o=host.platform){if(e===t&&"iOS"===t&&o===Ef)return function(e,t,n){let r;r=-1!==t.indexOf("macOS")?function(){const e=sg("SHOWING_IOS_RESULTS_NO_MAC"),t=new hm(e,mf);return new iS(t,{})}():function(e){const t=sg("SHOWING_IOS_RESULTS_MORE_RELEVANT"),n=sg("SHOWING_IOS_RESULTS_MORE_RELEVANT_LINK"),r={};r[n]=wF("macOS",e.locationTracker);const o=new hm(t,mf);return new iS(o,r)}(n);if(!r)return;return new Bb(r)}(0,n,r)}function SF(e,t,n){const r=-1!==t.indexOf(e);if(!r)return;const o=function(e){switch(e){case"iOS":return"macOS";case"macOS":return"iOS";default:MI()}}(e);let i;i=!o||-1!==t.indexOf(o);return r&&!i?function(e,t){let n;switch(e){case"macOS":n=sg("NO_SEARCH_RESULTS_SEE_MACOS");break;case"iOS":n=sg("NO_SEARCH_RESULTS_SEE_IOS");break;default:MI()}const r=new hm(n),o={};return o[n]=wF(e,t.locationTracker),new iS(r,o)}(o,n):void 0}function bF(e){return Oh.context("segmentedSearchResults",()=>{const t=(n=e.catalogResponse,(null===(r=n.results.search)||void 0===r?void 0:r.autoSelectedGroupId)===Ff?"iOS":"macOS");var n,r;return function(e,t,n=host.platform){const r=[];if(n===Ef){const n=PF("macOS",e,t);if(r.push(n),by){const n=PF("iOS",e,t);r.push(n)}}return Promise.all(r)}(e,t).then(n=>{const r=new pF;r.segments=n,r.selectedSegment=t,r.segmentControlActions=TF(n);return!Fh(e.requestMetadata.requestDescriptor.searchEntity)||(r.facets=WL(e.requestMetadata.requestDescriptor.facets,e.categoriesFilterData),r.pageFacets=zL(e.categoriesFilterData),r.selectedFacetOptions=Mh(e.requestMetadata.requestDescriptor.selectedFacetOptions)?e.requestMetadata.requestDescriptor.selectedFacetOptions:jL()),Promise.resolve(r)})})}function PF(e,t,n){const r=t.requestMetadata,o={term:(i=r.requestDescriptor).term,resultsTerm:i.term,originatingTerm:i.originatingTerm};var i;const s={pageInformation:hP(t.catalogResponse,o,r.searchRequestUrl,IF(e)),locationTracker:{rootPosition:0,locationStack:[]}},a=gF(e,t),c=t.catalogResponse.meta;return eF(r,c,s,a).then(o=>{const i=new fF(e);i.name=mF(e);const a={results:o.builtSearchResults,nextPage:oF(o.deferredSearchResults,r,c,s)};i.content=a;const l=function(e){const t=[],n=["macOS","iOS"];for(const r of n){Fh(gF(r,e))&&t.push(r)}return t}(t);return i.noResultsLink=SF(e,l,s),i.message=AF(e,n,l,s),i.searchTransparencyLink=aF(t.transparencyData,s),lP(i,s.pageInformation),i})}function kF(e){const t=new pF;return t.segments=function(e=host.platform){const t=[];e===Ef&&(t.push(EF("macOS")),by&&t.push(EF("iOS")));return t}(),t.selectedSegment="macOS",t.segmentControlActions=TF(t.segments),Promise.resolve(t)}function EF(e){const t=new fF(e);t.name=mF(e);const n={results:[],nextPage:void 0};return t.content=n,t}class CF extends Zh{constructor(e){super(),this.targetName=e,this.imageName=kf}}class _F extends Zh{constructor(e){super(),this.name=e}}class RF extends Zh{constructor(e){super(),this.identifier=e}}class OF extends RF{constructor(e){super(e)}}class vF extends RF{constructor(e){super(e)}}class DF extends RF{constructor(e){super(e)}}class xF extends Zh{constructor(e){super(),this.style=e}}function LF(e){return Oh.catchingContext("topShelfFromGroupingUrl",()=>{const t=e.query.id;let n,r;const o=e.pathComponents();if(-1!==o.indexOf(dc)?n=t:-1!==o.indexOf(th)?n=rb(e):r=t,!Uh(r)&&!Uh(n))throw new Error(`Unable to map ${e.build()} to a media api url`);let i=(new Ry).forType(Af).addingRelationshipLimit(fh,6).addingQuery(fc,"name,artistName,label,editorialElementKind,displayStyle,displaySubStyle,cardDisplayStyle,editorialArtwork,link,target,url,isCanvasAvailable,editorialNotes,description");return Uh(r)?i=i.withIds([r]):Uh(n)&&(i=i.addingQuery(th,n)),jS(i).then(e=>{const t=bb(e);if(!t)return null;const n=_I(t,qp);if(!n)return null;const r=CI(n,vf);if(!r||r.data.length<1)return null;const o=r.data[0],i=yI(o,yd);if(475!==Number(i))return null;if(yI(o,cf)!==Ud)return null;const s=RI(o,fh),a={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:aP(Wi,t.id,e)},c=new xF("inset");return c.items=function(e,t){const n=[];for(const r of e){if(!Nh(r.attributes))continue;const e=FF(r,t);e&&n.push(e)}return n}(s,a),c})})}function FF(e,t){return Oh.catchingContext("topShelfInsetItemFromEditorialItem",()=>{const n=new OF(`${e.type}_${e.id}`);if(n.image=function(e,t,n){const r=sA(e,t);if(!Nh(r))return null;const o=vx(r,{withJoeColorPlaceholder:!0,useCase:21});o.crop=n||"fn";return o}(e,Je,"ek"),!Nh(n.image))return console.log("Missing crossover artwork for: "+e.id),null;n.tintStyle=Ly(n.image.backgroundColor)?qd:Hf;const r=yI(e,cf);let o=dL(e,bh);Lh(o)&&r===Id&&(o=yI(e,Df)),n.title=o,n.heading=yI(e,Df),n.subheading=dL(e,af),n.accessibilityLabel=o;const i=yA(e,o,{targetType:wh,pageInformation:t.pageInformation,locationTracker:t.locationTracker}),s=Px(e,i,host.clientIdentifier);return s instanceof Bg?(n.displayAction=new CF(Sh),n.displayAction.url=BF(s.pageUrl),n):(console.error("No action to map for top shelf item: "+e.id),null)})}function NF(e,t){return Oh.catchingContext("topShelfForArcade",()=>{if(!Kh("arcadeTopShelf")){const e=new xF(zi);return e.items=[],Promise.resolve(e)}if(Xh.isArcadeComingSoonEnabled){return jS((new Ry).forType(rh).withIds(["1469266318"])).then(e=>{const t=new xF(zi);var n;return t.items=[],t.promotionItem=(n=e,Oh.catchingContext("topShelfPromotionItemFromComingSoonEditorialItem",()=>{const e=bb(n);if(!Mh(e))return null;const t=new DF("arcade-coming-soon");Kh(Ze)&&(t.promotionImageName=rg,t.contextImageName=rg),t.contextTitle=sg(Yi),t.title=pL(e,bh),t.promotionText=t.title,t.accessibilityLabel=t.title;const r=$D(e);t.image=r.artwork;const o=WD(e);if(Lh(t.image)&&!Lh(o.video)&&(t.image=o.video.preview),Kh("arcadeTopShelfFullUpcomingExperience"))Lh(o.video)||(t.previewVideoUrl=o.video.videoUrl);else{const e=new CF(et);e.bundleIdentifier=""+_m,e.title=sg(Gi),t.playAction=e}return t})),t})}let n=Promise.resolve(null);if(!e){n=jS(tk(Xe))}let r=Promise.resolve(null);e&&(r=nk(2,!0));const o=jS(ZP(!1).includingAttributes([lh,sh,Sf,Xf]).withSparseLimit(5));return Promise.all([n,r,o]).then(([n,r,o])=>{const i=new xF(zi);var s;i.items=[],Mh(n)&&(i.promotionItem=(s=n,Oh.catchingContext("topShelfItemFromUpsellResponse",()=>{const e=Bh(s,ji).map(e=>jh(e));if(Fh(e))return null;const t=YP(e);if(!Mh(t))return null;const n=new DF("arcade-upsell");Kh(Ze)&&(n.promotionImageName=rg,n.contextImageName=rg),n.contextTitle=sg(Yi),n.title=QD(t),n.accessibilityLabel=n.title,n.promotionText=n.title,n.termsAndConditionsText=JD(t);const r=$D(t,!0);Nh(r.artwork)&&(n.image=r.artwork,n.promotionHeadingTintStyle=Ly(r.artwork.backgroundColor)?qd:Hf);const o=WD(t);Lh(o.video)||(n.previewVideoUrl=o.video.videoUrl);const i=yI(t,_);return n.playAction=qF(i),n})));const a=new Set,c=function(e,t,n,r,o,i=null){const s=Pb(e);if(Mh(s)){const a={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:aP(Wi,r,e)};return MF(s,t,n,a,o,i)}return[]}(r,e,t,"recently-played",a);i.items=i.items.concat(c);const l=function(e,t,n,r,o,i=null){const s=Eb(e);if(Mh(s)){const a={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:aP(Wi,r,e)};return MF(s,t,n,a,o,i)}return[]}(o,e,t,"recently-added",a,5);return i.items=i.items.concat(l),console.log(`Top shelf has ${i.items.length} items.`),i})})}function MF(e,t,n,r,o,i){const s=[];for(const a of e){if(!Nh(a.id)||!Nh(a.attributes))continue;if(Uh(i)&&o.size>=i)break;const e=a.id;if(o.has(e)){console.log("Skipping existing app.");continue}const c=UF(a,t,n,r);c&&(s.push(c),o.add(e))}return s}function UF(e,t,n,r){return Oh.catchingContext("topShelfItemFromAppData",()=>{const o=e.id,i=new vF(`${e.type}_${o}`),s=cA(e,bf);if(!Nh(s))return console.log("Missing bundleId for app: "+o),null;if(i.isAppleArcadeGame=uL(e),i.image=tL(e,{supportsArcade:i.isAppleArcadeGame,presentedInTopShelf:!0}),Fh(i.image))return console.log("Missing full screen artwork for app: "+o),null;const a=nL(e,21);Nh(a)&&Nh(a.videoUrl)&&(i.previewVideoUrl=a.videoUrl),i.title=yI(e,bh),i.accessibilityLabel=i.title;const c=cA(e,Hl);if(Mh(c)&&(i.summary=c.replace(/([\n]+)/g,"\n")),i.isGameControllerRequired=uA(e,yc),i.remoteControllerRequirement=cA(e,Fu),t)i.playAction=function(e){const t=new CF(et);return t.bundleIdentifier=e,t.title=sg(qe),t.accessibilityLabel=t.title,t}(s),i.installAction=function(e,t,n,r){const o=Uk(n),i=TI(n,ih),s=Gh(o,Ul);if(Lh(s))throw new Error("Missing buyParams when creating install action for: "+e);const a=Mk(n,s,i,!1,r.pageInformation,dh);let c;const l=cA(n,Fu);if(host.isOSAtLeast(14,5,0))c=l;else switch(l){case Li:case Fi:c=l;break;case Ni:case wd:case Mi:default:c=wd}const u=new CF("installApplication");return u.bundleIdentifier=t,u.title=sg(Be),u.accessibilityLabel=u.title,u.userInfo={adamId:e,token:a,remoteControllerRequirement:c},u}(o,s,e,r);else{const e=sg(n?"OFFER_BUTTON_TITLE_ARCADE_TRY":"OFFER_BUTTON_TITLE_ARCADE_NOT_SUBSCRIBED");i.playAction=qF(e,o)}const l={pageInformation:r.pageInformation,locationTracker:r.locationTracker};i.namedAttributes=function(e,t){return Oh.catchingContext("namedAttributesFromAppData",()=>{const n=[],r=lv(e,!1,t);for(const e of r){if(n.length>=4)break;if(e.style!==Ad||Fh(e.accessibilityCaption)||Fh(e.accessibilityTitle))continue;const t=new _F(e.accessibilityCaption);t.values=[e.accessibilityTitle],n.push(t)}return n})}(e,l);const u=yA(e,i.title,{targetType:wh,pageInformation:r.pageInformation,locationTracker:r.locationTracker}),d=Sx(e,u,host.clientIdentifier);return d instanceof Bg?(i.displayAction=new CF(Sh),i.displayAction.url=BF(d.pageUrl),i):(console.error("No action to map for top shelf more info of app: "+o),null)})}function BF(e){if(!Mh(e))return null;let t=null;switch(host.clientIdentifier){case gl:t=_m}if(!Mh(t))return e;const n=new uI(e);return n.protocol=t,n.build()}function qF(e,t=null){const n=new uI(`${_m}://${GT}`);Mh(t)&&n.param(Lw,t),n.param(dw,tt);const r=new CF(Sh);return r.url=n.build(),r.title=e,r}class GF{constructor(e){if(this._values={},!Lh(e)&&e.length>0){const t=e.split("&");for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=Lh(n)?"":decodeURIComponent(n);this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length");return Lh(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t);return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n);return Lh(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e="";for(const t of Object.keys(this._values)){const n=this._values[t];e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={};for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n);e[r]=o}return e}}var VF=n(3);const HF=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase();return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||Lh(e)||(this._app=e)}useClientId(e){Lh(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0;for(const t of e){const e=Gh(t);Lh(e)||this._pages.push(e)}}}useNativeValues(e){const t=Gh(e,"nativeApp");this.useApp(t);const n=Gh(e,"nativeClientId");this.useClientId(n);const r=Bh(e,"nativePageHistory");this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice();return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}},$F=new SA({defaultTopic:"xp_amp_appstore",buildType:Bm,jsVersion:Jh("version"),buyDecorator:HF,isLoggingEnabled:!0,bagProvider:(e,t)=>{const n=Xh.metricsConfiguration;if(!Lh(t)){const r=xh(n,[t,e]);if(!Lh(r))return r}return xh(n,e)}});function WF(e,t,n,r,o,i,s){return function(e,t,n,r,o){const i=new GF(e),s=Gh(r,dr);i.set(dr,s),i.set("topic",$F.defaultTopic),HF.useNativeValues(r);const a=HF.params;for(const e of Object.keys(a)){const t=Gh(a,e);i.set(e,t)}if(!Lh(o))for(const e of Object.keys(o)){const t=Gh(o,e);i.set(e,t),i.set(e,t,null)}if(!r)return i.set(ef,null),i.set($c,null),i.toString();if(!n){const e=Gh(r,ga),t=HI(e);e&&t&&(r.refApp=t);const n=Gh(r,"usageContext");if(Object(VF.isSome)(n)){const e=Gh(r,pl);switch(n){case"overlay":i.set(pl,"com.apple.AppStore.overlay");break;case"overlayClip":i.set(pl,pr)}i.set(ya,e,null)}else{const e=Gh(r,ya);i.set(ya,e,null);const t=Gh(r,ga);i.set(ga,t,null);"clip"===Gh(r,"extRefAppType")&&i.set(pl,pr)}}const c=i.get(ku);if(!(i.get(Jd)===kd)||c&&c===t){const e=WI(Gh(r,hd));Nh(e)&&i.set(ef,e)}return i.toString()}(function(e,t,n,r){const o=new GF(e),i=RA(n),s=Gh(jh(i),ku);o.set(ku,s);const a=Gh(jh(i),Jd);o.set(Jd,a);const c=Gh(jh(i),Ld);if(o.set("mtIadPlacementId",c,null),!(a===kd)||s&&s===t){const e=Gh(jh(n),ef);Lh(e)||o.set(ef,e)}return!Lh(r)&&r.length>0&&o.set($c,r),o.toString()}(t,e,n,o),e,r,i,s)}exportService("SearchData",{fetchHints:e=>wg(()=>dF(e.term).then(t=>{return n=e.term,r=t.metadata.hintsRequestUrl,o=t.contents,Oh.context("searchHintsFromApiResponse",()=>{const e={targetType:"listItem",pageInformation:pP(0,r),locationTracker:{rootPosition:0,locationStack:[]}},t=Gh(o,"userTyped");let i=null;Mh(t)&&(i=new Nb(t,t,null,sa),i.spellCheckEnabled=!0,i.prefixTerm=n,TA(i,e),VS(i,e.targetType,e.locationTracker),tA(e.locationTracker));const s=Bh(o,Zu).map(t=>{const r=Gh(t,lu),o=Gh(t,"displayTerm"),i=Gh(t,ef),s=new Nb(o,i,null,Zu,r);return s.spellCheckEnabled=!0,s.prefixTerm=n,TA(s,e),VS(s,e.targetType,e.locationTracker),tA(e.locationTracker),s});null!=i&&s.unshift(i);const a=Gh(o,"ghosting"),c=new Mb(s,a),l=kA(n,"key","input",r,{});return c.pageMetrics.pageFields=RA(e.pageInformation),c.pageMetrics.addData(l,["pageEnter"]),c});var n,r,o})),fetchTrending:e=>wg(()=>{const e={url:Xh.trendingSearchesURL};return net.fetch(e).then(t=>{if(!t.ok)throw Error(`Bad Status code ${t.status} for ${e.url}`);return function(e){return Oh.context("trendingSearchesFromApiResponse",()=>{const t={rootPosition:0,locationStack:[]},n=Bh(e,qn).map(e=>{const n=Gh(e,Df),r=new Nb(n,n,Gh(e,Sh),Dd);return VS(r,wh,t),tA(t),r}),r=n.length>0?Gh(e,Gn):null,o=new Ub(r,n);switch(Dm){case Ph:o.maxNumberOfSearches=10;break;case kh:o.maxNumberOfSearches=7}return o})}(JSON.parse(t.body))})}),fetchResults:e=>wg(()=>{const t=function(e){const t=new qb(e.targetingData,random.nextUUID()),n=qR(e);if(!n)return null;const r=jS(n,UR(t)),o=FR(t,e.term,r),i=VR(),s=HR();return Promise.all([r,o,i,s]).then(([r,o,i,s])=>{$R(r);return{catalogResponse:r,categoriesFilterData:i,transparencyData:bb(s),sponsoredSearchRequestData:t,sponsoredSearchAdvertData:o,requestMetadata:{requestDescriptor:e,searchRequestUrl:OI(n).toString()}}})}(e);return t?t.then(e=>lF(e)):Promise.resolve(cF(e.facets))}),fetchMoreResults:e=>wg(()=>{return t=e.pageToken,Oh.context("paginatedResultsWithToken",()=>{const e=iF(t),n=sF(t);return 0===e.length?Promise.resolve(cF()):MR(e).then(e=>{const r=Pb(e);return eF(t.requestMetadata,t.responseMetadata,t.metricsOptions,r).then(e=>{const t=new _b;return t.results=e.builtSearchResults,t.nextPage=n,t})})});var t}),fetchSegmentedResults:e=>wg(()=>{const t=NR(e);return t?t.then(e=>bF(e)):kF()}),fetchMoreSegmentedResults:e=>wg(()=>function(e){const t=iF(e),n=sF(e);return MR(t).then(t=>{const r=Pb(t);return eF(e.requestMetadata,e.responseMetadata,e.metricsOptions,r).then(e=>({results:e.builtSearchResults,nextPage:n}))})}(e.pageToken))}),exportService("PageData",{fetchGeneric:e=>wg(()=>LD(e.url,wP)),fetchMoreOfGeneric:e=>wg(()=>ND(e.pageToken)),fetchShelves:e=>wg(()=>{return t=e.requests,new Promise((e,n)=>{const r=Object.keys(t),o={shelves:{},errors:{}},i=new OP(r.length);i.then(()=>{if(Object.keys(o.shelves).length>0)e(o);else{const e=Object.keys(o.errors).map(e=>o.errors[e].message);0===e.length?n(new Error("Could not load any shelves: "+JSON.stringify(t))):n(new Error(e.join("\n")))}});for(const e of r){const n=t[e],r=t=>{o.shelves[e]=t,i.countDown()},s=t=>{o.errors[e]=t,i.countDown()},a=OD.routedObjectForUrl(n);a.object?a.object.handleShelf(a.normalizedUrl,a.parameters,a.matchedRuleIdentifier,r,s):s(new Error("fetchShelves: Unhandled shelf url: "+n))}});var t}),fetchAction:e=>wg(()=>(0!==YS(new uI(e.url)).length&&net.fetch({url:Xh.redirectUrlEndpoint,method:Au,headers:{"Content-Type":Ra},body:"url="+encodeURIComponent(e.url)}),FD(e.url).then(t=>{if(!t)throw new Error("Promise resolved to null action for: "+e.url);if(e.isIncomingURL){const e=[t];if(t instanceof qg)for(const n of t.actions)e.push(n);for(const t of e){const e=t.pageData;e&&d in e&&mP(e)}}switch(t.actionClass){case Oa:const n=t;n.page===Nf||n.page===jf||n.page===ml||n.page===hp||n.page===va?n.presentationContext=qf:e.isIncomingURL?"tv"===Dm?(n.presentationContext=qf,n.animationBehavior=qf):n.presentationContext="push":(n.presentationContext="replace",n.animationBehavior=Wp)}var n;return e.isIncomingURL&&(Kh(p)&&TD()||(n=e.url,yD.removeDeepLink(n))),t}).catch(e=>{if(e instanceof KS)switch(e.statusCode){case 204:const e=new ny(nh);if(e.title=sg("APP_NOT_AVAILABLE_TITLE"),e.message=sg("APP_NOT_AVAILABLE_MESSAGE"),e.isCancelable=!0,"tv"===Dm)return e;{const t=new qg(Lp);return t.title=sg(Wo),t.actions=[e],t}}throw Error(e.message)}))),fetchGenericAccount:e=>wg(()=>LD(e.url,UP))}),exportService("ProductData",{fetchPage:e=>e.preloading&&1===pI(hI)?Promise.reject(new Error("Product page preloading is disabled")):wg(()=>{0!==YS(new uI(e.url)).length&&net.fetch({url:Xh.redirectUrlEndpoint,method:Au,headers:{"Content-Type":Ra},body:"url="+encodeURIComponent(e.url)});let t=LD(e.url,iP);if(!t){t=jS(new Ry(e.url)).then(e=>sD(e))}return t.then(e=>(host.clientIdentifier===Om&&e&&d in e&&mP(e),e))}),fetchInstallPage:e=>wg(()=>LD(e.url,IP)),fetchInstallPageAction:e=>wg(()=>new Promise((t,n)=>{const r=new Bg(Da);r.pageUrl=px(e.id,e.parentId),t(r)}))}),exportService("TopChartData",{fetchPage:e=>wg(()=>{const t=new uI(e.url),n=t.query[sw],r=t.query[aw];t.removeParam(sw),t.query.limit="200",host.clientIdentifier===Cm&&(t.query[tp]=Zf);const o=jS(new Ry(t.toString()));let i;if("tv"===Dm||Mh(r)||host.clientIdentifier===Cm)i=Promise.resolve({});else{i=jS(FL()).catch(()=>{})}return Promise.all([o,i]).then(([e,r])=>{const o=NL(r);return fD(e,t,o,n)})}),fetchMoreOfSegment:e=>wg(()=>{const t=Tb(e.pageToken);if(0===t.length)return Promise.resolve(new uD(null,null,null,[]));let n=new Ry(t).includingMacOSCompatibleIOSAppsWhenSupported(!0);return by&&(n=n.includingAdditionalPlatforms([Rf,Mf])),jS(n).then(t=>{const n=wb(e.pageToken);return mD(t,e.pageToken,n)})})}),exportService("TodayData",{fetchPage:e=>wg(()=>{const t=e.url===zo,n=-1!==e.url.indexOf(TT);if(t)return new Promise((e,t)=>{t()});if(n){const t=uI.from(e.url);return t.param(XT,Fp),LD(t.build(),Ok)}{const t=Ey(),n=jS((new Ry).forType(Lp).includingAdditionalPlatforms(t).includingAttributes(iE).includingRelationshipsForUpsell(!0));n.then(e=>{db(dI.dsid,e)});let r=Promise.resolve(null);const o=(new Ry).forType(rh).withIds(e.onboardingCardIds).includingAdditionalPlatforms(t).includingAttributes(iE);return o.ids.size>0&&(r=jS(o,{}).catch(()=>{})),Promise.all([n,r]).then(([e,t])=>cE(e,t))}}),fetchMoreOfPage:e=>wg(()=>pE(e.pageToken)),fetchArticle:e=>wg(()=>LD(e.url,ck))}),exportService("ContentData",{fetchIconArtwork:e=>wg(()=>jS((new Ry).withIds(e.adamIds).forType(Ah).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(Ey())).then(e=>{const t=Pb(e),n={};for(const e of t)n[e.id]=Lx(e,{useCase:3});return n})),fetchLockups:e=>0===e.bundleIds.length?Promise.resolve(new ML([],[])):wg(()=>jS((new Ry).forType(Ah).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(Ey()).withFilter(bf,e.bundleIds.join(","))).then(t=>function(e,t){return Oh.context("lockupsFromResponse",()=>{const n={rootPosition:0,locationStack:[]},r=new xS,o=Pb(e),i=[],s=new Set(t);for(const e of o){const t=fx(e,{metricsOptions:{pageInformation:r,locationTracker:n},artworkUseCase:2});t&&(i.push(t),s.delete(t.bundleId))}return new ML(i,Array.from(s))})}(t,e.bundleIds)))}),exportService("Metrics",{lintEvent:e=>wg(()=>{const t=$F.makeEvent(e.fields);return Promise.resolve(t)})}),exportService("Purchases",{decorateArcadePurchase:e=>wg(()=>{const t=$h(e.intent,Kf);let n=t.buyParams;n=WF(Gh(e.intent,Pf),n,$h(e.intent,f),qh(e.intent,h),Gh(e.intent,jo),Hh(e.intent,rd),Hh(e.intent,m));const r=new GF(n),o={product:Gh(e.intent,of)||t.productIdentifier,adamId:Gh(e.intent,Pf),buyParams:r.toEncodedMap()};return Promise.resolve(o)}),decoratePurchase:e=>wg(()=>{const t=e.intent;let n=Gh(t,"token.buyParams");const r=Gh(t,"overrideBuyParams");Nh(r)&&(n=r),n=WF(Gh(t,Pf),n,$h(t,f),qh(t,h),Gh(t,jo),Hh(t,rd),Hh(t,m));const o=Bh(t,"token.appPlatforms"),i=o&&o.length&&o.length>0&&o.indexOf("tv")>=0,s=qh(t,"token.isHalva")||qh(t,"token.isMacOSCompatibleIOSApp"),a=jx(Dm,s).some(e=>-1!==o.indexOf(e)),c=s&&Dm===Ch&&-1===o.indexOf(Ch),l=Gh(t,"instalationType"),u="update"===l,d=l===g,p=qh(t,"token.isPreorder"),y=!(p||i&&!a),T=Gh(t,jo)===Eh&&Dm!==Eh,w=!(Dm===Ch&&d)?Gh(t,"token.preflightPackageUrl"):null,I={...Hh(t,"token.additionalHeaders",{}),...Hh(t,"additionalHeaders",{})},A={adamId:Gh(t,Pf),buyParams:n,vendor:Gh(t,"token.vendor"),appName:Gh(t,"token.appName"),bundleId:Gh(t,"token.bundleId"),appPlatforms:o,additionalHeaders:I,isUpdate:u,isRedownload:d,isPreorder:p,createsJobs:y,preflightPackageUrl:w,isArcadeApp:Wh(t,"token.isArcadeApp"),forceWatchInstall:T,isMacOSCompatibleIOSApp:c};return Promise.resolve(A)})}),exportService("MSOData",{fetchProviderData:e=>wg(()=>{const t=e.providerAdamId;return jS((new Ry).forType(xa).withIds([t])).then(e=>JR(e))}),fetchPage(e){const t=Lh(e.providerAdamId)||Lh(e.subscribedChannelIds);return wg(()=>{if(t)return LD(e.url,wP);return jS(XR(e.providerAdamId)).then(t=>ZR(t,function(e,t){const n=e.appsToAlwaysShow;for(const r of Object.keys(e.apps)){const o=e.apps[r];for(const e of o)if(-1!==t.indexOf(e)){n.push(r);break}}return n}(function(e){return Oh.context("msoAppsFromResponse",()=>{const t=bb(e),n=RI(t,Oi),r={};for(const e of n){r[_I(e,sf).id]=gI(e,"channelNames")}const o=RI(t,Ah).map(e=>e.id);return new QR(r,o)})}(t),e.subscribedChannelIds)))})}}),exportService("CMCPersonalizationData",{fetchPersonalizedOfferContext:e=>wg(()=>{const t=e.offerToken.offerAction,n=e.offerToken.offerDisplayProperties;if(!t||!n)return Promise.reject(new Error("Invalid offerToken for personalized offer fetch."));const r=t.adamId,o={"Content-Type":Ra},i={url:Xh.buyButtonMetadataURL,method:Au,headers:o,body:"ids="+r,signingStyle:od};return net.fetch(i).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${i.url}`);const o=Hh(JSON.parse(e.body),r);let s=null,a=null;const c=function(e){return Oh.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const t=Bh(e,Ml);if(0===t.length)return null;for(const e of t){const t=Gh(e,Bp);if(t)return t}return kf})}(o);if(Lh(c))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata");if(c!==kf){let e=Np;s=Qk(o,t,!1);let r=null;switch(c){case Yo:e=Su,r=sg("BUNDLE_OFFER_BUTTON_TITLE_PURCHASED");break;case La:(Lh(s.price)||0===s.price)&&(r=sg(Fa))}a=function(e,t,n,r){return Lh(e)?null:Oh.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const o=new nm(t,e.adamId,r),i=Gk(e);o.isFree=i;let s=null;s=i?e.title:e.priceFormatted,o.titles[ph]=s;const a=n.hasInAppPurchases,c=n.hasExternalPurchases;if(o.hasInAppPurchases=a,o.hasExternalPurchases=c,c){const e=sg(He);o.subtitles[ph]=e}else if(a){const e=sg($e);o.subtitles[ph]=e}return o.contentRating=n.contentRating,o})}(s,sf,n,e),r&&(a.titles[ph]=r)}const l=jk(s,!1);return new rm(c,l,a)})})}),exportService("ArcadeData",{fetchPage:e=>wg(()=>{const t=uI.from(e.url);return t.param(pw,"true"),t.param(fw,""+e.isSubscribed),t.param(hw,""+e.isTrialAvailable),LD(t.build(),SP)}),fetchSubscribePage:e=>wg(()=>LD(uI.from(e.url).build(),Og)),fetchArcadeSeeAllGames:e=>wg(()=>{const t=uI.from(e.url);return t.param(Vw,JSON.stringify(e)),LD(t.build(),bP)}),fetchMoreArcadeSeeAllGames:e=>wg(()=>ND(e.pageToken).then((function(e){return e}))),fetchArcadeWelcomePage:e=>wg(()=>LD(e.url,xg)),fetchUpsellGrid:e=>wg(()=>new Promise((t,n)=>{const r=e.contentDictionary;Mh(e)||n(new Error("fetchUpsellGrid called without a contentDictionary"));const o=r;Mh(o)||n(new Error("fetchUpsellGrid called with malformed contentDictionary"));const i=xx(RI(o,fh),{pageInformation:new xS({}),locationTracker:{rootPosition:0,locationStack:[]}},{useCase:2}),s=i.shift();t(new Ng(s,i))}))}),exportService("TopShelfData",{fetchTopShelf:e=>wg(()=>{switch(host.clientIdentifier){case Na:return LF(uI.from(e.url));case gl:return NF(qh(e.isSubscribed),qh(e.isTrialAvailable));default:return Promise.reject("Top shelf requested outside of an extension.")}}),createPurchase:e=>wg(()=>{const t=Gh(e,"userInfo.adamId");if(!Nh(t))return Promise.reject("Missing adamId for top shelf purchase.");const n=$h(e,"userInfo.token");if(Lh(n))return Promise.reject("Missing configuration token for top shelf purchase.");const r={adamId:t,buyParams:WF(t,Gh(n.buyParams),n.pageInformation,qh(n.excludeAttribution),Gh(n.metricsPlatformDisplayStyle),e.metrics,e.systemInformation),vendor:Gh(n.vendor),appName:Gh(n.appName),bundleId:Gh(n.bundleId),appPlatforms:Bh(n.appPlatforms),additionalHeaders:Hh(n.additionalHeaders),isUpdate:!1,isRedownload:!1,isPreorder:!1,createsJobs:!0,preflightPackageUrl:Gh(n.preflightPackageUrl)};return Promise.resolve(r)})}),exportService("AppStoreEngagement",{fetchEngagementTask:e=>wg(()=>{const t=e.eventString;let n=e.featuresDictionary;if(!Nh(n)&&!Nh(e.features))return Promise.reject("Received non-defined engagement features.");if(!Nh(n)&&Nh(e.features)){const t={};e.features.forEach(e=>{t[e]={}}),n=t}const r=wy(t,n,Nh(e.previouslyDisabledFeatures)?e.previouslyDisabledFeatures:[]);return Nh(r)?Promise.resolve(r):Promise.reject("Did not receive a valid engagement event.")}),fetchBadgingTask:e=>wg(()=>{var t;const n=function(e,t,n){if(!Iy.includes(e))return null;let r=null;if(t&&!n.includes(e)){const e=ug(1);r=new Gg(Th,e)}else if(!t){r=new Gg(Th,null)}return new Mg(r)}(e.identifier,e.isEnabled,null!=(t=e.previouslyDisabledFeatures)?t:[]);return Nh(n)?Promise.resolve(n):Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${e.identifier}, featuresDictionary: ${e.featuresDictionary}, previouslyDisabledFeatures: ${e.previouslyDisabledFeatures}`))})}),function(){for(const e of Object.keys(services)){const t=services[e];for(const e of Object.keys(t)){const n=t[e];n instanceof Function&&(t[e]=function(...e){const t=n.apply(this,e);return t instanceof Promise?t.then(e=>(Oh.recordValidationIncidents(e),e)):(Oh.recordValidationIncidents(t),t)})}}}()}]);